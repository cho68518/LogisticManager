def select_file():
    logging.info("íŒŒì¼ ì„ íƒ ì‹œì‘")
    gramwonlogis = tk.Tk()
    gramwonlogis.withdraw()
    gramwonlogis.option_add('*Font', 'Helvetica 12')

    file_path = filedialog.askopenfilename(title="ì‚¬ë°©ë„·ì£¼ë¬¸ìˆ˜ì§‘ì–‘ì‹ íŒŒì¼ ì„ íƒ")
    logging.info(f"ì„ íƒëœ íŒŒì¼ ê²½ë¡œ: {file_path}")

    if file_path:
        if file_path.endswith('.xlsx'):
            insert_data(file_path)
        else:
            logging.error("ì˜¬ë°”ë¥´ì§€ ì•Šì€ íŒŒì¼ í˜•ì‹")
            print("ì˜¬ë°”ë¥´ì§€ ì•Šì€ í˜•ì‹ì˜ íŒŒì¼ì…ë‹ˆë‹¤.")
            input("ì°½ì„ ì„ íƒí•˜ê³  ì—”í„°ë¥¼ ëˆ„ë¥´ë©´ ì¢…ë£Œ ë©ë‹ˆë‹¤.")
    else:
        logging.warning("íŒŒì¼ì´ ì„ íƒë˜ì§€ ì•ŠìŒ")
        print("íŒŒì¼ì„ ì„ íƒí•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
        input("ì°½ì„ ì„ íƒí•˜ê³  ì—”í„°ë¥¼ ëˆ„ë¥´ë©´ ì¢…ë£Œ ë©ë‹ˆë‹¤.")

def insert_data(file_path):
    try:
        mydb = mysql.connector.connect(
            host='gramwonlogis.mycafe24.com',
            port=3306,
            user='gramwonlogis',
            password='jung5516!',
            database='gramwonlogis',
        )
        cursor = mydb.cursor()
        logging.info("ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„±ê³µ")

        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜")
        logging.info("í…Œì´ë¸” ì´ˆê¸°í™” ì„±ê³µ")

        data = pd.read_excel(file_path)
        data.fillna(value='', inplace=True)

        for index, row in data.iterrows():
            sql = """
                INSERT INTO ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ (
                    ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸,
                    ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, `ì£¼ë¬¸ë²ˆí˜¸(ì‡¼í•‘ëª°)`, ê²°ì œê¸ˆì•¡, ì£¼ë¬¸ê¸ˆì•¡, ê²°ì œìˆ˜ë‹¨, ë©´ê³¼ì„¸êµ¬ë¶„, ì£¼ë¬¸ìƒíƒœ, ë°°ì†¡ì†¡
                ) 
                VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
            """
            values = (
                str(row['ìˆ˜ì·¨ì¸ëª…']),
                str(row['ì „í™”ë²ˆí˜¸1']),
                str(row['ì „í™”ë²ˆí˜¸2']),
                str(row['ìš°í¸ë²ˆí˜¸']),
                str(row['ì£¼ì†Œ']),
                '',  # âœ… ì˜µì…˜ëª…ì€ í•­ìƒ ë¹ˆ ë¬¸ìì—´
                str(row['ìˆ˜ëŸ‰']),
                str(row['ë°°ì†¡ë©”ì„¸ì§€']),
                str(row['ì£¼ë¬¸ë²ˆí˜¸']),
                str(row['ì‡¼í•‘ëª°']),
                str(row['ìˆ˜ì§‘ì‹œê°„']),
                str(row['ì†¡ì¥ëª…']),
                str(row['í’ˆëª©ì½”ë“œ']),
                str(row['ì£¼ë¬¸ë²ˆí˜¸(ì‡¼í•‘ëª°)']),
                str(row['ê²°ì œê¸ˆì•¡']),
                str(row['ì£¼ë¬¸ê¸ˆì•¡']),
                str(row['ê²°ì œìˆ˜ë‹¨'])[:255],
                str(row['ë©´ê³¼ì„¸êµ¬ë¶„']),
                str(row['ì£¼ë¬¸ìƒíƒœ']),
                str(row['ë°°ì†¡ì†¡'])
            )
            cursor.execute(sql, values)
            logging.info(f"ë°ì´í„° ì‚½ì… ì„±ê³µ: {values}")

        mydb.commit()
        logging.info("ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë°‹ ì™„ë£Œ")
        print("ë°ì´í„° ì‚½ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")
    except Exception as e:
        logging.error(f"ì˜¤ë¥˜ ë°œìƒ: {e}", exc_info=True)
        print("ë°ì´í„° ì‚½ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:", e)
        mydb.close()
    finally:
        input("ì°½ì„ í´ë¦­í•˜ê³  ì—”í„°ë¥¼ ëˆ„ë¥´ì„¸ìš”!")

if __name__ == "__main__":
    select_file()
    print("ì†¡ì¥ìˆ˜ì§‘íŒŒì¼ ê·¸ë¨ì› DBì— ë„£ê¸° ë.")
# ---ë

import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

def add_star_to_address():
    try:
        # DB ì—°ê²°
        connection = pymysql.connect(
            host=host,
            port=port,
            user=user,
            password=password,
            database=database,
            charset=charset,
            cursorclass=pymysql.cursors.DictCursor
        )

        with connection.cursor() as cursor:
            # ì£¼ì†Œ ë’¤ì— * ì¶”ê°€
            update_query = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            SET ì£¼ì†Œ = CONCAT(ì£¼ì†Œ, '*')
            WHERE í’ˆëª©ì½”ë“œ IN (7710, 7720)
            """

            cursor.execute(update_query)
            connection.commit()
            print("âœ… ì£¼ì†Œ ë’¤ì— * ì¶”ê°€ ì™„ë£Œ")

    except Exception as e:
        print(f"âŒ ì˜¤ë¥˜ ë°œìƒ: {e}")

    finally:
        connection.close()

if __name__ == "__main__":
    add_star_to_address()

# ---. 5ì´ˆë”œë ˆì´
print("íŒŒì¼ìƒì„±ê¹Œì§€ 5ì´ˆ")
# ---ì‹œì‘
import time

time.sleep(5)

# ---. 5ì´ˆë”œë ˆì´
print("5ì´ˆì¹´ìš´íŠ¸ ë")
# ---ë


import pymysql

def replace_bs_with_gc():
    print("ì†¡ì¥ëª… BS_ â†’ GC_ ë³€ê²½ ì‹œì‘")
    
    # DB ì—°ê²° ì •ë³´
    connection = pymysql.connect(
        host='gramwonlogis.mycafe24.com',
        port=3306,
        user='gramwonlogis',
        password='jung5516!',
        database='gramwonlogis',
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # BS_ â†’ GC_ë¡œ ë³€ê²½
            update_sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            SET ì†¡ì¥ëª… = CONCAT('GC_', SUBSTRING(ì†¡ì¥ëª…, 4))
            WHERE LEFT(ì†¡ì¥ëª…, 3) = 'BS_'
            """
            affected_rows = cursor.execute(update_sql)
            connection.commit()
            print(f"ë³€ê²½ ì™„ë£Œ: {affected_rows}ê±´ (BS_ â†’ GC_)")
    
    except Exception as e:
        print(f"ì˜¤ë¥˜ ë°œìƒ: {e}")
    
    finally:
        connection.close()

if __name__ == "__main__":
    replace_bs_with_gc()

time.sleep(1)

import mysql.connector

def update_recipient_name_and_clean_address():
    try:
        # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
        connection = mysql.connector.connect(
            host='gramwonlogis.mycafe24.com',
            port=3306,
            user='gramwonlogis',
            password='jung5516!',
            database='gramwonlogis'
        )
        
        cursor = connection.cursor()

        # 1. ìˆ˜ì·¨ì¸ëª…ì´ 'nan'ì¸ ê²½ìš° 'ë‚œë‚œ'ìœ¼ë¡œ ë³€ê²½
        update_name_query = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ìˆ˜ì·¨ì¸ëª… = 'ë‚œë‚œ'
        WHERE ìˆ˜ì·¨ì¸ëª… = 'nan';
        """
        cursor.execute(update_name_query)
        print(f"{cursor.rowcount} rows updated in ìˆ˜ì·¨ì¸ëª….")

        # 2. ì£¼ì†Œ ì»¬ëŸ¼ì—ì„œ 'Â·' ë¬¸ìë¥¼ ì œê±°
        update_address_query = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ì£¼ì†Œ = REPLACE(ì£¼ì†Œ, 'Â·', '')
        WHERE ì£¼ì†Œ LIKE '%Â·%';
        """
        cursor.execute(update_address_query)
        print(f"{cursor.rowcount} rows updated in ì£¼ì†Œ.")

        connection.commit()

    except mysql.connector.Error as err:
        print(f"Error: {err}")

    finally:
        if connection.is_connected():
            cursor.close()
            connection.close()

# ì‹¤í–‰
update_recipient_name_and_clean_address()

time.sleep(1)


import mysql.connector
import time

def update_payment_method_for_baemin():
    try:
        # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
        connection = mysql.connector.connect(
            host='gramwonlogis.mycafe24.com',
            port=3306,
            user='gramwonlogis',
            password='jung5516!',
            database='gramwonlogis'
        )

        cursor = connection.cursor()

        # ì‡¼í•‘ëª°ì´ 'ë°°ë¯¼ìƒíšŒ'ì¸ í–‰ì˜ ê²°ì œìˆ˜ë‹¨ì„ 0ìœ¼ë¡œ ì—…ë°ì´íŠ¸
        update_query = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ê²°ì œìˆ˜ë‹¨ = '0'
        WHERE ì‡¼í•‘ëª° = 'ë°°ë¯¼ìƒíšŒ';
        """

        cursor.execute(update_query)
        connection.commit()

        print(f"{cursor.rowcount} rows updated.")

    except mysql.connector.Error as err:
        print(f"Error: {err}")

    finally:
        if connection.is_connected():
            cursor.close()
            connection.close()
            print("Database connection closed.")

if __name__ == "__main__":
    update_payment_method_for_baemin()
    time.sleep(1)

# ë©”ì„¸ì§€ë©”ì„¸ì§€ë©”ì„¸ì§€ë„£ê¸°ì‹œì‘
import pandas as pd
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# Excel íŒŒì¼ ê²½ë¡œ
excel_file = '0.ê´€ë¦¬ìíŒŒì¼/ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€.xlsx'

# í…Œì´ë¸” ë¦¬ìŠ¤íŠ¸
target_tables = [
    'ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€',
    'ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ë¶€ì‚°',
    'ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ì²­ê³¼'
]

# ì—‘ì…€ íŒŒì¼ ì½ê¸°
df = pd.read_excel(excel_file, header=0)

# ì»¬ëŸ¼ ì´ë¦„ ëª…ì‹œì ìœ¼ë¡œ ì§€ì •
df.columns = ['ì‡¼í•‘ëª°', 'msg1', 'msg2', 'msg3', 'msg4', 'msg5', 'msg6']

# NaN ê°’ì„ ë¹ˆ ë¬¸ìì—´ë¡œ ëŒ€ì²´
df = df.astype(str).fillna('')

# MySQL ì—°ê²°
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        for table in target_tables:
            # ê¸°ì¡´ ë°ì´í„° ì‚­ì œ
            cursor.execute(f"TRUNCATE TABLE {table}")

            # ë°ì´í„° ì‚½ì…
            for _, row in df.iterrows():
                sql = f"""
                INSERT INTO {table} (ì‡¼í•‘ëª°, msg1, msg2, msg3, msg4, msg5, msg6)
                VALUES (%s, %s, %s, %s, %s, %s, %s)
                """
                cursor.execute(sql, (
                    row['ì‡¼í•‘ëª°'], row['msg1'], row['msg2'], row['msg3'],
                    row['msg4'], row['msg5'], row['msg6']
                ))

    # ë³€ê²½ì‚¬í•­ ì»¤ë°‹
    connection.commit()
    print("âœ… All tables updated successfully!")

finally:
    connection.close()
    print("ğŸ”Œ Database connection closed.")

time.sleep(1)

# ë©”ì„¸ì§€ë©”ì„¸ì§€ë©”ì„¸ì§€ë„£ê¸°ëë

# í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬ì‹œì‘

import pandas as pd
import pymysql
import time

def truncate_and_insert_busan():
    print("í•©í¬ì¥ë³€ê²½ ì½”ë“œì…ë ¥ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # Excel íŒŒì¼ ê²½ë¡œ
    excel_file = '0.ê´€ë¦¬ìíŒŒì¼/í•©í¬ì¥ë³€ê²½.xlsx'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        # Excel íŒŒì¼ ì½ê¸°
        df = pd.read_excel(excel_file)

        # NaN ê°’ì„ ì ì ˆí•œ ê°’ìœ¼ë¡œ ëŒ€ì²´
        for column in df.columns:
            if df[column].dtype == 'object':
                df[column] = df[column].fillna('')
            else:
                df[column] = df[column].fillna(0)

        # MySQL í…Œì´ë¸”ì— ë°ì´í„° ì‚½ì… ì „ì— í…Œì´ë¸” ë¹„ìš°ê¸°
        with connection.cursor() as cursor:
            # í…Œì´ë¸” ë¹„ìš°ê¸°
            cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_í•©í¬ì¥ë³€ê²½")

        # MySQL í…Œì´ë¸”ì— ë°ì´í„° ì‚½ì…
        with connection.cursor() as cursor:
             for index, row in df.iterrows():
                sql = """
                INSERT INTO ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_í•©í¬ì¥ë³€ê²½ (
                    í’ˆëª©ì½”ë“œ, í’ˆëª©ëª…, ëŒ€ì²´ì½”ë“œ1, ëŒ€ì²´ì½”ë“œ1í’ˆëª©ëª…, ëŒ€ì²´1ìˆ˜ëŸ‰, 
                    ëŒ€ì²´ì½”ë“œ2, ëŒ€ì²´ì½”ë“œ2í’ˆëª©ëª…, ëŒ€ì²´2ìˆ˜ëŸ‰, ëŒ€ì²´ì½”ë“œ3, ëŒ€ì²´ì½”ë“œ3í’ˆëª©ëª…, ëŒ€ì²´3ìˆ˜ëŸ‰,
                    ëŒ€ì²´ì½”ë“œ4, ëŒ€ì²´ì½”ë“œ4í’ˆëª©ëª…, ëŒ€ì²´4ìˆ˜ëŸ‰
                )
                VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
                """
                cursor.execute(sql, (
                    row['í’ˆëª©ì½”ë“œ'], row['í’ˆëª©ëª…'], row['ëŒ€ì²´ì½”ë“œ1'], row['ëŒ€ì²´ì½”ë“œ1í’ˆëª©ëª…'], 
                    row['ëŒ€ì²´1ìˆ˜ëŸ‰'], row['ëŒ€ì²´ì½”ë“œ2'], row['ëŒ€ì²´ì½”ë“œ2í’ˆëª©ëª…'], row['ëŒ€ì²´2ìˆ˜ëŸ‰'],
                    row['ëŒ€ì²´ì½”ë“œ3'], row['ëŒ€ì²´ì½”ë“œ3í’ˆëª©ëª…'], row['ëŒ€ì²´3ìˆ˜ëŸ‰'], row['ëŒ€ì²´ì½”ë“œ4'], 
                    row['ëŒ€ì²´ì½”ë“œ4í’ˆëª©ëª…'], row['ëŒ€ì²´4ìˆ˜ëŸ‰']
                ))


        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print("í•©í¬ì¥ë³€ê²½ ì½”ë“œì…ë ¥ ì™„ë£Œ")
    except Exception as e:
        print(f"Error in truncate_and_insert_busan: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
truncate_and_insert_busan()


time.sleep(1)



import time
import pymysql

def transfer_and_delete_data():
    print("ë°ì´í„° ì „ì†¡ ë° ì‚­ì œ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜ í…Œì´ë¸” ë¹„ìš°ê¸°
            cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜")

            # ë°ì´í„° ì‚½ì…
            insert_sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            WHERE í’ˆëª©ì½”ë“œ IN (SELECT í’ˆëª©ì½”ë“œ FROM ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_í•©í¬ì¥ë³€ê²½)
            """
            cursor.execute(insert_sql)

            # ë°ì´í„° ì‚­ì œ
            delete_sql = """
            DELETE FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            WHERE í’ˆëª©ì½”ë“œ IN (SELECT í’ˆëª©ì½”ë“œ FROM ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_í•©í¬ì¥ë³€ê²½)
            """
            cursor.execute(delete_sql)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print("ë°ì´í„° ì „ì†¡ ë° ì‚­ì œ ì™„ë£Œ")
    except Exception as e:
        print(f"Error in transfer_and_delete_data: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
transfer_and_delete_data()

import pymysql

def transfer_data_to_í•©í¬ì¥ë³€í™˜1():
    print("ë°ì´í„° ì „ì†¡ ì‹œì‘ (í•©í¬ì¥ë³€í™˜1)")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜1 í…Œì´ë¸” ë¹„ìš°ê¸°
            cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜1")

            # ë°ì´í„° ì„ íƒ ë° ì‚½ì…
            select_and_insert_sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜1
            SELECT a.*
            FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜ a
            JOIN ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_í•©í¬ì¥ë³€ê²½ b ON a.í’ˆëª©ì½”ë“œ = b.í’ˆëª©ì½”ë“œ
            WHERE b.ëŒ€ì²´ì½”ë“œ2 != ''
            """
            cursor.execute(select_and_insert_sql)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print("ë°ì´í„° ì „ì†¡ ì™„ë£Œ (í•©í¬ì¥ë³€í™˜1)")
    except Exception as e:
        print(f"Error in transfer_data_to_í•©í¬ì¥ë³€í™˜1: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    transfer_data_to_í•©í¬ì¥ë³€í™˜1()

#í•©í¬ì¥ë³€í™˜1 = ëŒ€ì²´ì½”ë“œ2
time.sleep(1)

import pymysql

def transfer_data_to_í•©í¬ì¥ë³€í™˜2():
    print("ë°ì´í„° ì „ì†¡ ì‹œì‘ (í•©í¬ì¥ë³€í™˜2)")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜2 í…Œì´ë¸” ë¹„ìš°ê¸°
            cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜2")

            # ë°ì´í„° ì„ íƒ ë° ì‚½ì…
            select_and_insert_sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜2
            SELECT a.*
            FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜ a
            JOIN ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_í•©í¬ì¥ë³€ê²½ b ON a.í’ˆëª©ì½”ë“œ = b.í’ˆëª©ì½”ë“œ
            WHERE b.ëŒ€ì²´ì½”ë“œ3 != ''
            """
            cursor.execute(select_and_insert_sql)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print("ë°ì´í„° ì „ì†¡ ì™„ë£Œ (í•©í¬ì¥ë³€í™˜2)")
    except Exception as e:
        print(f"Error in transfer_data_to_í•©í¬ì¥ë³€í™˜2: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    transfer_data_to_í•©í¬ì¥ë³€í™˜2()

#í•©í¬ì¥ë³€í™˜2 = ëŒ€ì²´ì½”ë“œ3
time.sleep(1)

import pymysql

def transfer_data_to_í•©í¬ì¥ë³€í™˜3():
    print("ë°ì´í„° ì „ì†¡ ì‹œì‘ (í•©í¬ì¥ë³€í™˜3)")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜1 í…Œì´ë¸” ë¹„ìš°ê¸°
            cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜3")

            # ë°ì´í„° ì„ íƒ ë° ì‚½ì…
            select_and_insert_sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜3
            SELECT a.*
            FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜ a
            JOIN ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_í•©í¬ì¥ë³€ê²½ b ON a.í’ˆëª©ì½”ë“œ = b.í’ˆëª©ì½”ë“œ
            WHERE b.ëŒ€ì²´ì½”ë“œ4 != ''
            """
            cursor.execute(select_and_insert_sql)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print("ë°ì´í„° ì „ì†¡ ì™„ë£Œ (í•©í¬ì¥ë³€í™˜3)")
    except Exception as e:
        print(f"Error in transfer_data_to_í•©í¬ì¥ë³€í™˜3: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    transfer_data_to_í•©í¬ì¥ë³€í™˜3()

#í•©í¬ì¥ë³€í™˜3 = ëŒ€ì²´ì½”ë“œ4
time.sleep(1)

import pymysql

def update_í•©í¬ì¥ë³€í™˜():
    print("ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹œì‘ (í•©í¬ì¥ë³€í™˜)")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ë°ì´í„° ì—…ë°ì´íŠ¸
            update_sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜ a
            JOIN ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_í•©í¬ì¥ë³€ê²½ b ON a.í’ˆëª©ì½”ë“œ = b.í’ˆëª©ì½”ë“œ
            SET 
                a.íƒë°°ë¹„ìš© = b.ëŒ€ì²´ì½”ë“œ1,
                a.ë°•ìŠ¤í¬ê¸° = b.ëŒ€ì²´ì½”ë“œ1í’ˆëª©ëª…,
                a.ì¶œë ¥ê°œìˆ˜ = b.ëŒ€ì²´1ìˆ˜ëŸ‰
            WHERE b.ëŒ€ì²´ì½”ë“œ1 != ''
            """
            cursor.execute(update_sql)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print("ë°ì´í„° ì—…ë°ì´íŠ¸ ì™„ë£Œ (í•©í¬ì¥ë³€í™˜)")
    except Exception as e:
        print(f"Error in update_í•©í¬ì¥ë³€í™˜: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    update_í•©í¬ì¥ë³€í™˜()

#í•©í¬ì¥ë³€í™˜ = ëŒ€ì²´ì½”ë“œ1
time.sleep(1)


import pymysql

def update_í•©í¬ì¥ë³€í™˜1():
    print("ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹œì‘ (í•©í¬ì¥ë³€í™˜1)")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ë°ì´í„° ì—…ë°ì´íŠ¸
            update_sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜1 a
            JOIN ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_í•©í¬ì¥ë³€ê²½ b ON a.í’ˆëª©ì½”ë“œ = b.í’ˆëª©ì½”ë“œ
            SET 
                a.íƒë°°ë¹„ìš© = b.ëŒ€ì²´ì½”ë“œ2,
                a.ë°•ìŠ¤í¬ê¸° = b.ëŒ€ì²´ì½”ë“œ2í’ˆëª©ëª…,
                a.ì¶œë ¥ê°œìˆ˜ = b.ëŒ€ì²´2ìˆ˜ëŸ‰
            WHERE b.ëŒ€ì²´ì½”ë“œ2 != ''
            """
            cursor.execute(update_sql)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print("ë°ì´í„° ì—…ë°ì´íŠ¸ ì™„ë£Œ (í•©í¬ì¥ë³€í™˜1)")
    except Exception as e:
        print(f"Error in update_í•©í¬ì¥ë³€í™˜1: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    update_í•©í¬ì¥ë³€í™˜1()

#í•©í¬ì¥ë³€í™˜1 = ëŒ€ì²´ì½”ë“œ2

time.sleep(1)


import pymysql

def update_í•©í¬ì¥ë³€í™˜2():
    print("ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹œì‘ (í•©í¬ì¥ë³€í™˜2)")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ë°ì´í„° ì—…ë°ì´íŠ¸
            update_sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜2 a
            JOIN ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_í•©í¬ì¥ë³€ê²½ b ON a.í’ˆëª©ì½”ë“œ = b.í’ˆëª©ì½”ë“œ
            SET 
                a.íƒë°°ë¹„ìš© = b.ëŒ€ì²´ì½”ë“œ3,
                a.ë°•ìŠ¤í¬ê¸° = b.ëŒ€ì²´ì½”ë“œ3í’ˆëª©ëª…,
                a.ì¶œë ¥ê°œìˆ˜ = b.ëŒ€ì²´3ìˆ˜ëŸ‰
            WHERE b.ëŒ€ì²´ì½”ë“œ3 != ''
            """
            cursor.execute(update_sql)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print("ë°ì´í„° ì—…ë°ì´íŠ¸ ì™„ë£Œ (í•©í¬ì¥ë³€í™˜2)")
    except Exception as e:
        print(f"Error in update_í•©í¬ì¥ë³€í™˜2: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    update_í•©í¬ì¥ë³€í™˜2()

#í•©í¬ì¥ë³€í™˜2 = ëŒ€ì²´ì½”ë“œ3

time.sleep(1)

import pymysql

def update_í•©í¬ì¥ë³€í™˜3():
    print("ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹œì‘ (í•©í¬ì¥ë³€í™˜3)")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ë°ì´í„° ì—…ë°ì´íŠ¸
            update_sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜3 a
            JOIN ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_í•©í¬ì¥ë³€ê²½ b ON a.í’ˆëª©ì½”ë“œ = b.í’ˆëª©ì½”ë“œ
            SET 
                a.íƒë°°ë¹„ìš© = b.ëŒ€ì²´ì½”ë“œ4,
                a.ë°•ìŠ¤í¬ê¸° = b.ëŒ€ì²´ì½”ë“œ4í’ˆëª©ëª…,
                a.ì¶œë ¥ê°œìˆ˜ = b.ëŒ€ì²´4ìˆ˜ëŸ‰
            WHERE b.ëŒ€ì²´ì½”ë“œ4 != ''
            """
            cursor.execute(update_sql)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print("ë°ì´í„° ì—…ë°ì´íŠ¸ ì™„ë£Œ (í•©í¬ì¥ë³€í™˜3)")
    except Exception as e:
        print(f"Error in update_í•©í¬ì¥ë³€í™˜3: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    update_í•©í¬ì¥ë³€í™˜3()

#í•©í¬ì¥ë³€í™˜3 = ëŒ€ì²´ì½”ë“œ4

time.sleep(1)


import pymysql

def delete_rows_with_empty_boxsize():
    print("ë°•ìŠ¤í¬ê¸°ê°€ ë¹„ì–´ìˆëŠ” í–‰ ì‚­ì œ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ë°•ìŠ¤í¬ê¸°ê°€ ë¹„ì–´ìˆëŠ” í–‰ ì‚­ì œ
            delete_sql = """
            DELETE FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜1
            WHERE ë°•ìŠ¤í¬ê¸° IS NULL OR ë°•ìŠ¤í¬ê¸° = ''
            """
            cursor.execute(delete_sql)

            # ì˜í–¥ë°›ì€ í–‰ ìˆ˜ í™•ì¸
            affected_rows = cursor.rowcount

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print(f"ë°•ìŠ¤í¬ê¸°ê°€ ë¹„ì–´ìˆëŠ” {affected_rows}ê°œì˜ í–‰ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.")
    except Exception as e:
        print(f"Error in delete_rows_with_empty_boxsize: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    delete_rows_with_empty_boxsize()

time.sleep(1)


import pymysql

def delete_rows_with_empty_boxsize2():
    print("ë°•ìŠ¤í¬ê¸°ê°€ ë¹„ì–´ìˆëŠ” í–‰ ì‚­ì œ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ë°•ìŠ¤í¬ê¸°ê°€ ë¹„ì–´ìˆëŠ” í–‰ ì‚­ì œ
            delete_sql = """
            DELETE FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜2
            WHERE ë°•ìŠ¤í¬ê¸° IS NULL OR ë°•ìŠ¤í¬ê¸° = ''
            """
            cursor.execute(delete_sql)

            # ì˜í–¥ë°›ì€ í–‰ ìˆ˜ í™•ì¸
            affected_rows = cursor.rowcount

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print(f"ë°•ìŠ¤í¬ê¸°ê°€ ë¹„ì–´ìˆëŠ” {affected_rows}ê°œì˜ í–‰ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.")
    except Exception as e:
        print(f"Error in delete_rows_with_empty_boxsize: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    delete_rows_with_empty_boxsize2()

time.sleep(1)


import pymysql

def delete_rows_with_empty_boxsize3():
    print("ë°•ìŠ¤í¬ê¸°ê°€ ë¹„ì–´ìˆëŠ” í–‰ ì‚­ì œ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ë°•ìŠ¤í¬ê¸°ê°€ ë¹„ì–´ìˆëŠ” í–‰ ì‚­ì œ
            delete_sql = """
            DELETE FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜3
            WHERE ë°•ìŠ¤í¬ê¸° IS NULL OR ë°•ìŠ¤í¬ê¸° = ''
            """
            cursor.execute(delete_sql)

            # ì˜í–¥ë°›ì€ í–‰ ìˆ˜ í™•ì¸
            affected_rows = cursor.rowcount

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print(f"ë°•ìŠ¤í¬ê¸°ê°€ ë¹„ì–´ìˆëŠ” {affected_rows}ê°œì˜ í–‰ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.")
    except Exception as e:
        print(f"Error in delete_rows_with_empty_boxsize: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    delete_rows_with_empty_boxsize3()

time.sleep(1)


import pymysql

def update_table(table_name):
    print(f"ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹œì‘ ({table_name})")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ë°ì´í„° ì—…ë°ì´íŠ¸
            update_sql = f"""
            UPDATE {table_name}
            SET 
                í’ˆëª©ì½”ë“œ = íƒë°°ë¹„ìš©,
                ì†¡ì¥ëª… = ë°•ìŠ¤í¬ê¸°,
                ìˆ˜ëŸ‰ = ìˆ˜ëŸ‰ * ì¶œë ¥ê°œìˆ˜,
                íƒë°°ë¹„ìš© = NULL,
                ë°•ìŠ¤í¬ê¸° = NULL,
                ì¶œë ¥ê°œìˆ˜ = NULL
            """
            cursor.execute(update_sql)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print(f"ë°ì´í„° ì—…ë°ì´íŠ¸ ì™„ë£Œ ({table_name})")
    except Exception as e:
        print(f"Error in update_{table_name}: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

def update_í•©í¬ì¥ë³€í™˜():
    update_table('ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜')

def update_í•©í¬ì¥ë³€í™˜1():
    update_table('ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜1')

def update_í•©í¬ì¥ë³€í™˜2():
    update_table('ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜2')

def update_í•©í¬ì¥ë³€í™˜3():
    update_table('ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜3')

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    update_í•©í¬ì¥ë³€í™˜()
    update_í•©í¬ì¥ë³€í™˜1()
    update_í•©í¬ì¥ë³€í™˜2()  # ì¶”ê°€ëœ í•¨ìˆ˜ í˜¸ì¶œ
    update_í•©í¬ì¥ë³€í™˜3()  # ì¶”ê°€ëœ í•¨ìˆ˜ í˜¸ì¶œ


import mysql.connector
from mysql.connector import Error

def update_table(cursor, table_name):
    try:
        update_query = f"""
        UPDATE {table_name} AS s
        JOIN í’ˆëª©ë“±ë¡ AS p ON s.í’ˆëª©ì½”ë“œ = p.í’ˆëª©ì½”ë“œ
        SET s.ê²°ì œê¸ˆì•¡ = 0,
            s.ì£¼ë¬¸ê¸ˆì•¡ = 0
        """
        cursor.execute(update_query)
        print(f"{table_name} í…Œì´ë¸”ì˜ ê²°ì œê¸ˆì•¡ê³¼ ì£¼ë¬¸ê¸ˆì•¡ì´ 0ì›ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.")
    except Error as e:
        print(f"{table_name} í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {e}")

try:
    connection = mysql.connector.connect(
        host='gramwonlogis.mycafe24.com',
        port=3306,
        user='gramwonlogis',
        password='jung5516!',
        database='gramwonlogis'
    )

    if connection.is_connected():
        cursor = connection.cursor()
        
        # í…Œì´ë¸”ëª… ëª©ë¡
        tables = [
            'ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜1', 
            'ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜2', 
            'ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜3'
        ]
        for table in tables:
            update_table(cursor, table)
        
        connection.commit()
        print("ëª¨ë“  í…Œì´ë¸”ì˜ ì—…ë°ì´íŠ¸ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")

except Error as e:
    print(f"ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {e}")

finally:
    if connection.is_connected():
        cursor.close()
        connection.close()
        print("ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")




time.sleep(1)

import pymysql
import time

def merge_and_insert_data():
    print("ë°ì´í„° ë³‘í•© ë° ì‚½ì… ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # 1. ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜ê²°ê³¼ í…Œì´ë¸” truncate
            print("ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜ê²°ê³¼ í…Œì´ë¸” truncate ì‹œì‘")
            cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜ê²°ê³¼")
            connection.commit()
            print("ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜ê²°ê³¼ í…Œì´ë¸” truncate ì™„ë£Œ")
            time.sleep(1)

            # 2. ë°ì´í„° ë³‘í•© ë° ì‚½ì… (AUTO_INCREMENT ì‚¬ìš©)
            print("ë°ì´í„° ë³‘í•© ë° ì‚½ì… ì‹œì‘")
            insert_sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜ê²°ê³¼ (
                msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
                ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, 
                ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, 
                ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜, `ì£¼ë¬¸ë²ˆí˜¸(ì‡¼í•‘ëª°)`, ê²°ì œê¸ˆì•¡, ì£¼ë¬¸ê¸ˆì•¡, ê²°ì œìˆ˜ë‹¨, ë©´ê³¼ì„¸êµ¬ë¶„, ì£¼ë¬¸ìƒíƒœ, ë°°ì†¡ì†¡
            )
            SELECT 
                msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
                ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, 
                ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, 
                ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜, `ì£¼ë¬¸ë²ˆí˜¸(ì‡¼í•‘ëª°)`, ê²°ì œê¸ˆì•¡, ì£¼ë¬¸ê¸ˆì•¡, ê²°ì œìˆ˜ë‹¨, ë©´ê³¼ì„¸êµ¬ë¶„, ì£¼ë¬¸ìƒíƒœ, ë°°ì†¡ì†¡
            FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜
            UNION ALL
            SELECT 
                msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
                ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, 
                ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, 
                ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜, `ì£¼ë¬¸ë²ˆí˜¸(ì‡¼í•‘ëª°)`, ê²°ì œê¸ˆì•¡, ì£¼ë¬¸ê¸ˆì•¡, ê²°ì œìˆ˜ë‹¨, ë©´ê³¼ì„¸êµ¬ë¶„, ì£¼ë¬¸ìƒíƒœ, ë°°ì†¡ì†¡
            FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜1
            UNION ALL
            SELECT 
                msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
                ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, 
                ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, 
                ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜, `ì£¼ë¬¸ë²ˆí˜¸(ì‡¼í•‘ëª°)`, ê²°ì œê¸ˆì•¡, ì£¼ë¬¸ê¸ˆì•¡, ê²°ì œìˆ˜ë‹¨, ë©´ê³¼ì„¸êµ¬ë¶„, ì£¼ë¬¸ìƒíƒœ, ë°°ì†¡ì†¡
            FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜2
            UNION ALL
            SELECT 
                msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
                ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, 
                ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, 
                ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜, `ì£¼ë¬¸ë²ˆí˜¸(ì‡¼í•‘ëª°)`, ê²°ì œê¸ˆì•¡, ì£¼ë¬¸ê¸ˆì•¡, ê²°ì œìˆ˜ë‹¨, ë©´ê³¼ì„¸êµ¬ë¶„, ì£¼ë¬¸ìƒíƒœ, ë°°ì†¡ì†¡
            FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜3
            """
            cursor.execute(insert_sql)
            connection.commit()
            print("ë°ì´í„° ë³‘í•© ë° ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜ê²°ê³¼ í…Œì´ë¸”ì— ì‚½ì… ì™„ë£Œ")
            time.sleep(1)

            # 3. ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ í…Œì´ë¸”ì— ë°ì´í„° ì¶”ê°€
            print("ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ í…Œì´ë¸”ì— ë°ì´í„° ì¶”ê°€ ì‹œì‘")
            insert_to_original_sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ (
                msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
                ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, 
                ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, 
                ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜, `ì£¼ë¬¸ë²ˆí˜¸(ì‡¼í•‘ëª°)`, ê²°ì œê¸ˆì•¡, ì£¼ë¬¸ê¸ˆì•¡, ê²°ì œìˆ˜ë‹¨, ë©´ê³¼ì„¸êµ¬ë¶„, ì£¼ë¬¸ìƒíƒœ, ë°°ì†¡ì†¡
            )
            SELECT 
                msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
                ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, 
                ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, 
                ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜, `ì£¼ë¬¸ë²ˆí˜¸(ì‡¼í•‘ëª°)`, ê²°ì œê¸ˆì•¡, ì£¼ë¬¸ê¸ˆì•¡, ê²°ì œìˆ˜ë‹¨, ë©´ê³¼ì„¸êµ¬ë¶„, ì£¼ë¬¸ìƒíƒœ, ë°°ì†¡ì†¡
            FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_í•©í¬ì¥ë³€í™˜ê²°ê³¼
            """
            cursor.execute(insert_to_original_sql)
            connection.commit()
            print("ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ í…Œì´ë¸”ì— ë°ì´í„° ì¶”ê°€ ì™„ë£Œ")
            time.sleep(1)

        print("ëª¨ë“  ì‘ì—… ì™„ë£Œ")
    except Exception as e:
        print(f"Error in merge_and_insert_data: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
merge_and_insert_data()


# í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬í•©í¬ë



# ê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œì‹œì‘


import time
import pymysql
import time
#1. í…Œì´ë¸” ë¹„ìš°ê¸°
def truncate_tables():
    print("í…Œì´ë¸” ë¹„ìš°ê¸° ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # í…Œì´ë¸” ë¹„ìš°ê¸°
            tables = [
                'ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œ',
                'ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œ1',
                'ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œ2',
                'ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œìë£Œ'
            ]
            for table in tables:
                cursor.execute(f"TRUNCATE TABLE {table}")
                print(f"{table} í…Œì´ë¸” ë¹„ìš°ê¸° ì™„ë£Œ")

            # ë³€ê²½ì‚¬í•­ ì €ì¥
            connection.commit()

    except Exception as e:
        print(f"Error in truncate_tables: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    truncate_tables()

time.sleep(1)

#2. ì—‘ì…€ì—ì„œ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
import pandas as pd
import pymysql
import time

def truncate_and_insert_busan():
    print("ê°ì²œ íŠ¹ë³„ì¶œê³  ì½”ë“œì…ë ¥ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # Excel íŒŒì¼ ê²½ë¡œ
    excel_file = '0.ê´€ë¦¬ìíŒŒì¼/ë¶€ì‚°ê°ì²œì„¼í„°ë¶„ë¦¬ì†¡ì¥.xlsx'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        # Excel íŒŒì¼ ì½ê¸°
        df = pd.read_excel(excel_file)

        # NaN ê°’ì„ ë¹ˆ ë¬¸ìì—´("")ë¡œ ëŒ€ì²´
        df.fillna('', inplace=True)

        # MySQL í…Œì´ë¸”ì— ë°ì´í„° ì‚½ì… ì „ì— í…Œì´ë¸” ë¹„ìš°ê¸°
        with connection.cursor() as cursor:
            # í…Œì´ë¸” ë¹„ìš°ê¸°
            cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ê°ì²œë¶„ë¦¬ì¶œê³ ")

        # MySQL í…Œì´ë¸”ì— ë°ì´í„° ì‚½ì…
        with connection.cursor() as cursor:
            for index, row in df.iterrows():
                sql = """
                INSERT INTO ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ê°ì²œë¶„ë¦¬ì¶œê³  (í’ˆëª©ì½”ë“œ, ìƒí’ˆëª…, ìˆ˜ëŸ‰)
                VALUES (%s, %s, %s)
                """
                cursor.execute(sql, (row['í’ˆëª©ì½”ë“œ'], row['ìƒí’ˆëª…'], row['ìˆ˜ëŸ‰']))

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        # í’ˆëª©ë“±ë¡ í…Œì´ë¸”ì—ì„œ íƒë°°ìˆ˜ëŸ‰ì„ ê°€ì ¸ì™€ì„œ ì—…ë°ì´íŠ¸
        with connection.cursor() as cursor:
            update_sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ê°ì²œë¶„ë¦¬ì¶œê³  a
            LEFT JOIN í’ˆëª©ë“±ë¡ b ON a.í’ˆëª©ì½”ë“œ = b.í’ˆëª©ì½”ë“œ
            SET a.íƒë°°ìˆ˜ëŸ‰ = COALESCE(b.íƒë°°ìˆ˜ëŸ‰, 10)
            """
            cursor.execute(update_sql)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print("ê°ì²œ íŠ¹ë³„ì¶œê³  ì½”ë“œì…ë ¥ ë")
    except Exception as e:
        print(f"Error in truncate_and_insert_busan: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
truncate_and_insert_busan()

time.sleep(1)



#3. ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸(í•©í¬ì¥,ë‹¨ì¼)
import pymysql

def update_shipping_type():
    print("ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ëª¨ë“  ì£¼ì†Œ ì¤‘ ì¤‘ë³µë˜ëŠ” ì£¼ì†Œ ì„ íƒ
            select_sql = """
            SELECT ì£¼ì†Œ
            FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            GROUP BY ì£¼ì†Œ
            HAVING COUNT(ì£¼ì†Œ) > 1
            """
            cursor.execute(select_sql)
            duplicate_addresses = cursor.fetchall()
            duplicate_addresses_set = {row['ì£¼ì†Œ'] for row in duplicate_addresses}

            # ì¤‘ë³µ ì£¼ì†Œë¥¼ ê°€ì§„ í–‰ì˜ ì†¡ì¥êµ¬ë¶„ì„ "í•©í¬ì¥"ìœ¼ë¡œ ì—…ë°ì´íŠ¸
            update_sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            SET ì†¡ì¥êµ¬ë¶„ = 'í•©í¬ì¥'
            WHERE ì£¼ì†Œ = %s
            AND í’ˆëª©ì½”ë“œ IN (SELECT í’ˆëª©ì½”ë“œ FROM ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ê°ì²œë¶„ë¦¬ì¶œê³ )
            """
            for address in duplicate_addresses_set:
                cursor.execute(update_sql, (address,))
                connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥

            # ì¤‘ë³µë˜ì§€ ì•ŠëŠ” ì£¼ì†Œë¥¼ ê°€ì§„ í–‰ì˜ ì†¡ì¥êµ¬ë¶„ì„ "ë‹¨ì¼"ë¡œ ì—…ë°ì´íŠ¸
            update_single_sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            SET ì†¡ì¥êµ¬ë¶„ = 'ë‹¨ì¼'
            WHERE í’ˆëª©ì½”ë“œ IN (SELECT í’ˆëª©ì½”ë“œ FROM ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ê°ì²œë¶„ë¦¬ì¶œê³ )
            AND ì£¼ì†Œ NOT IN (SELECT ì£¼ì†Œ FROM (
                SELECT ì£¼ì†Œ
                FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
                GROUP BY ì£¼ì†Œ
                HAVING COUNT(ì£¼ì†Œ) > 1
            ) AS subquery)
            """
            cursor.execute(update_single_sql)
            connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print("ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì™„ë£Œ")
    except Exception as e:
        print(f"Error in update_shipping_type: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    update_shipping_type()


time.sleep(1)
import time
import pymysql
import time
#1. í…Œì´ë¸” ë¹„ìš°ê¸°
def truncate_tables():
    print("í…Œì´ë¸” ë¹„ìš°ê¸° ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # í…Œì´ë¸” ë¹„ìš°ê¸°
            tables = [
                'ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œ',
                'ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œ1',
                'ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œ2',
                'ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œìë£Œ'
            ]
            for table in tables:
                cursor.execute(f"TRUNCATE TABLE {table}")
                print(f"{table} í…Œì´ë¸” ë¹„ìš°ê¸° ì™„ë£Œ")

            # ë³€ê²½ì‚¬í•­ ì €ì¥
            connection.commit()

    except Exception as e:
        print(f"Error in truncate_tables: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    truncate_tables()

time.sleep(1)

#2. ì—‘ì…€ì—ì„œ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
import pandas as pd
import pymysql
import time

def truncate_and_insert_busan():
    print("ê°ì²œ íŠ¹ë³„ì¶œê³  ì½”ë“œì…ë ¥ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # Excel íŒŒì¼ ê²½ë¡œ
    excel_file = '0.ê´€ë¦¬ìíŒŒì¼/ë¶€ì‚°ê°ì²œì„¼í„°ë¶„ë¦¬ì†¡ì¥.xlsx'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        # Excel íŒŒì¼ ì½ê¸°
        df = pd.read_excel(excel_file)

        # NaN ê°’ì„ ë¹ˆ ë¬¸ìì—´("")ë¡œ ëŒ€ì²´
        df.fillna('', inplace=True)

        # MySQL í…Œì´ë¸”ì— ë°ì´í„° ì‚½ì… ì „ì— í…Œì´ë¸” ë¹„ìš°ê¸°
        with connection.cursor() as cursor:
            # í…Œì´ë¸” ë¹„ìš°ê¸°
            cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ê°ì²œë¶„ë¦¬ì¶œê³ ")

        # MySQL í…Œì´ë¸”ì— ë°ì´í„° ì‚½ì…
        with connection.cursor() as cursor:
            for index, row in df.iterrows():
                sql = """
                INSERT INTO ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ê°ì²œë¶„ë¦¬ì¶œê³  (í’ˆëª©ì½”ë“œ, ìƒí’ˆëª…, ìˆ˜ëŸ‰)
                VALUES (%s, %s, %s)
                """
                cursor.execute(sql, (row['í’ˆëª©ì½”ë“œ'], row['ìƒí’ˆëª…'], row['ìˆ˜ëŸ‰']))

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        # í’ˆëª©ë“±ë¡ í…Œì´ë¸”ì—ì„œ íƒë°°ìˆ˜ëŸ‰ì„ ê°€ì ¸ì™€ì„œ ì—…ë°ì´íŠ¸
        with connection.cursor() as cursor:
            update_sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ê°ì²œë¶„ë¦¬ì¶œê³  a
            LEFT JOIN í’ˆëª©ë“±ë¡ b ON a.í’ˆëª©ì½”ë“œ = b.í’ˆëª©ì½”ë“œ
            SET a.íƒë°°ìˆ˜ëŸ‰ = COALESCE(b.íƒë°°ìˆ˜ëŸ‰, 10)
            """
            cursor.execute(update_sql)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print("ê°ì²œ íŠ¹ë³„ì¶œê³  ì½”ë“œì…ë ¥ ë")
    except Exception as e:
        print(f"Error in truncate_and_insert_busan: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
truncate_and_insert_busan()

time.sleep(1)



#3. ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸(í•©í¬ì¥,ë‹¨ì¼)
import pymysql

def update_shipping_type():
    print("ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ëª¨ë“  ì£¼ì†Œ ì¤‘ ì¤‘ë³µë˜ëŠ” ì£¼ì†Œ ì„ íƒ
            select_sql = """
            SELECT ì£¼ì†Œ
            FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            GROUP BY ì£¼ì†Œ
            HAVING COUNT(ì£¼ì†Œ) > 1
            """
            cursor.execute(select_sql)
            duplicate_addresses = cursor.fetchall()
            duplicate_addresses_set = {row['ì£¼ì†Œ'] for row in duplicate_addresses}

            # ì¤‘ë³µ ì£¼ì†Œë¥¼ ê°€ì§„ í–‰ì˜ ì†¡ì¥êµ¬ë¶„ì„ "í•©í¬ì¥"ìœ¼ë¡œ ì—…ë°ì´íŠ¸
            update_sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            SET ì†¡ì¥êµ¬ë¶„ = 'í•©í¬ì¥'
            WHERE ì£¼ì†Œ = %s
            AND í’ˆëª©ì½”ë“œ IN (SELECT í’ˆëª©ì½”ë“œ FROM ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ê°ì²œë¶„ë¦¬ì¶œê³ )
            """
            for address in duplicate_addresses_set:
                cursor.execute(update_sql, (address,))
                connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥

            # ì¤‘ë³µë˜ì§€ ì•ŠëŠ” ì£¼ì†Œë¥¼ ê°€ì§„ í–‰ì˜ ì†¡ì¥êµ¬ë¶„ì„ "ë‹¨ì¼"ë¡œ ì—…ë°ì´íŠ¸
            update_single_sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            SET ì†¡ì¥êµ¬ë¶„ = 'ë‹¨ì¼'
            WHERE í’ˆëª©ì½”ë“œ IN (SELECT í’ˆëª©ì½”ë“œ FROM ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ê°ì²œë¶„ë¦¬ì¶œê³ )
            AND ì£¼ì†Œ NOT IN (SELECT ì£¼ì†Œ FROM (
                SELECT ì£¼ì†Œ
                FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
                GROUP BY ì£¼ì†Œ
                HAVING COUNT(ì£¼ì†Œ) > 1
            ) AS subquery)
            """
            cursor.execute(update_single_sql)
            connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print("ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì™„ë£Œ")
    except Exception as e:
        print(f"Error in update_shipping_type: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    update_shipping_type()


time.sleep(1)
import pymysql

def transfer_and_delete_data():
    print("ë°ì´í„° ì „ì†¡ ë° ì‚­ì œ ì‹œì‘")
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # 0. ëŒ€ìƒ í…Œì´ë¸” ë¹„ìš°ê¸°
            cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œ")
            connection.commit()
            print("ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œ í…Œì´ë¸” ë¹„ìš°ê¸° ì™„ë£Œ")

            # 1. ë‹¨ì¼ ì†¡ì¥ ì‚½ì…
            insert_single_sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œ
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            WHERE í’ˆëª©ì½”ë“œ IN (
                SELECT í’ˆëª©ì½”ë“œ FROM ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ê°ì²œë¶„ë¦¬ì¶œê³ 
            )
            AND ì†¡ì¥êµ¬ë¶„ = 'ë‹¨ì¼'
            """
            cursor.execute(insert_single_sql)
            print("ë‹¨ì¼ ì†¡ì¥ ë°ì´í„° ì‚½ì… ì™„ë£Œ")

            # 2. ë‹¨ì¼ ì†¡ì¥ ì‚­ì œ
            delete_single_sql = """
            DELETE FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            WHERE í’ˆëª©ì½”ë“œ IN (
                SELECT í’ˆëª©ì½”ë“œ FROM ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ê°ì²œë¶„ë¦¬ì¶œê³ 
            )
            AND ì†¡ì¥êµ¬ë¶„ = 'ë‹¨ì¼'
            """
            cursor.execute(delete_single_sql)
            print("ë‹¨ì¼ ì†¡ì¥ ë°ì´í„° ì‚­ì œ ì™„ë£Œ")

            # 3. ì†¡ì¥êµ¬ë¶„ìµœì¢… ì—…ë°ì´íŠ¸ (ìˆ˜ëŸ‰ ë¹„êµ)
            update_sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ A
            JOIN ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ê°ì²œë¶„ë¦¬ì¶œê³  B
              ON A.í’ˆëª©ì½”ë“œ = B.í’ˆëª©ì½”ë“œ
            SET A.ì†¡ì¥êµ¬ë¶„ìµœì¢… = IF(A.ìˆ˜ëŸ‰ >= B.ìˆ˜ëŸ‰, '1', NULL)
            """
            cursor.execute(update_sql)
            connection.commit()
            print("3. ì†¡ì¥êµ¬ë¶„ìµœì¢… ì—…ë°ì´íŠ¸ ì™„ë£Œ")

            # 4. í•©í¬ì¥ + ì†¡ì¥êµ¬ë¶„ìµœì¢…=1 ì¡°ê±´ìœ¼ë¡œ ë³µì‚¬
            insert_merge_sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œ
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            WHERE ì†¡ì¥êµ¬ë¶„ = 'í•©í¬ì¥'
              AND ì†¡ì¥êµ¬ë¶„ìµœì¢… = '1'
            """
            cursor.execute(insert_merge_sql)
            print("4. ì¡°ê±´ë¶€ í•©í¬ì¥ ë³µì‚¬ ì™„ë£Œ")

            # 5. ë³µì‚¬í•œ í•©í¬ì¥ ë°ì´í„° ì›ë³¸ ì‚­ì œ
            delete_merge_sql = """
            DELETE FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            WHERE ì†¡ì¥êµ¬ë¶„ = 'í•©í¬ì¥'
              AND ì†¡ì¥êµ¬ë¶„ìµœì¢… = '1'
            """
            cursor.execute(delete_merge_sql)
            connection.commit()
            print("5. ì¡°ê±´ë¶€ í•©í¬ì¥ ì›ë³¸ ì‚­ì œ ì™„ë£Œ")

    except Exception as e:
        print(f"Error in transfer_and_delete_data: {e}")
    finally:
        connection.close()

if __name__ == "__main__":
    transfer_and_delete_data()


import pymysql

def reset_gc_prefix():
    print("GC_ ì ‘ë‘ì‚¬ ì¬ì •ë¦¬ ì‹œì‘")

    # DB ì—°ê²° ì •ë³´
    connection = pymysql.connect(
        host='gramwonlogis.mycafe24.com',
        port=3306,
        user='gramwonlogis',
        password='jung5516!',
        database='gramwonlogis',
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # 1. GC_ë¡œ ì‹œì‘í•˜ëŠ” ì†¡ì¥ëª…ì—ì„œ GC_ ì œê±°
            remove_gc_sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œ
            SET ì†¡ì¥ëª… = SUBSTRING(ì†¡ì¥ëª…, 4)
            WHERE LEFT(ì†¡ì¥ëª…, 3) = 'GC_'
            """
            removed = cursor.execute(remove_gc_sql)
            print(f"GC_ ì œê±° ì™„ë£Œ: {removed}ê±´")

            # 2. ëª¨ë“  ì†¡ì¥ëª… ì•ì— GC_ ì¶”ê°€
            add_gc_sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œ
            SET ì†¡ì¥ëª… = CONCAT('GC_', ì†¡ì¥ëª…)
            """
            added = cursor.execute(add_gc_sql)
            connection.commit()
            print(f"GC_ ë‹¤ì‹œ ì¶”ê°€ ì™„ë£Œ: {added}ê±´")

    except Exception as e:
        print(f"ì˜¤ë¥˜ ë°œìƒ: {e}")

    finally:
        connection.close()

if __name__ == "__main__":
    reset_gc_prefix()

time.sleep(1)

import pymysql

def merge_into_original():
    print("ì‚¬ë°©ë„· ì›ë³¸ë³€í™˜ í…Œì´ë¸”ì— ë°ì´í„° ì‚½ì… ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ì¤‘ë³µëœ í•­ëª©ì„ ì—…ë°ì´íŠ¸
            insert_sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œ
            ON DUPLICATE KEY UPDATE
            ID = VALUES(ID),
            í’ˆëª©ì½”ë“œ = VALUES(í’ˆëª©ì½”ë“œ),
            ìˆ˜ëŸ‰ = VALUES(ìˆ˜ëŸ‰),
            íƒë°°ë¹„ìš© = VALUES(íƒë°°ë¹„ìš©),
            ë°•ìŠ¤í¬ê¸° = VALUES(ë°•ìŠ¤í¬ê¸°),
            ì†¡ì¥êµ¬ë¶„ = VALUES(ì†¡ì¥êµ¬ë¶„),
            ì†¡ì¥ëª… = VALUES(ì†¡ì¥ëª…),
            ì£¼ì†Œ = VALUES(ì£¼ì†Œ)
            """
            cursor.execute(insert_sql)
            connection.commit()
            print("ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œ2 ë°ì´í„° ì‚½ì… ì™„ë£Œ (ì‚¬ë°©ë„· ì›ë³¸ë³€í™˜)")

    except Exception as e:
        print(f"Error in merge_into_original: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    merge_into_original()

time.sleep(1)

import pymysql

def transfer_data():
    print("ë°ì´í„° ì „ì†¡ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ë°ì´í„° ì„ íƒ ë° ì‚½ì…
            transfer_sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œìë£Œ (í’ˆëª©ì½”ë“œ, ìˆ˜ëŸ‰)
            SELECT í’ˆëª©ì½”ë“œ, ìˆ˜ëŸ‰
            FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œ1
            """
            cursor.execute(transfer_sql)
            connection.commit()
            print("ë°ì´í„° ì „ì†¡ ì™„ë£Œ (ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_íŠ¹ìˆ˜ì¶œë ¥ê°ì²œìë£Œ)")

    except Exception as e:
        print(f"Error in transfer_data: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    transfer_data()

time.sleep(1)

# ê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œê°ì²œë

time.sleep(1)

import pandas as pd
import pymysql
import time

def truncate_and_insert_kakao():
    print("ì¹´ì¹´ì˜¤ í–‰ì‚¬ ì½”ë“œ ì…ë ¥ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # Excel íŒŒì¼ ê²½ë¡œ
    excel_file = '0.ê´€ë¦¬ìíŒŒì¼/ì¹´ì¹´ì˜¤í–‰ì‚¬.xlsx'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        # Excel íŒŒì¼ ì½ê¸°
        df = pd.read_excel(excel_file)

        # NaN ê°’ì„ ë¹ˆ ë¬¸ìì—´("")ë¡œ ëŒ€ì²´
        df.fillna('', inplace=True)

        # MySQL í…Œì´ë¸”ì— ë°ì´í„° ì‚½ì… ì „ì— í…Œì´ë¸” ë¹„ìš°ê¸°
        with connection.cursor() as cursor:
            # í…Œì´ë¸” ë¹„ìš°ê¸°
            cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ì¹´ì¹´ì˜¤")

        # MySQL í…Œì´ë¸”ì— ë°ì´í„° ì‚½ì…
        with connection.cursor() as cursor:
            for index, row in df.iterrows():
                sql = """
                INSERT INTO ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ì¹´ì¹´ì˜¤ (ë¶„ë¦¬ì œí’ˆì½”ë“œ, ìƒí’ˆëª…, ì ìš”)
                VALUES (%s, %s, %s)
                """
                cursor.execute(sql, (row['ë¶„ë¦¬ì œí’ˆì½”ë“œ'], row['ìƒí’ˆëª…'], row['ì ìš”']))

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print("ì¹´ì¹´ì˜¤ í–‰ì‚¬ ì½”ë“œ ì…ë ¥ ë")
    except Exception as e:
        print(f"Error in truncate_and_insert_kakao: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

def move_kakao_store_data():
    print("ì¹´ì¹´ì˜¤í†¡ìŠ¤í† ì–´ ì˜®ê¸°ê¸° ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_ì¹´ì¹´ì˜¤í–‰ì‚¬ë³€í™˜ í…Œì´ë¸” ì´ˆê¸°í™”
            truncate_sql = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_ì¹´ì¹´ì˜¤í–‰ì‚¬ë³€í™˜;"
            cursor.execute(truncate_sql)
            
            # ì¡°ê±´ì— ë§ëŠ” ë°ì´í„°ë¥¼ ìƒˆë¡œìš´ í…Œì´ë¸”ì— ì‚½ì…
            insert_sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_ì¹´ì¹´ì˜¤í–‰ì‚¬ë³€í™˜ (
                msg1, msg2, msg3, msg4, msg5, msg6,
                ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ,
                ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°,
                ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°,
                ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜,
                íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„,
                ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
            )
            SELECT 
                msg1, msg2, msg3, msg4, msg5, msg6,
                ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ,
                ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°,
                ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°,
                ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜,
                íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„,
                ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
            FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            WHERE ì‡¼í•‘ëª° = 'ì¹´ì¹´ì˜¤í†¡ìŠ¤í† ì–´';
            """
            cursor.execute(insert_sql)
            connection.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

            print(f"Inserted {cursor.rowcount} rows.")
            print("ì¹´ì¹´ì˜¤í†¡ìŠ¤í† ì–´ ì˜®ê¸°ê¸° ë")
    except Exception as e:
        print(f"Error in move_kakao_store_data: {e}")
    finally:
        connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

def kakao_store_event_check():
    print("ì¹´ì¹´ì˜¤í†¡ìŠ¤í† ì–´ í–‰ì‚¬í’ˆëª©í™•ì¸ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ì¡°ê±´ì— ë§ì§€ ì•ŠëŠ” í–‰ ì‚­ì œ
            delete_sql = """
            DELETE FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_ì¹´ì¹´ì˜¤í–‰ì‚¬ë³€í™˜
            WHERE í’ˆëª©ì½”ë“œ NOT IN (
                SELECT ë¶„ë¦¬ì œí’ˆì½”ë“œ FROM ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ì¹´ì¹´ì˜¤
            );
            """
            cursor.execute(delete_sql)
            connection.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

            print(f"Deleted {cursor.rowcount} rows.")  # ì‚­ì œëœ í–‰ ìˆ˜ ì¶œë ¥
            print("ì¹´ì¹´ì˜¤í†¡ìŠ¤í† ì–´ í–‰ì‚¬í’ˆëª©í™•ì¸ ë")
    except Exception as e:
        print(f"Error in kakao_store_event_check: {e}")
    finally:
        connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

def kakao_store_price_update():
    print("ì¹´ì¹´ì˜¤í†¡ìŠ¤í† ì–´ í–‰ì‚¬í’ˆëª©ê°€ê²©ê°€ì ¸ì˜¤ê¸° ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # 1. íƒë°°ë¹„ìš© ì»¬ëŸ¼ì„ ì ìš” ê°’ìœ¼ë¡œ ì—…ë°ì´íŠ¸
            update_sql_1 = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_ì¹´ì¹´ì˜¤í–‰ì‚¬ë³€í™˜ AS t1
            JOIN ì†¡ì¥ì¶œë ¥_íŠ¹ìˆ˜ì¶œë ¥_ì¹´ì¹´ì˜¤ AS t2
            ON t1.í’ˆëª©ì½”ë“œ = t2.ë¶„ë¦¬ì œí’ˆì½”ë“œ
            SET t1.íƒë°°ë¹„ìš© = t2.ì ìš”;
            """
            cursor.execute(update_sql_1)
            connection.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜
            print(f"Step 1: Updated {cursor.rowcount} rows for íƒë°°ë¹„ìš© with ì ìš”.")

            # 2. íƒë°°ë¹„ìš© ê°’ì„ ìˆ˜ëŸ‰ê³¼ ê³±í•˜ì—¬ ì—…ë°ì´íŠ¸
            update_sql_2 = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_ì¹´ì¹´ì˜¤í–‰ì‚¬ë³€í™˜
            SET íƒë°°ë¹„ìš© = íƒë°°ë¹„ìš© * ìˆ˜ëŸ‰;
            """
            cursor.execute(update_sql_2)
            connection.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜
            print(f"Step 2: Updated {cursor.rowcount} rows for íƒë°°ë¹„ìš© with multiplied value.")
            print("ì¹´ì¹´ì˜¤í†¡ìŠ¤í† ì–´ í–‰ì‚¬í’ˆëª©ê°€ê²©ê°€ì ¸ì˜¤ê¸° ë")
    except Exception as e:
        print(f"Error in kakao_store_price_update: {e}")
    finally:
        connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

def kakao_store_price_sum_update():
    print("ì¹´ì¹´ì˜¤í†¡ìŠ¤í† ì–´ í–‰ì‚¬í’ˆëª©ê°€ê²© ì—…ë°ì´íŠ¸ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ì£¼ì†Œë³„ íƒë°°ë¹„ìš© í•©ì‚° ê°’ì„ ë°•ìŠ¤í¬ê¸° ì»¬ëŸ¼ì— ì—…ë°ì´íŠ¸
            update_sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_ì¹´ì¹´ì˜¤í–‰ì‚¬ë³€í™˜ AS t1
            JOIN (
                SELECT ì£¼ì†Œ, SUM(íƒë°°ë¹„ìš©) AS í•©ì‚°íƒë°°ë¹„ìš©
                FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_ì¹´ì¹´ì˜¤í–‰ì‚¬ë³€í™˜
                GROUP BY ì£¼ì†Œ
            ) AS t2
            ON t1.ì£¼ì†Œ = t2.ì£¼ì†Œ
            SET t1.ë°•ìŠ¤í¬ê¸° = t2.í•©ì‚°íƒë°°ë¹„ìš©;
            """
            cursor.execute(update_sql)
            connection.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

            print(f"Updated {cursor.rowcount} rows.")
            print("ì¹´ì¹´ì˜¤í†¡ìŠ¤í† ì–´ í–‰ì‚¬í’ˆëª©ê°€ê²© ì—…ë°ì´íŠ¸ ë")
    except Exception as e:
        print(f"Error in kakao_store_price_sum_update: {e}")
    finally:
        connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

def kakao_event_exclude_delete():
    print("ì¹´ì¹´ì˜¤í–‰ì‚¬ ì œì™¸ì‚­ì œ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ë°•ìŠ¤í¬ê¸° ê°’ì´ 29999 ì´ìƒì¸ í–‰ì„ ì œì™¸í•˜ê³  ë‚˜ë¨¸ì§€ í–‰ì„ ì‚­ì œ
            delete_sql = """
            DELETE FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_ì¹´ì¹´ì˜¤í–‰ì‚¬ë³€í™˜
            WHERE ë°•ìŠ¤í¬ê¸° < 29999;
            """
            cursor.execute(delete_sql)
            connection.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

            print(f"Deleted {cursor.rowcount} rows.")
            print("ì¹´ì¹´ì˜¤í–‰ì‚¬ ì œì™¸ì‚­ì œ ë")
    except Exception as e:
        print(f"Error in kakao_event_exclude_delete: {e}")
    finally:
        connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

def kakao_event_exclude_delete_2():
    print("ì¹´ì¹´ì˜¤í–‰ì‚¬ ì œì™¸ì‚­ì œ2 ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ì£¼ì†Œ ê°’ìœ¼ë¡œ ì¤‘ë³µëœ í–‰ì„ ì‚­ì œ
            delete_sql = """
            DELETE t1 FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_ì¹´ì¹´ì˜¤í–‰ì‚¬ë³€í™˜ t1
            INNER JOIN (
                SELECT MIN(id) as min_id, ì£¼ì†Œ
                FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_ì¹´ì¹´ì˜¤í–‰ì‚¬ë³€í™˜
                GROUP BY ì£¼ì†Œ
                HAVING COUNT(*) > 1
            ) t2
            ON t1.ì£¼ì†Œ = t2.ì£¼ì†Œ AND t1.id > t2.min_id;
            """
            cursor.execute(delete_sql)
            connection.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

            print(f"Deleted {cursor.rowcount} rows.")
            print("ì¹´ì¹´ì˜¤í–‰ì‚¬ ì œì™¸ì‚­ì œ2 ë")
    except Exception as e:
        print(f"Error in kakao_event_exclude_delete_2: {e}")
    finally:
        connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

def kakao_event_final():
    print("ì¹´ì¹´ì˜¤í–‰ì‚¬ ìµœì¢…ë§ˆë¬´ë¦¬ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ì˜µì…˜ëª…, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ ì»¬ëŸ¼ ì—…ë°ì´íŠ¸
            update_sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_ì¹´ì¹´ì˜¤í–‰ì‚¬ë³€í™˜
            SET ì˜µì…˜ëª… = 'â™¥ë¦¬ë·°ì•½ì†â™¥ì‚¬ì€í’ˆ_ì•„í† _í•´ë¬¼ëª¨ë“¬ 600g',
                ì†¡ì¥ëª… = 'â™¥ë¦¬ë·°ì•½ì†â™¥ì‚¬ì€í’ˆ_ì•„í† _í•´ë¬¼ëª¨ë“¬ 600g',
                í’ˆëª©ì½”ë“œ = '3702',
                ìˆ˜ëŸ‰ = '1';
            """
            cursor.execute(update_sql)
            connection.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜
            print(f"Updated {cursor.rowcount} rows for ì˜µì…˜ëª…, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ.")

            # íƒë°°ë¹„ìš©ê³¼ ë°•ìŠ¤í¬ê¸° ì»¬ëŸ¼ ì‚­ì œ
            alter_sql = """
            ALTER TABLE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_ì¹´ì¹´ì˜¤í–‰ì‚¬ë³€í™˜
            SET íƒë°°ë¹„ìš© = NULL,
                ë°•ìŠ¤í¬ê¸° = NULL;
            """
            cursor.execute(alter_sql)
            connection.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜
            print("Deleted íƒë°°ë¹„ìš© and ë°•ìŠ¤í¬ê¸° columns.")
            print("ì¹´ì¹´ì˜¤í–‰ì‚¬ ìµœì¢…ë§ˆë¬´ë¦¬ ë")
    except Exception as e:
        print(f"Error in kakao_event_final: {e}")
    finally:
        connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

def main():
    truncate_and_insert_kakao()
    time.sleep(1)

    move_kakao_store_data()
    time.sleep(1)

    kakao_store_event_check()
    time.sleep(1)

    kakao_store_price_update()
    time.sleep(1)

    kakao_store_price_sum_update()
    time.sleep(1)

    kakao_event_exclude_delete()
    time.sleep(1)

    kakao_event_exclude_delete_2()
    time.sleep(1)

    kakao_event_final()
    time.sleep(1)

if __name__ == "__main__":
    main()

# ---. ì†¡ì¥ ì½”ë“œ ì—…ë°ì´íŠ¸ ì‹œì‘
print("ì†¡ì¥ ì½”ë“œ ì—…ë°ì´íŠ¸ ì‹œì‘")

import pymysql

def move_all_data():
    print("ë°ì´í„° ì´ë™ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ë°ì´í„°ê°€ ìˆëŠ”ì§€ í™•ì¸
            check_sql = "SELECT COUNT(*) as cnt FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_ì¹´ì¹´ì˜¤í–‰ì‚¬ë³€í™˜"
            cursor.execute(check_sql)
            result = cursor.fetchone()

            if result['cnt'] == 0:
                print("ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_ì¹´ì¹´ì˜¤í–‰ì‚¬ë³€í™˜ í…Œì´ë¸”ì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.")
                return

            # ë°ì´í„° ì´ë™
            insert_sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ (
                msg1, msg2, msg3, msg4, msg5, msg6,
                ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ,
                ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°,
                ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰,
                ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1,
                íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…,
                ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
            )
            SELECT 
                msg1, msg2, msg3, msg4, msg5, msg6,
                ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ,
                ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°,
                ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰,
                ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1,
                íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…,
                ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
            FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜_ì¹´ì¹´ì˜¤í–‰ì‚¬ë³€í™˜;
            """
            cursor.execute(insert_sql)
            connection.commit()
            print(f"Moved {cursor.rowcount} rows to ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜.")

    except Exception as e:
        print(f"Error in move_all_data: {e}")
    finally:
        connection.close()
        print("ë°ì´í„° ì´ë™ ì™„ë£Œ")

if __name__ == "__main__":
    move_all_data()


import pymysql

def update_table_order_by_address():
    print("ì£¼ì†Œë¡œ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ê¸°ì¡´ í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ ì •ë ¬ëœ ìƒíƒœë¡œ ì„ì‹œ í…Œì´ë¸”ì— ë³µì‚¬
            temp_table_sql = """
            CREATE TEMPORARY TABLE temp_table AS
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            ORDER BY ì£¼ì†Œ ASC;
            """
            cursor.execute(temp_table_sql)

            # ê¸°ì¡´ í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ ì‚­ì œ
            delete_sql = "DELETE FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜;"
            cursor.execute(delete_sql)

            # ì„ì‹œ í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ ê¸°ì¡´ í…Œì´ë¸”ë¡œ ë³µì‚¬
            insert_sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            SELECT * FROM temp_table;
            """
            cursor.execute(insert_sql)

            # ì„ì‹œ í…Œì´ë¸” ì‚­ì œ
            drop_temp_table_sql = "DROP TEMPORARY TABLE temp_table;"
            cursor.execute(drop_temp_table_sql)

            # ë³€ê²½ì‚¬í•­ ì €ì¥
            connection.commit()

            print("ì£¼ì†Œë¡œ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬ ì™„ë£Œ")
    except Exception as e:
        print(f"Error in update_table_order_by_address: {e}")
    finally:
        connection.close()
        print("ì£¼ì†Œë¡œ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬ ì¢…ë£Œ")

if __name__ == "__main__":
    update_table_order_by_address()





# ---. ì†¡ì¥ ì½”ë“œ ì—…ë°ì´íŠ¸ ì‹œì‘
print("ì†¡ì¥ ì½”ë“œ ì—…ë°ì´íŠ¸ ì‹œì‘")

import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„¤ì •
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci'
)

try:
    with conn.cursor() as cursor:
        # í’ˆëª©ì½”ë“œê°€ ë¹„ì–´ìˆëŠ” í–‰ì„ ì°¾ê¸°
        select_sql = """
        SELECT id
        FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        WHERE í’ˆëª©ì½”ë“œ = '' OR í’ˆëª©ì½”ë“œ IS NULL
        """
        cursor.execute(select_sql)
        results = cursor.fetchall()

        # í’ˆëª©ì½”ë“œì™€ ì†¡ì¥ëª…ì„ ì—…ë°ì´íŠ¸
        update_sql = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET í’ˆëª©ì½”ë“œ = '0000', ì†¡ì¥ëª… = '--'
        WHERE id = %s
        """
        for row in results:
            cursor.execute(update_sql, (row[0],))

        conn.commit()

finally:
    conn.close()

print("ì½”ë“œ ì—…ë°ì´íŠ¸ ë")
# ---ë





# ---. ì†¡ì¥ ì´ë¦„ì™¸ì ë³€ê²½ ì‹œì‘
print("ì†¡ì¥ ì´ë¦„ì™¸ì ë³€ê²½ ì‹œì‘")
# ---ì‹œì‘

import pymysql
import time

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„¤ì •
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci'
)

try:
    with conn.cursor() as cursor:
        # ìˆ˜ì·¨ì¸ëª…ì´ 1ê¸€ìì¸ í–‰ì„ ì°¾ê¸°
        select_sql = """
        SELECT id, ìˆ˜ì·¨ì¸ëª…
        FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        WHERE CHAR_LENGTH(ìˆ˜ì·¨ì¸ëª…) = 1
        """
        cursor.execute(select_sql)
        results = cursor.fetchall()

        # ìˆ˜ì·¨ì¸ëª…ì„ ë‘ ë²ˆ ë°˜ë³µí•˜ì—¬ ì—…ë°ì´íŠ¸
        update_sql = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ìˆ˜ì·¨ì¸ëª… = CONCAT(ìˆ˜ì·¨ì¸ëª…, ìˆ˜ì·¨ì¸ëª…)
        WHERE id = %s
        """
        for row in results:
            cursor.execute(update_sql, (row[0],))

        conn.commit()

finally:
    conn.close()

# ---. ì´ë¦„ì™¸ì ë³€ê²½ ë
print("ì´ë¦„ì™¸ì ë³€ê²½ ë")
# ---ë

# ì§§ì€ íœ´ì‹
time.sleep(1)


# ---. ì†¡ì¥'ë©”ì„¸ì§€' ë„£ê¸°
print("ì†¡ì¥ ë©”ì„¸ì§€ ë„£ê¸° ì‹œì‘")
# ---ì‹œì‘
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì¿¼ë¦¬ ì‘ì„±
        sql = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ AS s
        LEFT JOIN ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ AS m ON s.ì‡¼í•‘ëª° = m.ì‡¼í•‘ëª°
        SET 
            s.msg1 = IFNULL(m.msg1, (SELECT msg1 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1)),
            s.msg2 = IFNULL(m.msg2, (SELECT msg2 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1)),
            s.msg3 = IFNULL(m.msg3, (SELECT msg3 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1)),
            s.msg4 = IFNULL(m.msg4, (SELECT msg4 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1)),
            s.msg5 = IFNULL(m.msg5, (SELECT msg5 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1)),
            s.msg6 = IFNULL(m.msg6, (SELECT msg6 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1))
        """
        
        # ì¿¼ë¦¬ ì‹¤í–‰
        cursor.execute(sql)
        
    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

# ---. ì†¡ì¥'ë©”ì„¸ì§€' ë„£ê¸°
print("ì†¡ì¥ ë©”ì„¸ì§€ ë„£ê¸° ë")
# ---ë


import time

time.sleep(1)




# ---. ì´ì¹´ìš´íŠ¸ ë°•ìŠ¤ìˆ˜ëŸ‰ ë„£ê¸°
print("ì´ì¹´ìš´íŠ¸ ë°•ìŠ¤ìˆ˜ëŸ‰ ë„£ê¸° ì‹œì‘")
# ---ì‹œì‘
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì¿¼ë¦¬ ì‘ì„±
        sql = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ AS s
        JOIN í’ˆëª©ë“±ë¡ AS p ON s.í’ˆëª©ì½”ë“œ = p.í’ˆëª©ì½”ë“œ
        SET s.íƒë°°ìˆ˜ëŸ‰ = IFNULL(p.íƒë°°ìˆ˜ëŸ‰, 10)
        """
        
        # ì¿¼ë¦¬ ì‹¤í–‰
        cursor.execute(sql)
        
    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()
# ---. ì´ì¹´ìš´íŠ¸ ë°•ìŠ¤ìˆ˜ëŸ‰ ë„£ê¸°
print("ì´ì¹´ìš´íŠ¸ ë°•ìŠ¤ìˆ˜ëŸ‰ ë„£ê¸° ë")
# ---ë


import time

time.sleep(1)





# ---. ì†¡ì¥êµ¬ë¶„ìë„£ê¸°
print("ì†¡ì¥êµ¬ë¶„ìë„£ê¸° ì‹œì‘")
# ---ì‹œì‘

import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì¿¼ë¦¬ ì‘ì„±
        sql = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ì = LEFT(TRIM(ì†¡ì¥ëª…), 3)
        """
        
        # ì¿¼ë¦¬ ì‹¤í–‰
        cursor.execute(sql)
        
    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()
# ---. ì†¡ì¥êµ¬ë¶„ìë„£ê¸°
print("ì†¡ì¥êµ¬ë¶„ìë„£ê¸° ë")
# ---ë


import time

time.sleep(1)




# ---. ì†¡ì¥êµ¬ë¶„í•˜ê¸° ì¶œê³ ì§€ë³„
print("ì¶œê³ ì§€ë³„ë¡œ ì†¡ì¥êµ¬ë¶„í•˜ê¸° ì‹œì‘")
# --ì‹œì‘
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì¿¼ë¦¬ ì‘ì„±
        sql = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ = 
            CASE 
                WHEN ì†¡ì¥êµ¬ë¶„ì = 'GR_' THEN 'ìœ„íƒ'
                WHEN ì†¡ì¥êµ¬ë¶„ì = 'AR_' THEN 'ìœ„íƒ'
                WHEN ì†¡ì¥êµ¬ë¶„ì = 'BS_' THEN 'ë¶€ì‚°'
                WHEN ì†¡ì¥êµ¬ë¶„ì = 'GS_' THEN 'ê³µì‚°'
                WHEN ì†¡ì¥êµ¬ë¶„ì = 'YC_' THEN 'ì²­ê³¼'
                WHEN ì†¡ì¥êµ¬ë¶„ì = 'HY_' THEN 'ì²­ê³¼'
                WHEN ì†¡ì¥êµ¬ë¶„ì = 'GC_' THEN 'ê°ì²œ'
                ELSE 'ëƒ‰ë™'
            END
        """
        
        # ì¿¼ë¦¬ ì‹¤í–‰
        cursor.execute(sql)
        
    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

# ---. ì†¡ì¥êµ¬ë¶„í•˜ê¸° ì¶œê³ ì§€ë³„
print("ì¶œê³ ì§€ë³„ë¡œ ì†¡ì¥êµ¬ë¶„í•˜ê¸° ë")
# --ë

#íŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£Œ

import pymysql

def truncate_and_insert():
    print("í…Œì´ë¸” ë¹„ìš°ê¸° ë° ë°ì´í„° ì‚½ì… ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ì†¡ì¥ì¶œë ¥_ì£¼ë¬¸ì •ë³´ í…Œì´ë¸”ì˜ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œ (TRUNCATE)
            truncate_sql = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì£¼ë¬¸ì •ë³´;"
            cursor.execute(truncate_sql)
            print("ì†¡ì¥ì¶œë ¥_ì£¼ë¬¸ì •ë³´ í…Œì´ë¸” ë¹„ìš°ê¸° ì™„ë£Œ")

            # ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ì—ì„œ ë°ì´í„°ë¥¼ ì„ íƒí•˜ì—¬ ì†¡ì¥ì¶œë ¥_ì£¼ë¬¸ì •ë³´ í…Œì´ë¸”ì— ì‚½ì…
            insert_sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì£¼ë¬¸ì •ë³´ (
                ì£¼ë¬¸ë²ˆí˜¸_ì‡¼í•‘ëª°,
                ì£¼ë¬¸ë²ˆí˜¸_ì‚¬ë°©ë„·,
                ìˆ˜ì§‘ì¼,
                ì‡¼í•‘ëª°,
                ë°›ëŠ”ì‚¬ëŒ,
                ìƒí’ˆëª…,
                ë¬¼ë¥˜ìš©ì½”ë“œ,
                ì½”ë“œë²ˆí˜¸,
                ìˆ˜ëŸ‰,
                ë°°ì†¡ì†¡,
                ê²°ì œê¸ˆì•¡,
                ì£¼ë¬¸ê¸ˆì•¡,
                ë©´ê³¼ì„¸_êµ¬ë¶„,
                ê²°ì œìˆ˜ë‹¨,
                ì£¼ì†Œ,
                ì „í™”ë²ˆí˜¸,
                ì „í™”ë²ˆí˜¸2,
                ì£¼ë¬¸ìƒíƒœ
            )
            SELECT 
                `ì£¼ë¬¸ë²ˆí˜¸(ì‡¼í•‘ëª°)` AS ì£¼ë¬¸ë²ˆí˜¸_ì‡¼í•‘ëª°,
                ì£¼ë¬¸ë²ˆí˜¸,
                ìˆ˜ì§‘ì‹œê°„ AS ìˆ˜ì§‘ì¼,
                ì‡¼í•‘ëª°,
                ìˆ˜ì·¨ì¸ëª… AS ë°›ëŠ”ì‚¬ëŒ,
                ì˜µì…˜ëª… AS ìƒí’ˆëª…,
                í’ˆëª©ì½”ë“œ AS ë¬¼ë¥˜ìš©ì½”ë“œ,
                í’ˆëª©ì½”ë“œ AS ì½”ë“œë²ˆí˜¸,
                ìˆ˜ëŸ‰,
                ë°°ì†¡ì†¡,
                ê²°ì œê¸ˆì•¡,
                ì£¼ë¬¸ê¸ˆì•¡,
                ë©´ê³¼ì„¸êµ¬ë¶„ AS ë©´ê³¼ì„¸_êµ¬ë¶„,
                ê²°ì œìˆ˜ë‹¨,
                ì£¼ì†Œ,
                ì†¡ì¥êµ¬ë¶„ AS ì „í™”ë²ˆí˜¸,  -- 'ì†¡ì¥êµ¬ë¶„' ê°’ì„ 'ì „í™”ë²ˆí˜¸'ë¡œ ì‚½ì…
                ì „í™”ë²ˆí˜¸2,
                ì£¼ë¬¸ìƒíƒœ
            FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜;
            """
            cursor.execute(insert_sql)
            connection.commit()
            print("ë°ì´í„° ì‚½ì… ì™„ë£Œ (ì†¡ì¥ì¶œë ¥_ì£¼ë¬¸ì •ë³´)")

    except Exception as e:
        print(f"ì˜¤ë¥˜ ë°œìƒ: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

def update_product_names():
    print("ìƒí’ˆëª… ì—…ë°ì´íŠ¸ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        charset='utf8mb4',
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ìƒí’ˆëª…ì— ë”°ë¥¸ ì—…ë°ì´íŠ¸ ì¿¼ë¦¬
            update_query = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì£¼ë¬¸ì •ë³´
            SET ì „í™”ë²ˆí˜¸ = CASE
                WHEN ì „í™”ë²ˆí˜¸ = 'ìœ„íƒ' THEN 'ë³¸ì‚¬ì°½ê³ '
                WHEN ì „í™”ë²ˆí˜¸ = 'ë¶€ì‚°' THEN 'ë¶€ì‚°ì°½ê³ '
                WHEN ì „í™”ë²ˆí˜¸ = 'ê³µì‚°' THEN 'ê²½ê¸°ê³µì‚°'
                WHEN ì „í™”ë²ˆí˜¸ = 'ì²­ê³¼' THEN 'ë¶€ì‚°ì²­ê³¼'
                WHEN ì „í™”ë²ˆí˜¸ = 'ëƒ‰ë™' THEN 'ë³¸ì‚¬ì°½ê³ '
                WHEN ì „í™”ë²ˆí˜¸ = 'ê°ì²œ' THEN 'ê°ì²œí•­ ë¬¼ë¥˜ì„¼í„°'
                ELSE 'ë³¸ì‚¬ì°½ê³ '
            END;
            """
            cursor.execute(update_query)
            connection.commit()
            print("ìƒí’ˆëª… ì—…ë°ì´íŠ¸ ì™„ë£Œ")

    except Exception as e:
        print(f"ì˜¤ë¥˜ ë°œìƒ: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    truncate_and_insert()
    update_product_names()


import pandas as pd
import mysql.connector
from datetime import datetime
import dropbox
import requests
import xlsxwriter  # xlsxwriter íŒ¨í‚¤ì§€ ì¶”ê°€

# MySQL ì—°ê²° ì„¤ì •
connection = mysql.connector.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci'
)

cursor = connection.cursor()
# ëª¨ë“  í–‰ì„ ê°€ì ¸ì˜¤ëŠ” ì¿¼ë¦¬
query = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ì£¼ë¬¸ì •ë³´"
cursor.execute(query)
result = cursor.fetchall()
columns = cursor.column_names
df = pd.DataFrame(result, columns=columns)
connection.close()

# íŒŒì¼ ì €ì¥ ë° Dropbox ì—…ë¡œë“œ
now = datetime.now()
file_path = f'íŒë§¤ì…ë ¥/íŒë§¤ì…ë ¥_ì´ì¹´ìš´íŠ¸ìë£Œ_{now.strftime("%y%m%d_%Hì‹œ%Më¶„")}.xlsx'
with pd.ExcelWriter(file_path, engine='xlsxwriter') as writer:
    df.to_excel(writer, index=False, header=True)  # ì—‘ì…€ íŒŒì¼ë¡œ ì €ì¥ (header=Falseë¡œ ì„¤ì •)
    workbook  = writer.book
    worksheet = writer.sheets['Sheet1']

# Dropbox ì•¡ì„¸ìŠ¤ í† í° ê°±ì‹  ë° íŒŒì¼ ì—…ë¡œë“œ
refresh_token = '1CLvznLL7BwAAAAAAAAAAagAlVx3w9P6NGyYjsITAxrSG9vlAEc31ohZZwYhUAB_'
app_key = 'vlxh3ec9nq5fi5t'
app_secret = 'h5rp5n0w9cp4ifk'
token_url = "https://api.dropbox.com/oauth2/token"
params = {
    'refresh_token': refresh_token,
    'grant_type': 'refresh_token',
    'client_id': app_key,
    'client_secret': app_secret
}
response = requests.post(token_url, data=params)
access_token = response.json().get('access_token')

dbx = dropbox.Dropbox(access_token)
with open(file_path, "rb") as f:
    dbx.files_upload(f.read(), f'/íŒë§¤ì…ë ¥/{file_path}', mode=dropbox.files.WriteMode("overwrite"))
shared_link_metadata = dbx.sharing_create_shared_link_with_settings(f'/íŒë§¤ì…ë ¥/{file_path}')

# ì‹œê°„ëŒ€ë³„ ì°¨ìˆ˜ ì„¤ì •
hour = now.hour
minute = now.minute

if 1 <= hour <= 7:
    batch = "1ì°¨"
elif 8 <= hour <= 10:
    batch = "2ì°¨"
elif 11 <= hour <= 11:
    batch = "3ì°¨"
elif 12 <= hour <= 13:
    batch = "4ì°¨"
elif 14 <= hour <= 15:
    batch = "5ì°¨"
elif 16 <= hour <= 18:
    batch = "ë§‰ì°¨"
elif 19 <= hour <= 23:
    batch = "ì¶”ê°€"
else:
    batch = ""  # 24ì‹œ(0ì‹œ)ëŠ” ë°°ì¹˜ ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ

# ì¹´ì¹´ì˜¤ì›Œí¬ ë©”ì‹œì§€ ì „ì†¡
app_key = 'b36ed46e.0b55706350e94ef8b49e8647a97ae1b7'
chatroom_id = '10545642'
time_string = now.strftime("%mì›” %dì¼ %Hì‹œ %Më¶„")

def send_kakao_work_message(app_key, chatroom_id, file_url, batch):
    url = "https://api.kakaowork.com/v1/messages.send"
    headers = {
        "Authorization": f"Bearer {app_key}",
        "Content-Type": "application/json"
    }
    data = {
        "conversation_id": chatroom_id,
        "text": f"{batch} - íŒë§¤ì…ë ¥_ì´ì¹´ìš´íŠ¸ìë£Œ",
        "blocks": [
            {
                "type": "header",
                "text": f"{batch} - íŒë§¤ì…ë ¥_ì´ì¹´ìš´íŠ¸ìë£Œ",
                "style": "blue"
            },
            {
                "type": "text",
                "text": "íŒŒì¼ ë‹¤ìš´ë¡œë“œ í›„ DBë¡œ í•œë²ˆ ë” ëŒë ¤ì£¼ì„¸ìš”",
                "markdown": True
            },
            {
                "type": "button",
                "text": "íŒë§¤ì…ë ¥ íŒŒì¼ ë‹¤ìš´ë¡œë“œ",
                "style": "default",
                "action_type": "open_system_browser",
                "value": file_url
            }
        ]
    }
    response = requests.post(url, headers=headers, json=data)
    return response.json()

result = send_kakao_work_message(app_key, chatroom_id, shared_link_metadata.url, batch)
print(result)

import time

time.sleep(1)

#íŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£ŒíŒë§¤ì…ë ¥ìë£Œ
import time
time.sleep(1)


print("ì†¡ì¥êµ¬ë¶„ ì— ë”°ë¼ ë©”ì„¸ì§€ ì…ë ¥í•˜ê¸° ì‹œì‘")

import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥êµ¬ë¶„ì´ 'ë¶€ì‚°'ì¸ ê²½ìš° ì—…ë°ì´íŠ¸ ì¿¼ë¦¬
        sql_busan = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ AS s
        LEFT JOIN ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ë¶€ì‚° AS m ON s.ì‡¼í•‘ëª° = m.ì‡¼í•‘ëª°
        SET 
            s.msg1 = IFNULL(m.msg1, (SELECT msg1 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ë¶€ì‚° WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1)),
            s.msg2 = IFNULL(m.msg2, (SELECT msg2 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ë¶€ì‚° WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1)),
            s.msg3 = IFNULL(m.msg3, (SELECT msg3 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ë¶€ì‚° WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1)),
            s.msg4 = IFNULL(m.msg4, (SELECT msg4 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ë¶€ì‚° WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1)),
            s.msg5 = IFNULL(m.msg5, (SELECT msg5 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ë¶€ì‚° WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1)),
            s.msg6 = IFNULL(m.msg6, (SELECT msg6 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ë¶€ì‚° WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1))
        WHERE s.ì†¡ì¥êµ¬ë¶„ = 'ë¶€ì‚°'
        """
        
        # ë¶€ì‚°ì— ëŒ€í•œ ì¿¼ë¦¬ ì‹¤í–‰
        cursor.execute(sql_busan)

        # ì†¡ì¥êµ¬ë¶„ì´ 'ì²­ê³¼'ì¸ ê²½ìš° ì—…ë°ì´íŠ¸ ì¿¼ë¦¬
        sql_chungkwa = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ AS s
        LEFT JOIN ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ì²­ê³¼ AS m ON s.ì‡¼í•‘ëª° = m.ì‡¼í•‘ëª°
        SET 
            s.msg1 = IFNULL(m.msg1, (SELECT msg1 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ì²­ê³¼ WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1)),
            s.msg2 = IFNULL(m.msg2, (SELECT msg2 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ì²­ê³¼ WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1)),
            s.msg3 = IFNULL(m.msg3, (SELECT msg3 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ì²­ê³¼ WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1)),
            s.msg4 = IFNULL(m.msg4, (SELECT msg4 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ì²­ê³¼ WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1)),
            s.msg5 = IFNULL(m.msg5, (SELECT msg5 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ì²­ê³¼ WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1)),
            s.msg6 = IFNULL(m.msg6, (SELECT msg6 FROM ì†¡ì¥ì¶œë ¥_ë©”ì„¸ì§€ì²­ê³¼ WHERE ì‡¼í•‘ëª° = 'ë‚˜ë¨¸ì§€' LIMIT 1))
        WHERE s.ì†¡ì¥êµ¬ë¶„ = 'ì²­ê³¼'
        """
        
        # ì²­ê³¼ì— ëŒ€í•œ ì¿¼ë¦¬ ì‹¤í–‰
        cursor.execute(sql_chungkwa)
        
    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì†¡ì¥ ë©”ì„¸ì§€ ë„£ê¸° ë")


print("ì†¡ì¥êµ¬ë¶„ ì— ë”°ë¼ ë©”ì„¸ì§€ ì…ë ¥í•˜ê¸° ë")

import time

time.sleep(1)

#í†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œ
import pandas as pd
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'  # ë°ì´í„°ë² ì´ìŠ¤ ëª…ì‹œì ìœ¼ë¡œ ì§€ì •

# Excel íŒŒì¼ ê²½ë¡œ
excel_file = '0.ê´€ë¦¬ìíŒŒì¼/í†¡ë”œë¶ˆê°€.xlsx'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,  # ë°ì´í„°ë² ì´ìŠ¤ ì„ íƒ í•„ìˆ˜!
    cursorclass=pymysql.cursors.DictCursor
)

try:
    # Excel íŒŒì¼ ì½ê¸°
    df = pd.read_excel(excel_file, header=0)  # ì²« ë²ˆì§¸ í–‰ì„ ì»¬ëŸ¼ìœ¼ë¡œ ì‚¬ìš©

    # ì»¬ëŸ¼ëª… ì§€ì •
    df.columns = ['ì‡¼í•‘ëª°', 'í’ˆëª©ì½”ë“œ', 'ìƒí’ˆëª…', 'í•„ìˆ˜ì½”ë“œ1', 'í•„ìˆ˜ì½”ë“œ1ìƒí’ˆëª…', 
                  'í•„ìˆ˜ì½”ë“œ2', 'í•„ìˆ˜ì½”ë“œ2ìƒí’ˆëª…', 'í•„ìˆ˜ì½”ë“œ3', 'í•„ìˆ˜ì½”ë“œ3ìƒí’ˆëª…']

    # ë¹ˆ í–‰ ì œê±°
    df = df.dropna(how='all')

    # NaN ê°’ì„ ë¹ˆ ë¬¸ìì—´("")ë¡œ ëŒ€ì²´ (ê²½ê³  í•´ê²°)
    df = df.astype(str).fillna('')

    with connection.cursor() as cursor:
        # ê¸°ì¡´ ë°ì´í„° ì‚­ì œ
        cursor.execute("USE gramwonlogis")  # ğŸ”¹ MySQLì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ì„ íƒ
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_í†¡ë”œë¶ˆê°€")

        # ë°ì´í„° ì‚½ì…
        for index, row in df.iterrows():
            sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_í†¡ë”œë¶ˆê°€ (ì‡¼í•‘ëª°, í’ˆëª©ì½”ë“œ, ìƒí’ˆëª…, í•„ìˆ˜ì½”ë“œ1, í•„ìˆ˜ì½”ë“œ1ìƒí’ˆëª…, 
                                         í•„ìˆ˜ì½”ë“œ2, í•„ìˆ˜ì½”ë“œ2ìƒí’ˆëª…, í•„ìˆ˜ì½”ë“œ3, í•„ìˆ˜ì½”ë“œ3ìƒí’ˆëª…)
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s)
            """
            cursor.execute(sql, (
                row['ì‡¼í•‘ëª°'], row['í’ˆëª©ì½”ë“œ'], row['ìƒí’ˆëª…'], row['í•„ìˆ˜ì½”ë“œ1'], row['í•„ìˆ˜ì½”ë“œ1ìƒí’ˆëª…'], 
                row['í•„ìˆ˜ì½”ë“œ2'], row['í•„ìˆ˜ì½”ë“œ2ìƒí’ˆëª…'], row['í•„ìˆ˜ì½”ë“œ3'], row['í•„ìˆ˜ì½”ë“œ3ìƒí’ˆëª…']
            ))

    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

# ì‹¤í–‰ ì™„ë£Œ ë©”ì‹œì§€ ì¶œë ¥
print("ğŸ“¢ í†¡ë”œë¶ˆê°€ ë°ì´í„° ì €ì¥ ì™„ë£Œ âœ…")

import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'  # ë°ì´í„°ë² ì´ìŠ¤ ëª…ì‹œ

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,  # ë°ì´í„°ë² ì´ìŠ¤ ì„ íƒ
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # 1ï¸âƒ£ ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜.í’ˆëª©ì½”ë“œ ì™€ ì†¡ì¥ì¶œë ¥_í†¡ë”œë¶ˆê°€.í’ˆëª©ì½”ë“œ ê°€ ê°™ì€ í–‰ ì°¾ê¸°
        sql = """
        SELECT 
            A.í’ˆëª©ì½”ë“œ AS ì‚¬ë°©ë„·_í’ˆëª©ì½”ë“œ, A.ì‡¼í•‘ëª° AS ì‚¬ë°©ë„·_ì‡¼í•‘ëª°, A.ì£¼ì†Œ AS ì‚¬ë°©ë„·_ì£¼ì†Œ,
            B.í’ˆëª©ì½”ë“œ AS í†¡ë”œ_í’ˆëª©ì½”ë“œ, B.ì‡¼í•‘ëª° AS í†¡ë”œ_ì‡¼í•‘ëª°, 
            B.í•„ìˆ˜ì½”ë“œ1, B.í•„ìˆ˜ì½”ë“œ2, B.í•„ìˆ˜ì½”ë“œ3
        FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ AS A
        JOIN ì†¡ì¥ì¶œë ¥_í†¡ë”œë¶ˆê°€ AS B
        ON A.í’ˆëª©ì½”ë“œ = B.í’ˆëª©ì½”ë“œ
        """
        cursor.execute(sql)
        matching_rows = cursor.fetchall()

        for row in matching_rows:
            # 2ï¸âƒ£ ì‡¼í•‘ëª°ì´ ê°™ì€ì§€ í™•ì¸
            if row['ì‚¬ë°©ë„·_ì‡¼í•‘ëª°'] == row['í†¡ë”œ_ì‡¼í•‘ëª°']:  
                # 3ï¸âƒ£ ì£¼ì†Œê°€ ê°™ì€ ë‹¤ë¥¸ í–‰ì´ ìˆëŠ”ì§€ í™•ì¸
                check_address_sql = """
                SELECT í’ˆëª©ì½”ë“œ 
                FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ 
                WHERE ì£¼ì†Œ = %s
                """
                cursor.execute(check_address_sql, (row['ì‚¬ë°©ë„·_ì£¼ì†Œ'],))
                address_rows = cursor.fetchall()

                if not address_rows:  # ê°™ì€ ì£¼ì†Œë¥¼ ê°€ì§„ ë‹¤ë¥¸ í–‰ì´ ì—†ë‹¤ë©´
                    update_sql = """
                    UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ 
                    SET ë³„í‘œ1 = '***'
                    WHERE ì£¼ì†Œ = %s
                    """
                    cursor.execute(update_sql, (row['ì‚¬ë°©ë„·_ì£¼ì†Œ'],))
                else:
                    # 4ï¸âƒ£ í•„ìˆ˜ì½”ë“œ1, í•„ìˆ˜ì½”ë“œ2, í•„ìˆ˜ì½”ë“œ3 ì¤‘ í•˜ë‚˜ì™€ í’ˆëª©ì½”ë“œê°€ ê°™ì€ì§€ í™•ì¸
                    í•„ìˆ˜ì½”ë“œ_ì¼ì¹˜ = any(address_row['í’ˆëª©ì½”ë“œ'] in [row['í•„ìˆ˜ì½”ë“œ1'], row['í•„ìˆ˜ì½”ë“œ2'], row['í•„ìˆ˜ì½”ë“œ3']]
                                    for address_row in address_rows)

                    if not í•„ìˆ˜ì½”ë“œ_ì¼ì¹˜:
                        update_sql = """
                        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ 
                        SET ë³„í‘œ1 = '***'
                        WHERE ì£¼ì†Œ = %s
                        """
                        cursor.execute(update_sql, (row['ì‚¬ë°©ë„·_ì£¼ì†Œ'],))

    # ë³€ê²½ ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

# ì‹¤í–‰ ì™„ë£Œ ë©”ì‹œì§€ ì¶œë ¥
print("âœ… 'ë³„í‘œ1' ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ ì™„ë£Œ!")


#í†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œí†¡ë”œë³„í‘œ
# ---. ë³„í‘œíŒŒì¼ ë°ì´í„° ê²€ìƒ‰
print("ë³„í‘œíŒŒì¼ ë°ì´í„° ê²€ìƒ‰ ì‹œì‘")
# --ì‹œì‘

import pandas as pd
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# Excel íŒŒì¼ ê²½ë¡œ
excel_file = '0.ê´€ë¦¬ìíŒŒì¼/ë³„í‘œì†¡ì¥.xlsx'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    # Excel íŒŒì¼ ì½ê¸°
    df = pd.read_excel(excel_file, header=None)

    # ì²« ë²ˆì§¸ í–‰(í—¤ë”) ì‚­ì œ
    df = df.iloc[1:]

    # ë¹ˆ í–‰ ì œê±°
    df = df.dropna(how='all')

    # ì—´ ì´ë¦„ ì§ì ‘ ì§€ì •
    df.columns = ['í’ˆì ˆì œí’ˆì½”ë“œ', 'ìƒí’ˆëª…', 'ì ìš”', 'ë°°ì†¡ë©”ì„¸ì§€', 'ìˆ˜ì·¨ì¸ëª…', 'ë‚´ìš©']

    # ì¸ë±ìŠ¤ ì¬ì„¤ì •
    df = df.reset_index(drop=True)

    # NaN ê°’ì„ ë¹ˆ ë¬¸ìì—´("")ë¡œ ëŒ€ì²´
    df.fillna('', inplace=True)

    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê´€ë¦¬ì í…Œì´ë¸” ë¹„ìš°ê¸° ë° ë°ì´í„° ì‚½ì…
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê´€ë¦¬ì")
        for index, row in df.iterrows():
            if row['í’ˆì ˆì œí’ˆì½”ë“œ'] != '' or row['ìƒí’ˆëª…'] != '':
                sql = """
                INSERT INTO ì†¡ì¥ì¶œë ¥_ê´€ë¦¬ì (í’ˆì ˆì œí’ˆì½”ë“œ, ìƒí’ˆëª…)
                VALUES (%s, %s)
                """
                cursor.execute(sql, (row['í’ˆì ˆì œí’ˆì½”ë“œ'], row['ìƒí’ˆëª…']))

        # ì†¡ì¥ì¶œë ¥_ê´€ë¦¬ì_ë°°ì†¡ë©”ì„¸ì§€ í…Œì´ë¸” ë¹„ìš°ê¸° ë° ë°ì´í„° ì‚½ì…
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê´€ë¦¬ì_ë°°ì†¡ë©”ì„¸ì§€")
        for index, row in df.iterrows():
            if row['ë°°ì†¡ë©”ì„¸ì§€'] != '':
                sql = """
                INSERT INTO ì†¡ì¥ì¶œë ¥_ê´€ë¦¬ì_ë°°ì†¡ë©”ì„¸ì§€ (ë°°ì†¡ë©”ì„¸ì§€)
                VALUES (%s)
                """
                cursor.execute(sql, (row['ë°°ì†¡ë©”ì„¸ì§€'],))

        # ì†¡ì¥ì¶œë ¥_ê´€ë¦¬ì_ì´ë¦„ í…Œì´ë¸” ë¹„ìš°ê¸° ë° ë°ì´í„° ì‚½ì…
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê´€ë¦¬ì_ì´ë¦„")
        for index, row in df.iterrows():
            if row['ìˆ˜ì·¨ì¸ëª…'] != '':
                sql = """
                INSERT INTO ì†¡ì¥ì¶œë ¥_ê´€ë¦¬ì_ì´ë¦„ (ìˆ˜ì·¨ì¸ëª…)
                VALUES (%s)
                """
                cursor.execute(sql, (row['ìˆ˜ì·¨ì¸ëª…'],))

    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

# ---. ë³„í‘œíŒŒì¼ ë°ì´í„° ê²€ìƒ‰
print("ë³„í‘œíŒŒì¼ ë°ì´í„° ê²€ìƒ‰ ë")
# --ë

import time

time.sleep(1)


# ---. ë°°ì†¡ë©”ì„¸ì§€ì—ì„œ ë³„í‘œì§€ìš°ê¸°
print("ë°°ì†¡ë©”ì„¸ì§€ì—ì„œ ë³„í‘œì§€ìš°ê¸° ì‹œì‘")
# --ì‹œì‘

import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ í…Œì´ë¸”ì˜ ë°°ì†¡ë©”ì„¸ì§€ì—ì„œ â˜… ê¸°í˜¸ë¥¼ ì œê±°í•©ë‹ˆë‹¤.
        sql = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ë°°ì†¡ë©”ì„¸ì§€ = REPLACE(ë°°ì†¡ë©”ì„¸ì§€, 'â˜…', '')
        WHERE ë°°ì†¡ë©”ì„¸ì§€ LIKE '%â˜…%'
        """
        
        # ì¿¼ë¦¬ ì‹¤í–‰
        cursor.execute(sql)
        
    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

# ---. ë°°ì†¡ë©”ì„¸ì§€ì—ì„œ ë³„í‘œì§€ìš°ê¸°
print("ë°°ì†¡ë©”ì„¸ì§€ì—ì„œ ë³„í‘œì§€ìš°ê¸° ë")
# --ë


import time

time.sleep(1)





# ---. ë³„í‘œ í’ˆëª©ì½”ë“œ ë°ì´í„°ì…ë ¥
print("ë³„í‘œ í’ˆëª©ì½”ë“œ ë°ì´í„°ì…ë ¥ ì‹œì‘")
# --ì‹œì‘

import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ í…Œì´ë¸”ì˜ í’ˆëª©ì½”ë“œì™€ ì†¡ì¥ì¶œë ¥_ê´€ë¦¬ì í…Œì´ë¸”ì˜ í’ˆì ˆì œí’ˆì½”ë“œê°€ ì¼ì¹˜í•˜ëŠ” í–‰ì„ ì°¾ê³ ,
        # ê·¸ì— í•´ë‹¹í•˜ëŠ” ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ í…Œì´ë¸”ì˜ ë³„í‘œ1 ì»¬ëŸ¼ì— ë³„í‘œ ì„¸ ê°œë¥¼ ë„£ì–´ì¤ë‹ˆë‹¤.
        sql = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ AS s
        JOIN ì†¡ì¥ì¶œë ¥_ê´€ë¦¬ì AS a ON s.í’ˆëª©ì½”ë“œ = a.í’ˆì ˆì œí’ˆì½”ë“œ
        SET s.ë³„í‘œ1 = 'â˜…â˜…â˜…'
        """
        
        # ì¿¼ë¦¬ í–‰
        cursor.execute(sql)
        
    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()


# ---. ë³„í‘œ í’ˆëª©ì½”ë“œ ë°ì´í„°ì…ë ¥
print("ë³„í‘œ í’ˆëª©ì½”ë“œ ë°ì´í„°ì…ë ¥ ë")
# --ë

# ---. ë³„í‘œ ë°°ì†¡ë©”ì„¸ì§€ ë°ì´í„°ì…ë ¥
print("ë³„í‘œ ë°°ì†¡ë©”ì„¸ì§€ ë°ì´í„°ì…ë ¥ ì‹œì‘")
# --ì‹œì‘


import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ í…Œì´ë¸”ì˜ ë°°ì†¡ë©”ì„¸ì§€ì— ì†¡ì¥ì¶œë ¥_ê´€ë¦¬ì_ë°°ì†¡ë©”ì„¸ì§€ í…Œì´ë¸”ì˜ ë°°ì†¡ë©”ì„¸ì§€ê°€ TRIM í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ë¹ˆì¹¸ì„ ì œê±°í•œ í›„ í¬í•¨ë˜ëŠ” ê²½ìš°ì—
        # í•´ë‹¹í•˜ëŠ” í–‰ì„ ì°¾ê³ , ê·¸ì— í•´ë‹¹í•˜ëŠ” ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ í…Œì´ë¸”ì˜ ë³„í‘œ1 ì»¬ëŸ¼ì— ë³„í‘œ ì„¸ ê°œë¥¼ ë„£ì–´ì¤ë‹ˆë‹¤.
        sql = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ AS s
        JOIN ì†¡ì¥ì¶œë ¥_ê´€ë¦¬ì_ë°°ì†¡ë©”ì„¸ì§€ AS a ON TRIM(s.ë°°ì†¡ë©”ì„¸ì§€) LIKE CONCAT('%', TRIM(a.ë°°ì†¡ë©”ì„¸ì§€), '%')
        SET s.ë³„í‘œ1 = 'â˜…â˜…â˜…'
        """
        
        # ì¿¼ë¦¬ ì‹¤í–‰
        cursor.execute(sql)
        
    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()


# ---. ë³„í‘œ ë°°ì†¡ë©”ì„¸ì§€ ë°ì´í„°ì…ë ¥
print("ë³„í‘œ ë°°ì†¡ë©”ì„¸ì§€ ë°ì´í„°ì…ë ¥ ë")
# --ë


import time

time.sleep(1)






# ---. ë³„í‘œ ìˆ˜ì·¨ì¸ ë°ì´í„°ì…ë ¥
print("ë³„í‘œ ìˆ˜ì·¨ì¸ ë°ì´í„°ì…ë ¥ ì‹œì‘")
# --ì‹œì‘


import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ í…Œì´ë¸”ì˜ ìˆ˜ì·¨ì¸ëª…ê³¼ ì†¡ì¥ì¶œë ¥_ê´€ë¦¬ì_ì´ë¦„ í…Œì´ë¸”ì˜ ìˆ˜ì·¨ì¸ëª…ì´ ì¼ì¹˜í•˜ëŠ” í–‰ì„ ì°¾ê³ ,
        # ê·¸ì— í•´ë‹¹í•˜ëŠ” ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ í…Œì´ë¸”ì˜ ë³„í‘œ1 ì»¬ëŸ¼ì— ë³„í‘œ ì„¸ ê°œë¥¼ ë„£ì–´ì¤ë‹ˆë‹¤.
        sql = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ AS s
        JOIN ì†¡ì¥ì¶œë ¥_ê´€ë¦¬ì_ì´ë¦„ AS a ON s.ìˆ˜ì·¨ì¸ëª… = a.ìˆ˜ì·¨ì¸ëª…
        SET s.ë³„í‘œ1 = 'â˜…â˜…â˜…'
        """
        
        # ì¿¼ë¦¬ ì‹¤í–‰
        cursor.execute(sql)
        
    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()


# ---. ë³„í‘œ ìˆ˜ì·¨ì¸ ë°ì´í„°ì…ë ¥
print("ë³„í‘œ ìˆ˜ì·¨ì¸ ë°ì´í„°ì…ë ¥ ë")
# --ë

import time

time.sleep(1)





# ---. ë³„í‘œ ì œì£¼ë„ ì°¾ê¸°
print("ë³„í‘œ ì œì£¼ë„ ì°¾ê¸° ì‹œì‘")
# --ì‹œì‘

import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì£¼ì†Œì— 'ì œì£¼íŠ¹ë³„' ë˜ëŠ” 'ì œì£¼ ì œì£¼' í¬í•¨ ì‹œ ë³„í‘œ2ì— 'ì œì£¼' ì‚½ì…
        sql = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ë³„í‘œ2 = 'ì œì£¼'
        WHERE ì£¼ì†Œ LIKE '%ì œì£¼íŠ¹ë³„%' OR ì£¼ì†Œ LIKE '%ì œì£¼ ì œì£¼%'
        """
        
        # ì¿¼ë¦¬ ì‹¤í–‰
        cursor.execute(sql)
        
    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()




# ---. ë³„í‘œ ì œì£¼ë„ ì°¾ê¸°
print("ë³„í‘œ ì œì£¼ë„ ì°¾ê¸° ë")
# --ë


import time

time.sleep(1)

# ---. ë³„í‘œ ê³ ê° ê³µí†µ ë§ˆí‚¹
print("ë³„í‘œ ê³ ê° ê³µí†µ ë§ˆí‚¹ ì‹œì‘")

import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì£¼ì†Œì™€ ìˆ˜ì·¨ì¸ëª… ì¡°í•©ì´ 'â˜…â˜…â˜…'ì¸ ê²½ìš° í•´ë‹¹ ì¡°í•©ì˜ ëª¨ë“  í–‰ì˜ ë³„í‘œ1ì„ 'â˜…â˜…â˜…'ë¡œ ì—…ë°ì´íŠ¸
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ AS t1
        JOIN (
            SELECT ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
            FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            WHERE ë³„í‘œ1 = 'â˜…â˜…â˜…'
        ) AS t2 ON t1.ì£¼ì†Œ = t2.ì£¼ì†Œ AND t1.ìˆ˜ì·¨ì¸ëª… = t2.ìˆ˜ì·¨ì¸ëª…
        SET t1.ë³„í‘œ1 = 'â˜…â˜…â˜…'
        """
        cursor.execute(sql_update)
        connection.commit()
        print(f"ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜: {cursor.rowcount}")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

# ---. ë³„í‘œ ê³ ê° ê³µí†µ ë§ˆí‚¹
print("ë³„í‘œ ê³ ê° ê³µí†µ ë§ˆí‚¹ ë")



import time

time.sleep(1)


# ---. ë°•ìŠ¤ìƒí’ˆ ëª…ì¹­ë³€ê²½
print("ë°•ìŠ¤ìƒí’ˆ ëª…ì¹­ë³€ê²½ ì‹œì‘")

import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„¤ì •
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci'
)

try:
    with conn.cursor() as cursor:
        # 'ë°•ìŠ¤'ë¥¼ í¬í•¨í•˜ëŠ” ì†¡ì¥ëª…ì„ ê°€ì§„ í–‰ì„ ì°¾ê¸°
        select_sql = """
        SELECT id, ì†¡ì¥ëª…
        FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        WHERE ì†¡ì¥ëª… LIKE '%ë°•ìŠ¤%'
        """
        cursor.execute(select_sql)
        results = cursor.fetchall()

        # ì†¡ì¥ëª… ì•ì— ê¸°í˜¸ ì¶”ê°€í•˜ì—¬ ì—…ë°ì´íŠ¸
        update_sql = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ì†¡ì¥ëª… = CONCAT('â–¨â–§â–¦ ', ì†¡ì¥ëª…)
        WHERE id = %s
        """
        for row in results:
            cursor.execute(update_sql, (row[0],))

        conn.commit()

finally:
    conn.close()


# ---. ë°•ìŠ¤ìƒí’ˆ ëª…ì¹­ë³€ê²½
print("ë°•ìŠ¤ìƒí’ˆ ëª…ì¹­ë³€ê²½ ë")

import time

time.sleep(1)


# ---. íƒë°° ë°•ìŠ¤ ë‚±ê°œ ë‚˜ëˆ„ê¸°
print("íƒë°° ë°•ìŠ¤ ë‚±ê°œ ë‚˜ëˆ„ê¸° ì‹œì‘")
# --ì‹œì‘

import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰ ì»¬ëŸ¼ì˜ ê°’ì´ 1ì¸ ê²½ìš°ì—ëŠ” 'ë°•ìŠ¤', ê·¸ ì™¸ì˜ ê²½ìš°ì—ëŠ” 'ë‚±ê°œ'ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.
        sql = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            SET íƒë°°ìˆ˜ëŸ‰1 = CASE WHEN CAST(íƒë°°ìˆ˜ëŸ‰ AS UNSIGNED) = 1 THEN 'ë°•ìŠ¤' ELSE 'ë‚±ê°œ' END
            WHERE íƒë°°ìˆ˜ëŸ‰ REGEXP '^[0-9]+$';
        """
        
        # ì¿¼ë¦¬ ì‹¤í–‰
        cursor.execute(sql)
        
    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()


# ---. íƒë°° ë°•ìŠ¤ ë‚±ê°œ ë‚˜ëˆ„ê¸°
print("íƒë°° ë°•ìŠ¤ ë‚±ê°œ ë‚˜ëˆ„ê¸° ë")
# --ë

import time

time.sleep(1)




# ---. ì¹´ì¹´ì˜¤ í–‰ì‚¬ ì†¡ì¥ ì½”ë“œ ê²€ìƒ‰
print("ì¹´ì¹´ì˜¤ í–‰ì‚¬ ì†¡ì¥ ì½”ë“œ ì‹œì‘")
# --ì‹œì‘

import pandas as pd
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# Excel íŒŒì¼ ê²½ë¡œ
excel_file = '0.ê´€ë¦¬ìíŒŒì¼/ë¶„ë¦¬ì†¡ì¥.xlsx'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    # Excel íŒŒì¼ ì½ê¸°
    df = pd.read_excel(excel_file)

    # NaN ê°’ì„ ë¹ˆ ë¬¸ìì—´("")ë¡œ ëŒ€ì²´
    df.fillna('', inplace=True)

    # MySQL í…Œì´ë¸”ì— ë°ì´í„° ì‚½ì… ì „ì— í…Œì´ë¸” ë¹„ìš°ê¸°
    with connection.cursor() as cursor:
        # í…Œì´ë¸” ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ë¶„ë¦¬ì¶œë ¥")

    # MySQL í…Œì´ë¸”ì— ë°ì´í„° ì‚½ì…
    with connection.cursor() as cursor:
        for index, row in df.iterrows():
            sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶„ë¦¬ì¶œë ¥ (ë¶„ë¦¬ì œí’ˆì½”ë“œ, ìƒí’ˆëª…, ì ìš”)
            VALUES (%s, %s, %s)
            """
            cursor.execute(sql, (row['ë¶„ë¦¬ì œí’ˆì½”ë“œ'], row['ìƒí’ˆëª…'], row['ì ìš”']))

    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

# ---. ì¹´ì¹´ì˜¤ í–‰ì‚¬ ì†¡ì¥ ì½”ë“œ
print("ì¹´ì¹´ì˜¤ í–‰ì‚¬ ì†¡ì¥ ì½”ë“œ ë")
# --ë

import time

time.sleep(1)






# ---. ì†¡ì¥ ì¶œê³ ì§€ë³„ë¡œ êµ¬ë¶„í•˜ê¸°
print("ì†¡ì¥ ì¶œê³ ì§€ë³„ë¡œ êµ¬ë¶„í•˜ê¸° ì‹œì‘")
# --ì‹œì‘

import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # 'ì†¡ì¥êµ¬ë¶„ìµœì¢…' ì»¬ëŸ¼ ì—…ë°ì´íŠ¸
        sql = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET `ì†¡ì¥êµ¬ë¶„ìµœì¢…` = CONCAT(`ì†¡ì¥êµ¬ë¶„`, IFNULL(`íƒë°°ìˆ˜ëŸ‰1`, ''))
        """
        cursor.execute(sql)
        
    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()



# ---. ì†¡ì¥ ì¶œê³ ì§€ë³„ë¡œ êµ¬ë¶„í•˜ê¸°
print("ì†¡ì¥ ì¶œê³ ì§€ë³„ë¡œ êµ¬ë¶„í•˜ê¸° ë")
# --ë


import time

time.sleep(1)




# ---. ëƒ‰ë™ ë ‰ ìœ„ì¹˜ ì…ë ¥
print("ëƒ‰ë™ ë ‰ ìœ„ì¹˜ ì…ë ¥ ì‹œì‘")
# --ì‹œì‘

import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # í’ˆëª©ë“±ë¡ í…Œì´ë¸”ê³¼ ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ í’ˆëª©ì½”ë“œê°€ ê°™ì€ í–‰ ì°¾ê¸°
        sql_select = """
        SELECT p.í’ˆëª©ê·¸ë£¹2ì½”ë“œ, s.í’ˆëª©ì½”ë“œ
        FROM í’ˆëª©ë“±ë¡ AS p
        JOIN ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ AS s ON p.í’ˆëª©ì½”ë“œ = s.í’ˆëª©ì½”ë“œ
        """
        cursor.execute(sql_select)
        results = cursor.fetchall()

        # ê²°ê³¼ë¥¼ ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ í…Œì´ë¸”ì— ì—…ë°ì´íŠ¸
        for result in results:
            sql_update = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
            SET ìœ„ì¹˜ = %s
            WHERE í’ˆëª©ì½”ë“œ = %s
            """
            cursor.execute(sql_update, (result['í’ˆëª©ê·¸ë£¹2ì½”ë“œ'], result['í’ˆëª©ì½”ë“œ']))

    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()



# ---. ëƒ‰ë™ ë ‰ ìœ„ì¹˜ ì…ë ¥
print("ëƒ‰ë™ ë ‰ ìœ„ì¹˜ ì…ë ¥ ë")
# --ë

import time

time.sleep(1)






# ---. ëƒ‰ë™ ê³µì‚° ì œí’ˆ ì¤‘ ì‘ì€ í’ˆëª© í•©í¬ì¥ì²˜ë¦¬
print("ëƒ‰ë™ ê³µì‚° ì œí’ˆ ì¤‘ ì‘ì€ í’ˆëª© í•©í¬ì¥ì²˜ë¦¬ ì‹œì‘")
# --ì‹œì‘

import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ìœ„ì¹˜ê°€ 'ê³µ2' ì´ë©´ì„œ íƒë°°ìˆ˜ëŸ‰ì´ 20 ì´í•˜ì¸ í–‰ì˜ ìœ„ì¹˜ ê°’ì„ 'ê³µ3'ìœ¼ë¡œ ë³€ê²½
        sql_update_location_and_quantity = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ìœ„ì¹˜ = 'ê³µ3'
        WHERE ìœ„ì¹˜ = 'ê³µ2' AND íƒë°°ìˆ˜ëŸ‰ BETWEEN 20 AND 1000000
        """
        cursor.execute(sql_update_location_and_quantity)

    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

# ---. ëƒ‰ë™ ê³µì‚° ì œí’ˆ ì¤‘ ì‘ì€ í’ˆëª© í•©í¬ì¥ì²˜ë¦¬
print("ëƒ‰ë™ ê³µì‚° ì œí’ˆ ì¤‘ ì‘ì€ í’ˆëª© í•©í¬ì¥ì²˜ë¦¬ ë")
# --ë

import time

time.sleep(1)




# ---. ìœ„ì¹˜ ì—…ë°ì´íŠ¸ ìŠ¤í¬ë¦½íŠ¸
print("ë¹ˆ ìœ„ì¹˜ ì—…ë°ì´íŠ¸ ì‘ì—… ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ë¹ˆ ìœ„ì¹˜ë¥¼ '99-1'ë¡œ ì—…ë°ì´íŠ¸
        update_query = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ìœ„ì¹˜ = '99-1'
        WHERE ìœ„ì¹˜ IS NULL OR ìœ„ì¹˜ = ''
        """
        cursor.execute(update_query)
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ë¹ˆ ìœ„ì¹˜ ì—…ë°ì´íŠ¸ ì‘ì—… ë")
# ---ë

import time

time.sleep(1)





# ---. ì´ë¦„ ì£¼ì†Œ ì „í™”ë²ˆí˜¸ í•©ì¹˜ê¸°
print("ì´ë¦„ ì£¼ì†Œ ì „í™”ë²ˆí˜¸ í•©ì¹˜ê¸° ì‹œì‘")
# --ì‹œì‘

import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ìœ„ì¹˜ ì»¬ëŸ¼ì˜ ê°’ì´ 'ê³µ2'ì¸ í–‰ì„ ì°¾ì•„ì„œ í•´ë‹¹ ì»¬ëŸ¼ë“¤ì„ ì—…ë°ì´íŠ¸
        sql_update_with_location = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ìœ„ì¹˜ë³€í™˜ = CONCAT(ìœ„ì¹˜, í’ˆëª©ì½”ë“œ, LPAD(ìˆ˜ëŸ‰, 2, '0'), ìˆ˜ì·¨ì¸ëª…, ì£¼ì†Œ, ì „í™”ë²ˆí˜¸1)
        WHERE ìœ„ì¹˜ = 'ê³µ2'
        """
        cursor.execute(sql_update_with_location)

        # ìœ„ì¹˜ ì»¬ëŸ¼ì˜ ê°’ì´ 'ê³µ2'ê°€ ì•„ë‹Œ í–‰ì„ ì°¾ì•„ì„œ í•´ë‹¹ ì»¬ëŸ¼ë“¤ì„ ì—…ë°ì´íŠ¸
        sql_update_without_location = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ìœ„ì¹˜ë³€í™˜ = CONCAT(ìœ„ì¹˜,'0',í’ˆëª©ì½”ë“œ, LPAD(ìˆ˜ëŸ‰, 2, '0'), ìˆ˜ì·¨ì¸ëª…, ì£¼ì†Œ, ì „í™”ë²ˆí˜¸1)
        WHERE ìœ„ì¹˜ != 'ê³µ2'
        """
        cursor.execute(sql_update_without_location)

    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()



# ---. ì´ë¦„ ì£¼ì†Œ ì „í™”ë²ˆí˜¸ í•©ì¹˜ê¸°
print("ì´ë¦„ ì£¼ì†Œ ì „í™”ë²ˆí˜¸ í•©ì¹˜ê¸° ë")
# --ë

import time

time.sleep(1)




# ---. ëƒ‰ë™ì°½ê³  ê³µì‚°í’ˆ ì†¡ì¥ë¶„ë¦¬ì…ë ¥
print("ëƒ‰ë™ì°½ê³  ê³µì‚°í’ˆ ì†¡ì¥ë¶„ë¦¬ì…ë ¥ ì‹œì‘")
# --ì‹œì‘

import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ìœ„ì¹˜ ì»¬ëŸ¼ì˜ ê°’ì´ 'ê³µ2'ì¸ í–‰ì„ ì°¾ì•„ì„œ ì£¼ì†Œ ì»¬ëŸ¼ì˜ ë§ˆì§€ë§‰ì— 'â˜†' ì¶”ê°€
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ì£¼ì†Œ = CONCAT(ì£¼ì†Œ, 'â˜†')
        WHERE ìœ„ì¹˜ = 'ê³µ2'
        """
        cursor.execute(sql_update)

    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()


# ---. ëƒ‰ë™ì°½ê³  ê³µì‚°í’ˆ ì†¡ì¥ë¶„ë¦¬ì…ë ¥
print("ëƒ‰ë™ì°½ê³  ê³µì‚°í’ˆ ì†¡ì¥ë¶„ë¦¬ì…ë ¥ ë")
# --ë


import time

time.sleep(1)




# ---. ê³µí†µë°•ìŠ¤ ë¶„ë¥˜ì‘ì—…
print("ê³µí†µë°•ìŠ¤ ë¶„ë¥˜ì‘ì—… ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
try:
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤ í…Œì´ë¸”ì˜ ë‚´ìš©ì„ truncate (ì´ˆê¸°í™”)
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤"
        cursor.execute(sql_truncate)
        connection.commit()  # ì¤‘ìš”í•œ ë³€ê²½ ì‚¬í•­ ë°”ë¡œ ì»¤ë°‹

        # ìˆ˜ëŸ‰ì´ 2 ì´ìƒì¸ í–‰ë§Œì„ ë³µì‚¬í•˜ì—¬ ì¶”ê°€
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        WHERE íƒë°°ìˆ˜ëŸ‰1 = 'ë°•ìŠ¤'
        ORDER BY  í’ˆëª©ì½”ë“œ ASC, ìˆ˜ì·¨ì¸ëª… ASC, ìœ„ì¹˜ ASC
        """
        cursor.execute(sql_copy_rows)
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥

except pymysql.MySQLError as e:
    print("MySQL Error:", e)
finally:
    if connection:
        connection.close()  # ì—°ê²° ì¢…ë£Œ

print("ê³µí†µë°•ìŠ¤ ë¶„ë¥˜ì‘ì—… ë")
# --ë

import time

time.sleep(1)


# ---. ë°•ìŠ¤ ê³µí†µëŠ˜ë¦¬ê¸° 
print("ë°•ìŠ¤ ê³µí†µëŠ˜ë¦¬ê¸° ì‹œì‘")
# --ì‹œì‘

import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ë¨¼ì € ëª¨ë“  í–‰ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        sql_select = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤"
        cursor.execute(sql_select)
        rows = cursor.fetchall()

        # ê° í–‰ì„ 'ìˆ˜ëŸ‰-1' ë§Œí¼ ë³µì‚¬í•˜ì—¬ ì‚½ì…í•©ë‹ˆë‹¤.
        for row in rows:
            count = row['ìˆ˜ëŸ‰'] - 1  # ì¶”ê°€í•  í–‰ì˜ ìˆ˜
            if count > 0:  # ìˆ˜ëŸ‰ì´ 1ë³´ë‹¤ í° ê²½ìš°ì—ë§Œ ì²˜ë¦¬
                sql_insert = """
                INSERT INTO ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤
                (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
                VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
                """
                for _ in range(count):
                    cursor.execute(sql_insert, (row['msg1'], row['msg2'], row['msg3'], row['msg4'], row['msg5'], row['msg6'], row['ìˆ˜ì·¨ì¸ëª…'], row['ì „í™”ë²ˆí˜¸1'], row['ì „í™”ë²ˆí˜¸2'], row['ìš°í¸ë²ˆí˜¸'], row['ì£¼ì†Œ'], row['ì˜µì…˜ëª…'], row['ìˆ˜ëŸ‰'], row['ë°°ì†¡ë©”ì„¸ì§€'], row['ì£¼ë¬¸ë²ˆí˜¸'], row['ì‡¼í•‘ëª°'], row['ìˆ˜ì§‘ì‹œê°„'], row['ì†¡ì¥ëª…'], row['í’ˆëª©ì½”ë“œ'], row['íƒë°°ë¹„ìš©'], row['ë°•ìŠ¤í¬ê¸°'], row['ì¶œë ¥ê°œìˆ˜'], row['ì†¡ì¥ìˆ˜ëŸ‰'], row['ë³„í‘œ1'], row['ë³„í‘œ2'], row['í’ˆëª©ê°œìˆ˜'], row['íƒë°°ìˆ˜ëŸ‰'], row['íƒë°°ìˆ˜ëŸ‰1'], row['íƒë°°ìˆ˜ëŸ‰í•©ì‚°'], row['ì†¡ì¥êµ¬ë¶„ì'], row['ì†¡ì¥êµ¬ë¶„'], row['ì†¡ì¥êµ¬ë¶„ìµœì¢…'], row['ìœ„ì¹˜'], row['ìœ„ì¹˜ë³€í™˜']))

    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()


# ---. ë°•ìŠ¤ ê³µí†µëŠ˜ë¦¬ê¸° 
print("ë°•ìŠ¤ ê³µí†µëŠ˜ë¦¬ê¸° ë")
# --ë

import time

time.sleep(5)



# ---. ë°•ìŠ¤ì£¼ë¬¸ ìˆœë²ˆ ë§¤ê¸°ê¸°
print("ë°•ìŠ¤ì£¼ë¬¸ ìˆœë²ˆ ë§¤ê¸°ê¸° ì‹œì‘")
# --ì‹œì‘

import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor  # ê²°ê³¼ë¥¼ ë”•ì…”ë„ˆë¦¬ í˜•íƒœë¡œ ë°›ê¸° ìœ„í•¨
)

try:
    with conn.cursor() as cursor:
        # ìœ„ì¹˜ë³€í™˜ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ëª¨ë“  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´
        sql = "SELECT id, ìœ„ì¹˜ë³€í™˜ FROM ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤ ORDER BY ìœ„ì¹˜ë³€í™˜, id"
        cursor.execute(sql)
        results = cursor.fetchall()

        # í˜„ì¬ ìœ„ì¹˜ë³€í™˜ ê°’
        current_location = None
        counter = 1

        # ê²°ê³¼ë¥¼ ìˆœíšŒí•˜ë©´ì„œ ìˆœë²ˆì„ ë§¤ê¹€
        for row in results:
            if current_location != row['ìœ„ì¹˜ë³€í™˜']:
                current_location = row['ìœ„ì¹˜ë³€í™˜']
                counter = 1  # ìœ„ì¹˜ë³€í™˜ ê°’ì´ ë°”ë€Œë©´ ìˆœë²ˆì„ ë¦¬ì…‹
            
            # ì†¡ì¥êµ¬ë¶„ì ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ (ì¤‘ê´„í˜¸ í˜•ì‹ìœ¼ë¡œ)
            formatted_number = f"({counter})"  # ìˆ«ì ì•ë’¤ë¡œ ì†Œê´„í˜¸ ì¶”ê°€
            update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤ SET ì†¡ì¥êµ¬ë¶„ì=%s WHERE id=%s"
            cursor.execute(update_sql, (formatted_number, row['id']))
            counter += 1

        conn.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

finally:
    conn.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

# ---. ë°•ìŠ¤ì£¼ë¬¸ ìˆœë²ˆ ë§¤ê¸°ê¸°
print("ë°•ìŠ¤ì£¼ë¬¸ ìˆœë²ˆ ë§¤ê¸°ê¸° ë")
# --ë

import time

time.sleep(1)



# ---. ë°•ìŠ¤ì£¼ë¬¸ ì£¼ì†Œì—…ë°ì´íŠ¸
print("ë°•ìŠ¤ì£¼ë¬¸ ì£¼ì†Œì—…ë°ì´íŠ¸ ì‹œì‘")
# --ì‹œì‘


import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with conn.cursor() as cursor:
        # 'ì£¼ì†Œ' ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ ì¿¼ë¦¬ ì‹¤í–‰
        update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤ SET ì£¼ì†Œ = CONCAT(ì£¼ì†Œ, ì†¡ì¥êµ¬ë¶„ì)"
        cursor.execute(update_sql)
        conn.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    conn.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ


# ---. ë°•ìŠ¤ì£¼ë¬¸ ì£¼ì†Œì—…ë°ì´íŠ¸
print("ë°•ìŠ¤ì£¼ë¬¸ ì£¼ì†Œì—…ë°ì´íŠ¸ ë")
# --ë

import time

time.sleep(1)

# ---. ë°•ìŠ¤ì£¼ì†Œ ìˆœë²ˆ ë§¤ê¸°ê¸°
print("ë°•ìŠ¤ì£¼ì†Œ ìˆœë²ˆ ë§¤ê¸°ê¸° ì‹œì‘")
# --ë

import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„¤ì •
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with conn.cursor() as cursor:
        # ëª¨ë“  ì£¼ì†Œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜´
        sql = "SELECT id, ì£¼ì†Œ FROM ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤ ORDER BY ì£¼ì†Œ, id"
        cursor.execute(sql)
        results = cursor.fetchall()

        # ì£¼ì†Œë³„ ìˆœë²ˆ ë§¤ê¹€ì„ ìœ„í•œ ì‚¬ì „
        address_count = {}
        updates = []

        for row in results:
            address = row['ì£¼ì†Œ']
            if address not in address_count:
                address_count[address] = 1
            else:
                address_count[address] += 1

            # ì£¼ì†Œì— ìˆœë²ˆì„ ì¶”ê°€í•˜ì—¬ ì—…ë°ì´íŠ¸
            new_address = f"{address} ({address_count[address]})" if address_count[address] > 1 else address
            updates.append((new_address, row['id']))

        # ì—…ë°ì´íŠ¸ëœ ì£¼ì†Œë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜
        update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤ SET ì£¼ì†Œ=%s WHERE id=%s"
        cursor.executemany(update_sql, updates)
        conn.commit()

finally:
    conn.close()



# ---. ë°•ìŠ¤ì£¼ì†Œ ìˆœë²ˆ ë§¤ê¸°ê¸°
print("ë°•ìŠ¤ì£¼ì†Œ ìˆœë²ˆ ë§¤ê¸°ê¸° ë")
# --ë

import time

time.sleep(1)


# ---. ë°•ìŠ¤ì£¼ë¬¸ ìˆ˜ëŸ‰1ë¡œë³€ê²½
print("ë°•ìŠ¤ì£¼ë¬¸ ìˆ˜ëŸ‰1ë¡œë³€ê²½ ì‹œì‘")
# --ì‹œì‘


import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with conn.cursor() as cursor:
        # 'ìˆ˜ëŸ‰' ì»¬ëŸ¼ì„ 1ë¡œ ì—…ë°ì´íŠ¸ í•˜ëŠ” ì¿¼ë¦¬ ì‹¤í–‰
        update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤ SET ìˆ˜ëŸ‰ = 1"
        cursor.execute(update_sql)
        conn.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    conn.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

# ---. ë°•ìŠ¤ì£¼ë¬¸ ìˆ˜ëŸ‰1ë¡œë³€ê²½
print("ë°•ìŠ¤ì£¼ë¬¸ ìˆ˜ëŸ‰1ë¡œë³€ê²½ ë")
# --ë

import time

time.sleep(1)



# ---. ë°•ìŠ¤ì£¼ë¬¸ ìœ ì¼ìì„¤ì •
print("ë°•ìŠ¤ì£¼ë¬¸ ìœ ì¼ìì„¤ì • ì‹œì‘")
# --ì‹œì‘


import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with conn.cursor() as cursor:
        # 'ìœ„ì¹˜ë³€í™˜' ì»¬ëŸ¼ì„ ì—…ë°ì´íŠ¸ í•˜ëŠ” ì¿¼ë¦¬ ì‹¤í–‰
        update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤ SET ìœ„ì¹˜ë³€í™˜ = CONCAT('0',ìœ„ì¹˜, í’ˆëª©ì½”ë“œ, LPAD(ìˆ˜ëŸ‰, 2, '0'), ìˆ˜ì·¨ì¸ëª…, ì£¼ì†Œ, ì „í™”ë²ˆí˜¸1)"
        cursor.execute(update_sql)
        conn.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    conn.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ


# ---. ë°•ìŠ¤ì£¼ë¬¸ ìœ ì¼ìì„¤ì •
print("ë°•ìŠ¤ì£¼ë¬¸ ìœ ì¼ìì„¤ì • ë")
# --ë

import time

time.sleep(1)


#ê³µí†µë°•ìŠ¤ ìˆ˜ëŸ‰ ì²˜ë¦¬ --------------------------------------------------------------------ì‹œì‘
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # í’ˆëª©ì½”ë“œë³„ë¡œ ìˆ˜ëŸ‰ì„ í•©ì‚°í•˜ì—¬ ì¶œë ¥ê°œìˆ˜ì— ì—…ë°ì´íŠ¸
        sql_update_output_count = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤ AS t1 
        INNER JOIN (
            SELECT í’ˆëª©ì½”ë“œ, SUM(ìˆ˜ëŸ‰) AS total_quantity
            FROM ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤
            GROUP BY í’ˆëª©ì½”ë“œ
        ) AS t2 ON t1.í’ˆëª©ì½”ë“œ = t2.í’ˆëª©ì½”ë“œ
        SET t1.í’ˆëª©ê°œìˆ˜ = t2.total_quantity
        """
        cursor.execute(sql_update_output_count)

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

#ê³µí†µë°•ìŠ¤ ìˆ˜ëŸ‰ ì²˜ë¦¬ --------------------------------------------------------------------ë





# ---. ê³µí†µì‘ì—… ë -> ê°œë³„ì‘ì—… ì‹œì‘
print("ê³µí†µì‘ì—… ë -> ê°œë³„ì‘ì—… ì‹œì‘")
# --ë

# ë°•ìŠ¤êµ¬ë¶„ì„œìš¸ê³¼ì•„ë‹Œê²ƒ
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# ì—°ê²°
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # 1. ì„œìš¸ë‚±ê°œ ì¤‘ ì„œìš¸ ì£¼ì†Œ + ì‡¼í•‘ëª° ì¡°ê±´
        update_query_1 = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ì„œìš¸ë‚±ê°œ'
        WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ëƒ‰ë™ë‚±ê°œ'
          AND SUBSTRING(
                TRIM(SUBSTRING_INDEX(ì£¼ì†Œ, ']', -1)), 1, 2
              ) = 'ì„œìš¸'
          AND ì‡¼í•‘ëª° IN ('Cafe24(ì‹ )', 'Gfresh')
        """

        # 2. ì„œìš¸ë°•ìŠ¤ ì¤‘ ì„œìš¸ ì£¼ì†Œ + ì‡¼í•‘ëª° ì¡°ê±´
        update_query_2 = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ì„œìš¸ë°•ìŠ¤'
        WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ëƒ‰ë™ë°•ìŠ¤'
          AND SUBSTRING(
                TRIM(SUBSTRING_INDEX(ì£¼ì†Œ, ']', -1)), 1, 2
              ) = 'ì„œìš¸'
          AND ì‡¼í•‘ëª° IN ('Cafe24(ì‹ )', 'Gfresh')
        """

        # ì¿¼ë¦¬ ì‹¤í–‰
        cursor.execute(update_query_1)
        cursor.execute(update_query_2)
        connection.commit()
        print("ì†¡ì¥êµ¬ë¶„ìµœì¢… ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ ì™„ë£Œ âœ…")

finally:
    connection.close()


import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# ì—°ê²°
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì„œìš¸ë°•ìŠ¤ ì¤‘ ì„œìš¸ ì£¼ì†Œ â†’ ì„œìš¸ë°•ìŠ¤
        update_query = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤
        SET ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ì„œìš¸ë°•ìŠ¤'
        WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ëƒ‰ë™ë°•ìŠ¤'
          AND SUBSTRING(
                TRIM(SUBSTRING_INDEX(ì£¼ì†Œ, ']', -1)), 1, 2
              ) = 'ì„œìš¸'
          AND ì‡¼í•‘ëª° IN ('Cafe24(ì‹ )', 'Gfresh')
        """

        cursor.execute(update_query)
        connection.commit()
        print("ì„œìš¸ë°•ìŠ¤ ì—…ë°ì´íŠ¸ ì™„ë£Œ âœ…")

finally:
    connection.close()


# ---. ì„œìš¸ì„œìš¸ë‚±ê°œ ë¶„ë¥˜
print("ì„œìš¸ì„œìš¸ë‚±ê°œ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³€í™˜ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³€í™˜"
        cursor.execute(sql_truncate)

        # ì„œìš¸ëƒ‰ë™ ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³€í™˜ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ì„œìš¸ë‚±ê°œ'
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì„œìš¸ì„œìš¸ë‚±ê°œ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)




# ---. íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸
print("íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰ì„ ì´ìš©í•˜ì—¬ 1ì„ ë‚˜ëˆˆ ê²°ê³¼ë¥¼ ì†Œìˆ˜ì  ì„¸ ìë¦¬ì—ì„œ ë‚´ë¦¼í•˜ì—¬ ì†¡ì¥êµ¬ë¶„ì ì»¬ëŸ¼ì— ì—…ë°ì´íŠ¸
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ì = FLOOR((1 / IFNULL(NULLIF(íƒë°°ìˆ˜ëŸ‰, 0), 10)) * 1000) / 1000
        """
        cursor.execute(sql_update)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ë")
# --ë


import time

time.sleep(1)



# ---. ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸
print("ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ì„ ê³±í•˜ì—¬ ê²°ê³¼ ì—…ë°ì´íŠ¸
        sql_multiply_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ì = ì†¡ì¥êµ¬ë¶„ì * ìˆ˜ëŸ‰
        """
        cursor.execute(sql_multiply_update)
        connection.commit()

        print(f"ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ì™„ë£Œ, {cursor.rowcount} í–‰ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸ ë")
# --ë


import time

time.sleep(1)



# ---. ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ë° íƒë°°ìˆ˜ëŸ‰1 ì—…ë°ì´íŠ¸
print("ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª…ì„ ê¸°ì¤€ìœ¼ë¡œ ì†¡ì¥êµ¬ë¶„ìë¥¼ í•©ì‚°
        sql_group_sum = """
        SELECT ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…, SUM(ì†¡ì¥êµ¬ë¶„ì) AS êµ¬ë¶„ìí•©
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³€í™˜
        GROUP BY ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
        """
        cursor.execute(sql_group_sum)
        results = cursor.fetchall()

        # ê° ê·¸ë£¹ì˜ êµ¬ë¶„ìí•©ì„ íƒë°°ìˆ˜ëŸ‰1ì— ì—…ë°ì´íŠ¸
        for result in results:
            sql_update = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³€í™˜
            SET íƒë°°ìˆ˜ëŸ‰1 = %s
            WHERE ì£¼ì†Œ = %s AND ìˆ˜ì·¨ì¸ëª… = %s
            """
            cursor.execute(sql_update, (result['êµ¬ë¶„ìí•©'], result['ì£¼ì†Œ'], result['ìˆ˜ì·¨ì¸ëª…']))

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"Updated {cursor.rowcount} rows based on address and recipient name.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ë° íƒë°°ìˆ˜ëŸ‰1 ì—…ë°ì´íŠ¸ ë")
# --ë

import time

time.sleep(1)




print("íƒë°°ìˆ˜ëŸ‰1 ì˜¬ë¦¼ ì²˜ë¦¬ ì‹œì‘")
import pymysql
import math

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰1ì˜ í˜„ì¬ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        sql_fetch = "SELECT id, íƒë°°ìˆ˜ëŸ‰1 FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³€í™˜"
        cursor.execute(sql_fetch)
        results = cursor.fetchall()

        updated_rows = 0  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ë¥¼ ì¶”ì 
        # ê° í–‰ì˜ íƒë°°ìˆ˜ëŸ‰1 ê°’ì„ ì˜¬ë¦¼ ì²˜ë¦¬í•˜ê³  ì—…ë°ì´íŠ¸ í•©ë‹ˆë‹¤.
        for result in results:
            current_quantity = result['íƒë°°ìˆ˜ëŸ‰1']
            if current_quantity is None:  # íƒë°°ìˆ˜ëŸ‰1ì´ Noneì¼ ë•Œ ì²˜ë¦¬
                current_quantity = 1  # None ê°’ì„ 30ìœ¼ë¡œ ì„¤ì •
            
            rounded_quantity = math.ceil(float(current_quantity))  # íƒë°°ìˆ˜ëŸ‰1 ê°’ì„ ì˜¬ë¦¼
            sql_update = "UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³€í™˜ SET íƒë°°ìˆ˜ëŸ‰1 = %s WHERE id = %s"
            cursor.execute(sql_update, (rounded_quantity, result['id']))
            updated_rows += cursor.rowcount

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜: {updated_rows}")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("íƒë°°ìˆ˜ëŸ‰1 ì˜¬ë¦¼ ì²˜ë¦¬ ì™„ë£Œ")
# --ë


import time

time.sleep(1)




# ---. íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸
print("íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰1ì´ 1ë³´ë‹¤ í° ê²½ìš° 'ì¶”ê°€'ë¡œ ì—…ë°ì´íŠ¸
        update_more_than_one = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ = 'ì¶”ê°€'
        WHERE íƒë°°ìˆ˜ëŸ‰1 > 1
        """
        cursor.execute(update_more_than_one)
        
        # íƒë°°ìˆ˜ëŸ‰1ì´ 1 ì´í•˜ì¸ ê²½ìš° '1ì¥'ìœ¼ë¡œ ì—…ë°ì´íŠ¸
        update_one_or_less = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        WHERE íƒë°°ìˆ˜ëŸ‰1 <= 1
        """
        cursor.execute(update_one_or_less)
        
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated rows for more than one: {cursor.rowcount}")  # 'ì¶”ê°€'ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥
        print(f"Updated rows for one or less: {cursor.rowcount}")  # '1ì¥'ìœ¼ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‘ì—… ë")
# ---ë

import time

time.sleep(1)



# ---. ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸
print("ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ì¡°í•©ì´ ìœ ì¼í•œ ê²½ìš° 'ë‹¨ì¼'ë¡œ ì—…ë°ì´íŠ¸
        update_unique_address_and_name = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³€í™˜ t1
        JOIN (
            SELECT ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
            FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³€í™˜
            WHERE ì†¡ì¥êµ¬ë¶„ = '1ì¥'
            GROUP BY ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
            HAVING COUNT(*) = 1
        ) AS unique_address ON t1.ì£¼ì†Œ = unique_address.ì£¼ì†Œ AND t1.ìˆ˜ì·¨ì¸ëª… = unique_address.ìˆ˜ì·¨ì¸ëª…
        SET t1.ì†¡ì¥êµ¬ë¶„ = 'ë‹¨ì¼'
        WHERE t1.ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        """
        cursor.execute(update_unique_address_and_name)

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated unique address and name rows to 'ë‹¨ì¼': {cursor.rowcount}")  # 'ë‹¨ì¼'ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‘ì—… ë")
# ---ë



# ---. ì„œìš¸ëƒ‰ë™1ì¥ ë¶„ë¥˜
print("ì„œìš¸ëƒ‰ë™1ì¥ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™1ì¥ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™1ì¥"
        cursor.execute(sql_truncate)

        # ì„œìš¸ëƒ‰ë™ ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™1ì¥ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        ORDER BY ìœ„ì¹˜ë³€í™˜ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì„œìš¸ëƒ‰ë™1ì¥ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)


# ---. ì„œìš¸ëƒ‰ë™ë‹¨ì¼ ë¶„ë¥˜
print("ì„œìš¸ëƒ‰ë™ë‹¨ì¼ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë‹¨ì¼ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë‹¨ì¼"
        cursor.execute(sql_truncate)

        # ì„œìš¸ëƒ‰ë™ ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë‹¨ì¼ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = 'ë‹¨ì¼'
        ORDER BY ìœ„ì¹˜ë³€í™˜ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì„œìš¸ëƒ‰ë™ë‹¨ì¼ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)

# ---. í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜
print("í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # í’ˆëª©ì½”ë“œë³„ë¡œ ìˆ˜ëŸ‰ì„ í•©ì‚°í•˜ì—¬ ì¶œë ¥ê°œìˆ˜ì— ì—…ë°ì´íŠ¸
        sql_update_output_count = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë‹¨ì¼ AS t1 
        INNER JOIN (
            SELECT í’ˆëª©ì½”ë“œ, SUM(ìˆ˜ëŸ‰) AS total_quantity
            FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë‹¨ì¼
            GROUP BY í’ˆëª©ì½”ë“œ
        ) AS t2 ON t1.í’ˆëª©ì½”ë“œ = t2.í’ˆëª©ì½”ë“œ
        SET t1.í’ˆëª©ê°œìˆ˜ = t2.total_quantity
        """
        cursor.execute(sql_update_output_count)

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜ ì‘ì—… ë")
# ---ë

import time

time.sleep(1)

# ---. ì„œìš¸ëƒ‰ë™ì¶”ê°€ ë¶„ë¥˜
print("ì„œìš¸ëƒ‰ë™ì¶”ê°€ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€"
        cursor.execute(sql_truncate)

        # ì„œìš¸ëƒ‰ë™ ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = 'ì¶”ê°€'
        ORDER BY ì£¼ì†Œ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì„œìš¸ëƒ‰ë™ì¶”ê°€ ë¶„ë¥˜ ë")
# --ë


import time

time.sleep(1)




# ---. ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™
print("ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥"
        cursor.execute(sql_truncate)

        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€ í…Œì´ë¸”ì—ì„œ ìœ ë‹ˆí¬í•œ ì£¼ì†Œë¥¼ ê°€ì§„ í–‰ì„ ì„ íƒí•˜ì—¬ ì´ë™
        sql_insert_unique = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM (
            SELECT *, ROW_NUMBER() OVER (PARTITION BY ì£¼ì†Œ ORDER BY id ASC) AS rn
            FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€
        ) AS subquery
        WHERE subquery.rn = 1
        """
        cursor.execute(sql_insert_unique)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™ ë")
# --ë


import time

time.sleep(1)




# ---. ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸
print("ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ëª¨ë“  'ìˆ˜ëŸ‰'ì„ 1ë¡œ ë³€ê²½í•˜ê³  'ì†¡ì¥ëª…'ì„ "ì¶”ê°€ì†¡ì¥"ìœ¼ë¡œ ë³€ê²½
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥
        SET ìˆ˜ëŸ‰ = 1, ì†¡ì¥ëª… = '+++', ì˜µì…˜ëª… = '+++' , í’ˆëª©ì½”ë“œ = '0000'
        """
        cursor.execute(sql_update)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print(f"Updated {cursor.rowcount} rows in ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥.")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸ ì™„ë£Œ")
# --ë

import time

time.sleep(1)



# ---. ì„œìš¸ëƒ‰ë™ ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° 
print("ì„œìš¸ëƒ‰ë™ ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ë¨¼ì € ëª¨ë“  í–‰ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        sql_select = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ WHERE íƒë°°ìˆ˜ëŸ‰1 > 2"
        cursor.execute(sql_select)
        rows = cursor.fetchall()

        # ê° í–‰ì„ 'íƒë°°ìˆ˜ëŸ‰1 - 2' ë§Œí¼ ë³µì‚¬í•˜ì—¬ ì‚½ì…í•©ë‹ˆë‹¤.
        for row in rows:
            count = int(row['íƒë°°ìˆ˜ëŸ‰1']) - 2  # ì¶”ê°€í•  í–‰ì˜ ìˆ˜
            sql_insert = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥
            (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
            """
            params = (row['msg1'], row['msg2'], row['msg3'], row['msg4'], row['msg5'], row['msg6'], row['ìˆ˜ì·¨ì¸ëª…'], row['ì „í™”ë²ˆí˜¸1'], row['ì „í™”ë²ˆí˜¸2'], row['ìš°í¸ë²ˆí˜¸'], row['ì£¼ì†Œ'], row['ì˜µì…˜ëª…'], row['ìˆ˜ëŸ‰'], row['ë°°ì†¡ë©”ì„¸ì§€'], row['ì£¼ë¬¸ë²ˆí˜¸'], row['ì‡¼í•‘ëª°'], row['ìˆ˜ì§‘ì‹œê°„'], row['ì†¡ì¥ëª…'], row['í’ˆëª©ì½”ë“œ'], row['íƒë°°ë¹„ìš©'], row['ë°•ìŠ¤í¬ê¸°'], row['ì¶œë ¥ê°œìˆ˜'], row['ì†¡ì¥ìˆ˜ëŸ‰'], row['ë³„í‘œ1'], row['ë³„í‘œ2'], row['í’ˆëª©ê°œìˆ˜'], row['íƒë°°ìˆ˜ëŸ‰'], row['íƒë°°ìˆ˜ëŸ‰1'], row['íƒë°°ìˆ˜ëŸ‰í•©ì‚°'], row['ì†¡ì¥êµ¬ë¶„ì'], row['ì†¡ì¥êµ¬ë¶„'], row['ì†¡ì¥êµ¬ë¶„ìµœì¢…'], row['ìœ„ì¹˜'], row['ìœ„ì¹˜ë³€í™˜'])
            for _ in range(count):
                cursor.execute(sql_insert, params)

    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì„œìš¸ëƒ‰ë™ ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° ë")
# --ë

import time

time.sleep(1)


# ---. ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸°
print("ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸° ì‹œì‘")
# --ì‹œì‘

import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor  # ê²°ê³¼ë¥¼ ë”•ì…”ë„ˆë¦¬ í˜•íƒœë¡œ ë°›ê¸° ìœ„í•¨
)

try:
    with conn.cursor() as cursor:
        # ìœ„ì¹˜ë³€í™˜ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ëª¨ë“  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´
        sql = "SELECT id, ìœ„ì¹˜ë³€í™˜ FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ORDER BY ìœ„ì¹˜ë³€í™˜, id"
        cursor.execute(sql)
        results = cursor.fetchall()

        # í˜„ì¬ ìœ„ì¹˜ë³€í™˜ ê°’
        current_location = None
        counter = 1

        # ê²°ê³¼ë¥¼ ìˆœíšŒí•˜ë©´ì„œ ìˆœë²ˆì„ ë§¤ê¹€
        for row in results:
            if current_location != row['ìœ„ì¹˜ë³€í™˜']:
                current_location = row['ìœ„ì¹˜ë³€í™˜']
                counter = 1  # ìœ„ì¹˜ë³€í™˜ ê°’ì´ ë°”ë€Œë©´ ìˆœë²ˆì„ ë¦¬ì…‹
            
            # ì†¡ì¥êµ¬ë¶„ì ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ (ì¤‘ê´„í˜¸ í˜•ì‹ìœ¼ë¡œ)
            formatted_number = f"[{counter}]"  # ìˆ«ì ì•ë’¤ë¡œ ëŒ€ê´„í˜¸ ì¶”ê°€
            update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ SET ì†¡ì¥êµ¬ë¶„ì=%s WHERE id=%s"
            cursor.execute(update_sql, (formatted_number, row['id']))
            counter += 1

        conn.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

finally:
    conn.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

# ---. ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸°
print("ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸° ë")
# --ë

import time

time.sleep(1)


# ---. ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸
print("ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸ ì‹œì‘")
# --ì‹œì‘


import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with conn.cursor() as cursor:
        # 'ì£¼ì†Œ' ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ ì¿¼ë¦¬ ì‹¤í–‰
        update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ SET ì£¼ì†Œ = CONCAT(ì£¼ì†Œ, ì†¡ì¥êµ¬ë¶„ì)"
        cursor.execute(update_sql)
        conn.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    conn.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ


# ---. ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸
print("ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸ ë")
# --ë

import time

time.sleep(1)


import pymysql
import pymysql.cursors

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # í…Œì´ë¸”ì„ ë¹„ì›ë‹ˆë‹¤.
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€í•©ì¹˜ê¸°")
        
        # ë°ì´í„° ë³‘í•© ë° ì‚½ì… ì¿¼ë¦¬
        merge_and_insert_query = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€í•©ì¹˜ê¸°(msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM (
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€
            UNION ALL
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€ì†¡ì¥
        ) AS combined
        ORDER BY ìœ„ì¹˜ DESC
        """
        cursor.execute(merge_and_insert_query)
        
        # ë³€ê²½ ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— í™•ì •í•©ë‹ˆë‹¤.
        connection.commit()

finally:
    # ì—°ê²°ì„ ë‹«ìŠµë‹ˆë‹¤.
    connection.close()


import time

time.sleep(1)



# ---. ì„œìš¸ëƒ‰ë™ í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬
print("ì„œìš¸ëƒ‰ë™ í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬ ì‹œì‘")
# --ì‹œì‘


import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ í…Œì´ë¸” ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™")
        
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë‹¨ì¼ í…Œì´ë¸”ì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ì„œ ì •ë ¬ í›„ ì‚½ì…
        sql_insert_from_single = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë‹¨ì¼
        ORDER BY ìœ„ì¹˜ë³€í™˜ ASC
        """
        cursor.execute(sql_insert_from_single)

        # ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤ í…Œì´ë¸”ì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ì„œ ì •ë ¬ í›„ ì‚½ì…
        sql_insert_from_box = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
            SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
            FROM ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤
            WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ì„œìš¸ë°•ìŠ¤'
            ORDER BY ìœ„ì¹˜ë³€í™˜ ASC
        """
        cursor.execute(sql_insert_from_box)




        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™1ì¥ í…Œì´ë¸”ì˜ ë°ì´í„°ë„ ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì— ì¶”ê°€
        sql_insert_from_one = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™1ì¥
        """
        cursor.execute(sql_insert_from_one)

        # ë‘ í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ í•©ì¹˜ê³ , ID ì»¬ëŸ¼ì„ ì œì™¸í•œ í›„ ì •ë ¬í•˜ì—¬ ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì— ì‚½ì…
        sql_merge_and_sort = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì¶”ê°€í•©ì¹˜ê¸°
        ORDER BY ì£¼ì†Œ ASC
        """
        cursor.execute(sql_merge_and_sort)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()


# ---. ì„œìš¸ëƒ‰ë™ í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬
print("ì„œìš¸ëƒ‰ë™ í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬ ë")
# --ë

import time

time.sleep(1)


# ---. ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‘ì—…
print("ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³„í‘œ í…Œì´ë¸”ì„ ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³„í‘œ")
        print("ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³„í‘œ í…Œì´ë¸”ì´ ë¹„ì›Œì¡ŒìŠµë‹ˆë‹¤.")

        # ë³„í‘œ1 ë˜ëŠ” ë³„í‘œ2ê°€ ë¹„ì–´ìˆì§€ ì•Šì€ í–‰ì„ ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³„í‘œ í…Œì´ë¸”ë¡œ ì´ë™
        sql_move_to_star_table = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³„í‘œ
        SELECT * FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™
        WHERE ë³„í‘œ1 <> '' OR ë³„í‘œ2 <> ''
        """
        cursor.execute(sql_move_to_star_table)
        print(f"Moved {cursor.rowcount} rows to 'ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³„í‘œ'.")

        # ì´ë™ëœ í–‰ ì‚­ì œ
        sql_delete_moved_rows = """
        DELETE FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™
        WHERE ë³„í‘œ1 <> '' OR ë³„í‘œ2 <> ''
        """
        cursor.execute(sql_delete_moved_rows)
        print(f"Deleted {cursor.rowcount} rows from 'ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™'.")

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥


finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‘ì—… ì™„ë£Œ")
# ---ë


import time

time.sleep(1)


# ---. ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™
print("ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³„í‘œì—ì„œ ë³„í‘œ1ë¡œ ì •ë ¬í•˜ì—¬ ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì— ë°ì´í„° ì‚½ì…
        sql_transfer_data = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™
        (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ë³„í‘œ
        ORDER BY ì£¼ì†Œ ASC, ì˜µì…˜ëª… ASC
        """
        cursor.execute(sql_transfer_data)

        print(f"Rows moved: {cursor.rowcount}")  # ì´ë™ëœ í–‰ì˜ ìˆ˜ ì¶œë ¥

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™ ì‘ì—… ì™„ë£Œ")
# ---ë


import time

time.sleep(1)



# ---. ë°ì´í„° ì´ë™ ì‘ì—…
print("ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì—ì„œ ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™_ìµœì¢… í…Œì´ë¸”ì„ ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™_ìµœì¢…")

        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì—ì„œ ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™
        sql_transfer_data = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™_ìµœì¢…
            (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
             ì†¡ì¥ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, 
             ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
               ì†¡ì¥ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, 
               ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™
        """
        cursor.execute(sql_transfer_data)
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Moved {cursor.rowcount} rows from 'ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™' to 'ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™_ìµœì¢…'.")

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™ì—ì„œ ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™ ì‘ì—… ì™„ë£Œ")
# ---ë

import time

time.sleep(1)

# ---. ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸
print("ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜ ì—…ë°ì´íŠ¸
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™_ìµœì¢…
        SET íƒë°°ë¹„ìš© = 2150, ë°•ìŠ¤í¬ê¸° = 'ê·¹ì†Œ', ì¶œë ¥ê°œìˆ˜ = 1
        """
        cursor.execute(sql_update)
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated {cursor.rowcount} rows in 'ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™_ìµœì¢…'.")

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì™„ë£Œ")
# ---ë

import time

time.sleep(1)

print("ì„œìš¸ëƒ‰ë™_ìµœì¢…íŒŒì¼ë§Œë“¤ê¸° ì‹œì‘")
# ---ì‹œì‘

import pandas as pd
import mysql.connector
from datetime import datetime
import dropbox
import requests

# ë°ì´í„°ë² ì´ìŠ¤ ë° ë°ì´í„° ì²˜ë¦¬ ì‹œì‘
connection = mysql.connector.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci'
)

cursor = connection.cursor()
query = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™_ìµœì¢…"
cursor.execute(query)
result = cursor.fetchall()
columns = cursor.column_names
df = pd.DataFrame(result, columns=columns)
unique_count = df.drop_duplicates(subset=['ì£¼ì†Œ', 'ìˆ˜ì·¨ì¸ëª…', 'ì „í™”ë²ˆí˜¸1']).shape[0]
connection.close()

# íŒŒì¼ ì €ì¥ ë° Dropbox ì—…ë¡œë“œ
now = datetime.now()
file_path = f'ì„œìš¸ëƒ‰ë™/ì„œìš¸ëƒ‰ë™_{now.strftime("%y%m%d_%Hì‹œ%Më¶„")}.xlsx'
df.to_excel(file_path, index=False, header=False)

refresh_token = '1CLvznLL7BwAAAAAAAAAAagAlVx3w9P6NGyYjsITAxrSG9vlAEc31ohZZwYhUAB_'
app_key = 'vlxh3ec9nq5fi5t'
app_secret = 'h5rp5n0w9cp4ifk'
token_url = "https://api.dropbox.com/oauth2/token"
params = {
    'refresh_token': refresh_token,
    'grant_type': 'refresh_token',
    'client_id': app_key,
    'client_secret': app_secret
}
response = requests.post(token_url, data=params)
access_token = response.json().get('access_token')

dbx = dropbox.Dropbox(access_token)
with open(file_path, "rb") as f:
    dbx.files_upload(f.read(), f'/ì„œìš¸ëƒ‰ë™/{file_path}', mode=dropbox.files.WriteMode("overwrite"))
shared_link_metadata = dbx.sharing_create_shared_link_with_settings(f'/ì„œìš¸ëƒ‰ë™/{file_path}')

# ì‹œê°„ëŒ€ë³„ ì°¨ìˆ˜ ì„¤ì •
hour = now.hour
minute = now.minute

if 1 <= hour <= 7:
    batch = "1ì°¨"
elif 8 <= hour <= 10:
    batch = "2ì°¨"
elif 11 <= hour <= 11:
    batch = "3ì°¨"
elif 12 <= hour <= 13:
    batch = "4ì°¨"
elif 14 <= hour <= 15:
    batch = "5ì°¨"
elif 16 <= hour <= 18:
    batch = "ë§‰ì°¨"
elif 19 <= hour <= 23:
    batch = "ì¶”ê°€"
else:
    batch = ""  # 24ì‹œ(0ì‹œ)ëŠ” ë°°ì¹˜ ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ


import time

time.sleep(1)

# ì¹´ì¹´ì˜¤ì›Œí¬ ë©”ì‹œì§€ ì „ì†¡
app_key = 'b36ed46e.0b55706350e94ef8b49e8647a97ae1b7'
chatroom_id = '9483024'
time_string = now.strftime("%mì›” %dì¼ %Hì‹œ %Më¶„")

def send_kakao_work_message(app_key, chatroom_id, file_url, batch):
    url = "https://api.kakaowork.com/v1/messages.send"
    headers = {
        "Authorization": f"Bearer {app_key}",
        "Content-Type": "application/json"
    }
    data = {
        "conversation_id": chatroom_id,
        "text": f"{batch} - ì„œìš¸ëƒ‰ë™ ìš´ì†¡ì¥ ìˆ˜ì§‘ ì™„ë£Œ",
        "blocks": [
            {
                "type": "header",
                "text": f"{batch} - ì„œìš¸ëƒ‰ë™ ìš´ì†¡ì¥ ìˆ˜ì§‘ ì™„ë£Œ",
                "style": "blue"
            },
            {
                "type": "text",
                "text": "ì•„ë˜ ë§í¬ì—ì„œ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”!",
                "markdown": True
            },
            {
                "type": "button",
                "text": "íŒŒì¼ ë‹¤ìš´ë¡œë“œ",
                "style": "default",
                "action_type": "open_system_browser",
                "value": file_url
            },
            {
                "type": "divider"
            },
            {
                "type": "text",
                "text": f"*ì†¡ì¥ ê°œìˆ˜:* {unique_count}ê±´",
                "markdown": True
            },
            {
                "type": "divider"
            },
            {
                "type": "text",
                "text": "*ì†¡ì¥ë„˜ê¸°ê¸°*\nì•„ì´ë””: `gram`\në¹„ë²ˆ: `3535`\n[ğŸ‘‰ ì†¡ì¥ ê´€ë¦¬ í˜ì´ì§€ ë°”ë¡œê°€ê¸°](https://gramwon.me/orders/transfer)",
                "markdown": True
            },
            {
                "type": "divider"
            },
        ]
    }
    response = requests.post(url, headers=headers, json=data)
    return response.json()

result = send_kakao_work_message(app_key, chatroom_id, shared_link_metadata.url, batch)
print(result)



# ---. ê²½ê¸°ëƒ‰ë™ë‚±ê°œ ë¶„ë¥˜
print("ê²½ê¸°ëƒ‰ë™ë‚±ê°œ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³€í™˜ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³€í™˜"
        cursor.execute(sql_truncate)

        # ê²½ê¸°ëƒ‰ë™ ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³€í™˜ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ëƒ‰ë™ë‚±ê°œ'
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê²½ê¸°ëƒ‰ë™ë‚±ê°œ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)




# ---. íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸
print("íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰ì„ ì´ìš©í•˜ì—¬ 1ì„ ë‚˜ëˆˆ ê²°ê³¼ë¥¼ ì†Œìˆ˜ì  ì„¸ ìë¦¬ì—ì„œ ë‚´ë¦¼í•˜ì—¬ ì†¡ì¥êµ¬ë¶„ì ì»¬ëŸ¼ì— ì—…ë°ì´íŠ¸
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ì = FLOOR((1 / IFNULL(NULLIF(íƒë°°ìˆ˜ëŸ‰, 0), 10)) * 1000) / 1000
        """
        cursor.execute(sql_update)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ë")
# --ë


import time

time.sleep(1)



# ---. ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸
print("ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ì„ ê³±í•˜ì—¬ ê²°ê³¼ ì—…ë°ì´íŠ¸
        sql_multiply_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ì = ì†¡ì¥êµ¬ë¶„ì * ìˆ˜ëŸ‰
        """
        cursor.execute(sql_multiply_update)
        connection.commit()

        print(f"ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ì™„ë£Œ, {cursor.rowcount} í–‰ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸ ë")
# --ë


import time

time.sleep(1)



# ---. ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ë° íƒë°°ìˆ˜ëŸ‰1 ì—…ë°ì´íŠ¸
print("ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª…ì„ ê¸°ì¤€ìœ¼ë¡œ ì†¡ì¥êµ¬ë¶„ìë¥¼ í•©ì‚°
        sql_group_sum = """
        SELECT ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…, SUM(ì†¡ì¥êµ¬ë¶„ì) AS êµ¬ë¶„ìí•©
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³€í™˜
        GROUP BY ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
        """
        cursor.execute(sql_group_sum)
        results = cursor.fetchall()

        # ê° ê·¸ë£¹ì˜ êµ¬ë¶„ìí•©ì„ íƒë°°ìˆ˜ëŸ‰1ì— ì—…ë°ì´íŠ¸
        for result in results:
            sql_update = """
            UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³€í™˜
            SET íƒë°°ìˆ˜ëŸ‰1 = %s
            WHERE ì£¼ì†Œ = %s AND ìˆ˜ì·¨ì¸ëª… = %s
            """
            cursor.execute(sql_update, (result['êµ¬ë¶„ìí•©'], result['ì£¼ì†Œ'], result['ìˆ˜ì·¨ì¸ëª…']))

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"Updated {cursor.rowcount} rows based on address and recipient name.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ë° íƒë°°ìˆ˜ëŸ‰1 ì—…ë°ì´íŠ¸ ë")
# --ë

import time

time.sleep(1)




print("íƒë°°ìˆ˜ëŸ‰1 ì˜¬ë¦¼ ì²˜ë¦¬ ì‹œì‘")
import pymysql
import math

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰1ì˜ í˜„ì¬ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        sql_fetch = "SELECT id, íƒë°°ìˆ˜ëŸ‰1 FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³€í™˜"
        cursor.execute(sql_fetch)
        results = cursor.fetchall()

        updated_rows = 0  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ë¥¼ ì¶”ì 
        # ê° í–‰ì˜ íƒë°°ìˆ˜ëŸ‰1 ê°’ì„ ì˜¬ë¦¼ ì²˜ë¦¬í•˜ê³  ì—…ë°ì´íŠ¸ í•©ë‹ˆë‹¤.
        for result in results:
            current_quantity = result['íƒë°°ìˆ˜ëŸ‰1']
            if current_quantity is None:  # íƒë°°ìˆ˜ëŸ‰1ì´ Noneì¼ ë•Œ ì²˜ë¦¬
                current_quantity = 1  # None ê°’ì„ 30ìœ¼ë¡œ ì„¤ì •
            
            rounded_quantity = math.ceil(float(current_quantity))  # íƒë°°ìˆ˜ëŸ‰1 ê°’ì„ ì˜¬ë¦¼
            sql_update = "UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³€í™˜ SET íƒë°°ìˆ˜ëŸ‰1 = %s WHERE id = %s"
            cursor.execute(sql_update, (rounded_quantity, result['id']))
            updated_rows += cursor.rowcount

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜: {updated_rows}")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("íƒë°°ìˆ˜ëŸ‰1 ì˜¬ë¦¼ ì²˜ë¦¬ ì™„ë£Œ")
# --ë


import time

time.sleep(1)




# ---. íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸
print("íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰1ì´ 1ë³´ë‹¤ í° ê²½ìš° 'ì¶”ê°€'ë¡œ ì—…ë°ì´íŠ¸
        update_more_than_one = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ = 'ì¶”ê°€'
        WHERE íƒë°°ìˆ˜ëŸ‰1 > 1
        """
        cursor.execute(update_more_than_one)
        
        # íƒë°°ìˆ˜ëŸ‰1ì´ 1 ì´í•˜ì¸ ê²½ìš° '1ì¥'ìœ¼ë¡œ ì—…ë°ì´íŠ¸
        update_one_or_less = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        WHERE íƒë°°ìˆ˜ëŸ‰1 <= 1
        """
        cursor.execute(update_one_or_less)
        
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated rows for more than one: {cursor.rowcount}")  # 'ì¶”ê°€'ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥
        print(f"Updated rows for one or less: {cursor.rowcount}")  # '1ì¥'ìœ¼ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‘ì—… ë")
# ---ë

import time

time.sleep(1)



# ---. ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸
print("ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ì¡°í•©ì´ ìœ ì¼í•œ ê²½ìš° 'ë‹¨ì¼'ë¡œ ì—…ë°ì´íŠ¸
        update_unique_address_and_name = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³€í™˜ t1
        JOIN (
            SELECT ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
            FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³€í™˜
            WHERE ì†¡ì¥êµ¬ë¶„ = '1ì¥'
            GROUP BY ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
            HAVING COUNT(*) = 1
        ) AS unique_address ON t1.ì£¼ì†Œ = unique_address.ì£¼ì†Œ AND t1.ìˆ˜ì·¨ì¸ëª… = unique_address.ìˆ˜ì·¨ì¸ëª…
        SET t1.ì†¡ì¥êµ¬ë¶„ = 'ë‹¨ì¼'
        WHERE t1.ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        """
        cursor.execute(update_unique_address_and_name)

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated unique address and name rows to 'ë‹¨ì¼': {cursor.rowcount}")  # 'ë‹¨ì¼'ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‘ì—… ë")
# ---ë



# ---. ê²½ê¸°ëƒ‰ë™1ì¥ ë¶„ë¥˜
print("ê²½ê¸°ëƒ‰ë™1ì¥ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™1ì¥ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™1ì¥"
        cursor.execute(sql_truncate)

        # ê²½ê¸°ëƒ‰ë™ ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™1ì¥ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        ORDER BY ìœ„ì¹˜ë³€í™˜ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê²½ê¸°ëƒ‰ë™1ì¥ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)


# ---. ê²½ê¸°ëƒ‰ë™ë‹¨ì¼ ë¶„ë¥˜
print("ê²½ê¸°ëƒ‰ë™ë‹¨ì¼ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë‹¨ì¼ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë‹¨ì¼"
        cursor.execute(sql_truncate)

        # ê²½ê¸°ëƒ‰ë™ ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë‹¨ì¼ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = 'ë‹¨ì¼'
        ORDER BY ìœ„ì¹˜ë³€í™˜ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê²½ê¸°ëƒ‰ë™ë‹¨ì¼ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)

# ---. í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜
print("í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # í’ˆëª©ì½”ë“œë³„ë¡œ ìˆ˜ëŸ‰ì„ í•©ì‚°í•˜ì—¬ ì¶œë ¥ê°œìˆ˜ì— ì—…ë°ì´íŠ¸
        sql_update_output_count = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë‹¨ì¼ AS t1 
        INNER JOIN (
            SELECT í’ˆëª©ì½”ë“œ, SUM(ìˆ˜ëŸ‰) AS total_quantity
            FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë‹¨ì¼
            GROUP BY í’ˆëª©ì½”ë“œ
        ) AS t2 ON t1.í’ˆëª©ì½”ë“œ = t2.í’ˆëª©ì½”ë“œ
        SET t1.í’ˆëª©ê°œìˆ˜ = t2.total_quantity
        """
        cursor.execute(sql_update_output_count)

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜ ì‘ì—… ë")
# ---ë

import time

time.sleep(1)

# ---. ê²½ê¸°ëƒ‰ë™ì¶”ê°€ ë¶„ë¥˜
print("ê²½ê¸°ëƒ‰ë™ì¶”ê°€ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€"
        cursor.execute(sql_truncate)

        # ê²½ê¸°ëƒ‰ë™ ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = 'ì¶”ê°€'
        ORDER BY ì£¼ì†Œ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê²½ê¸°ëƒ‰ë™ì¶”ê°€ ë¶„ë¥˜ ë")
# --ë


import time

time.sleep(1)




# ---. ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™
print("ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥"
        cursor.execute(sql_truncate)

        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€ í…Œì´ë¸”ì—ì„œ ìœ ë‹ˆí¬í•œ ì£¼ì†Œë¥¼ ê°€ì§„ í–‰ì„ ì„ íƒí•˜ì—¬ ì´ë™
        sql_insert_unique = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM (
            SELECT *, ROW_NUMBER() OVER (PARTITION BY ì£¼ì†Œ ORDER BY id ASC) AS rn
            FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€
        ) AS subquery
        WHERE subquery.rn = 1
        """
        cursor.execute(sql_insert_unique)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™ ë")
# --ë


import time

time.sleep(1)




# ---. ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸
print("ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ëª¨ë“  'ìˆ˜ëŸ‰'ì„ 1ë¡œ ë³€ê²½í•˜ê³  'ì†¡ì¥ëª…'ì„ "ì¶”ê°€ì†¡ì¥"ìœ¼ë¡œ ë³€ê²½
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥
        SET ìˆ˜ëŸ‰ = 1, ì†¡ì¥ëª… = '+++', ì˜µì…˜ëª… = '+++' , í’ˆëª©ì½”ë“œ = '0000'
        """
        cursor.execute(sql_update)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print(f"Updated {cursor.rowcount} rows in ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥.")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸ ì™„ë£Œ")
# --ë

import time

time.sleep(1)



# ---. ê²½ê¸°ëƒ‰ë™ ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° 
print("ê²½ê¸°ëƒ‰ë™ ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ë¨¼ì € ëª¨ë“  í–‰ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        sql_select = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ WHERE íƒë°°ìˆ˜ëŸ‰1 > 2"
        cursor.execute(sql_select)
        rows = cursor.fetchall()

        # ê° í–‰ì„ 'íƒë°°ìˆ˜ëŸ‰1 - 2' ë§Œí¼ ë³µì‚¬í•˜ì—¬ ì‚½ì…í•©ë‹ˆë‹¤.
        for row in rows:
            count = int(row['íƒë°°ìˆ˜ëŸ‰1']) - 2  # ì¶”ê°€í•  í–‰ì˜ ìˆ˜
            sql_insert = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥
            (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
            """
            params = (row['msg1'], row['msg2'], row['msg3'], row['msg4'], row['msg5'], row['msg6'], row['ìˆ˜ì·¨ì¸ëª…'], row['ì „í™”ë²ˆí˜¸1'], row['ì „í™”ë²ˆí˜¸2'], row['ìš°í¸ë²ˆí˜¸'], row['ì£¼ì†Œ'], row['ì˜µì…˜ëª…'], row['ìˆ˜ëŸ‰'], row['ë°°ì†¡ë©”ì„¸ì§€'], row['ì£¼ë¬¸ë²ˆí˜¸'], row['ì‡¼í•‘ëª°'], row['ìˆ˜ì§‘ì‹œê°„'], row['ì†¡ì¥ëª…'], row['í’ˆëª©ì½”ë“œ'], row['íƒë°°ë¹„ìš©'], row['ë°•ìŠ¤í¬ê¸°'], row['ì¶œë ¥ê°œìˆ˜'], row['ì†¡ì¥ìˆ˜ëŸ‰'], row['ë³„í‘œ1'], row['ë³„í‘œ2'], row['í’ˆëª©ê°œìˆ˜'], row['íƒë°°ìˆ˜ëŸ‰'], row['íƒë°°ìˆ˜ëŸ‰1'], row['íƒë°°ìˆ˜ëŸ‰í•©ì‚°'], row['ì†¡ì¥êµ¬ë¶„ì'], row['ì†¡ì¥êµ¬ë¶„'], row['ì†¡ì¥êµ¬ë¶„ìµœì¢…'], row['ìœ„ì¹˜'], row['ìœ„ì¹˜ë³€í™˜'])
            for _ in range(count):
                cursor.execute(sql_insert, params)

    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê²½ê¸°ëƒ‰ë™ ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° ë")
# --ë

import time

time.sleep(1)


# ---. ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸°
print("ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸° ì‹œì‘")
# --ì‹œì‘

import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor  # ê²°ê³¼ë¥¼ ë”•ì…”ë„ˆë¦¬ í˜•íƒœë¡œ ë°›ê¸° ìœ„í•¨
)

try:
    with conn.cursor() as cursor:
        # ìœ„ì¹˜ë³€í™˜ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ëª¨ë“  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´
        sql = "SELECT id, ìœ„ì¹˜ë³€í™˜ FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ORDER BY ìœ„ì¹˜ë³€í™˜, id"
        cursor.execute(sql)
        results = cursor.fetchall()

        # í˜„ì¬ ìœ„ì¹˜ë³€í™˜ ê°’
        current_location = None
        counter = 1

        # ê²°ê³¼ë¥¼ ìˆœíšŒí•˜ë©´ì„œ ìˆœë²ˆì„ ë§¤ê¹€
        for row in results:
            if current_location != row['ìœ„ì¹˜ë³€í™˜']:
                current_location = row['ìœ„ì¹˜ë³€í™˜']
                counter = 1  # ìœ„ì¹˜ë³€í™˜ ê°’ì´ ë°”ë€Œë©´ ìˆœë²ˆì„ ë¦¬ì…‹
            
            # ì†¡ì¥êµ¬ë¶„ì ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ (ì¤‘ê´„í˜¸ í˜•ì‹ìœ¼ë¡œ)
            formatted_number = f"[{counter}]"  # ìˆ«ì ì•ë’¤ë¡œ ëŒ€ê´„í˜¸ ì¶”ê°€
            update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ SET ì†¡ì¥êµ¬ë¶„ì=%s WHERE id=%s"
            cursor.execute(update_sql, (formatted_number, row['id']))
            counter += 1

        conn.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

finally:
    conn.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

# ---. ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸°
print("ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸° ë")
# --ë

import time

time.sleep(1)


# ---. ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸
print("ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸ ì‹œì‘")
# --ì‹œì‘


import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with conn.cursor() as cursor:
        # 'ì£¼ì†Œ' ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ ì¿¼ë¦¬ ì‹¤í–‰
        update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ SET ì£¼ì†Œ = CONCAT(ì£¼ì†Œ, ì†¡ì¥êµ¬ë¶„ì)"
        cursor.execute(update_sql)
        conn.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    conn.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ


# ---. ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸
print("ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸ ë")
# --ë

import time

time.sleep(1)


import pymysql
import pymysql.cursors

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # í…Œì´ë¸”ì„ ë¹„ì›ë‹ˆë‹¤.
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€í•©ì¹˜ê¸°")
        
        # ë°ì´í„° ë³‘í•© ë° ì‚½ì… ì¿¼ë¦¬
        merge_and_insert_query = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€í•©ì¹˜ê¸°(msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM (
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€
            UNION ALL
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€ì†¡ì¥
        ) AS combined
        ORDER BY ìœ„ì¹˜ DESC
        """
        cursor.execute(merge_and_insert_query)
        
        # ë³€ê²½ ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— í™•ì •í•©ë‹ˆë‹¤.
        connection.commit()

finally:
    # ì—°ê²°ì„ ë‹«ìŠµë‹ˆë‹¤.
    connection.close()


import time

time.sleep(1)



# ---. ê²½ê¸°ëƒ‰ë™ í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬
print("ê²½ê¸°ëƒ‰ë™ í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬ ì‹œì‘")
# --ì‹œì‘


import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ í…Œì´ë¸” ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™")
        
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë‹¨ì¼ í…Œì´ë¸”ì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ì„œ ì •ë ¬ í›„ ì‚½ì…
        sql_insert_from_single = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë‹¨ì¼
        ORDER BY ìœ„ì¹˜ë³€í™˜ ASC
        """
        cursor.execute(sql_insert_from_single)

        # ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤ í…Œì´ë¸”ì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ì„œ ì •ë ¬ í›„ ì‚½ì…
        sql_insert_from_box = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
            SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
            FROM ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤
            WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ëƒ‰ë™ë°•ìŠ¤'
            ORDER BY ìœ„ì¹˜ë³€í™˜ ASC
        """
        cursor.execute(sql_insert_from_box)




        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™1ì¥ í…Œì´ë¸”ì˜ ë°ì´í„°ë„ ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì— ì¶”ê°€
        sql_insert_from_one = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™1ì¥
        """
        cursor.execute(sql_insert_from_one)

        # ë‘ í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ í•©ì¹˜ê³ , ID ì»¬ëŸ¼ì„ ì œì™¸í•œ í›„ ì •ë ¬í•˜ì—¬ ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì— ì‚½ì…
        sql_merge_and_sort = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì¶”ê°€í•©ì¹˜ê¸°
        ORDER BY ì£¼ì†Œ ASC
        """
        cursor.execute(sql_merge_and_sort)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()


# ---. ê²½ê¸°ëƒ‰ë™ í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬
print("ê²½ê¸°ëƒ‰ë™ í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬ ë")
# --ë

import time

time.sleep(1)


# ---. ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‘ì—…
print("ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³„í‘œ í…Œì´ë¸”ì„ ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³„í‘œ")
        print("ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³„í‘œ í…Œì´ë¸”ì´ ë¹„ì›Œì¡ŒìŠµë‹ˆë‹¤.")

        # ë³„í‘œ1 ë˜ëŠ” ë³„í‘œ2ê°€ ë¹„ì–´ìˆì§€ ì•Šì€ í–‰ì„ ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³„í‘œ í…Œì´ë¸”ë¡œ ì´ë™
        sql_move_to_star_table = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³„í‘œ
        SELECT * FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™
        WHERE ë³„í‘œ1 <> '' OR ë³„í‘œ2 <> ''
        """
        cursor.execute(sql_move_to_star_table)
        print(f"Moved {cursor.rowcount} rows to 'ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³„í‘œ'.")

        # ì´ë™ëœ í–‰ ì‚­ì œ
        sql_delete_moved_rows = """
        DELETE FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™
        WHERE ë³„í‘œ1 <> '' OR ë³„í‘œ2 <> ''
        """
        cursor.execute(sql_delete_moved_rows)
        print(f"Deleted {cursor.rowcount} rows from 'ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™'.")

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥


finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‘ì—… ì™„ë£Œ")
# ---ë


import time

time.sleep(1)


# ---. ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™
print("ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³„í‘œì—ì„œ ë³„í‘œ1ë¡œ ì •ë ¬í•˜ì—¬ ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì— ë°ì´í„° ì‚½ì…
        sql_transfer_data = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™
        (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ë³„í‘œ
        ORDER BY ì£¼ì†Œ ASC, ì˜µì…˜ëª… ASC
        """
        cursor.execute(sql_transfer_data)

        print(f"Rows moved: {cursor.rowcount}")  # ì´ë™ëœ í–‰ì˜ ìˆ˜ ì¶œë ¥

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™ ì‘ì—… ì™„ë£Œ")
# ---ë


import time

time.sleep(1)



# ---. ë°ì´í„° ì´ë™ ì‘ì—…
print("ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì—ì„œ ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™_ìµœì¢… í…Œì´ë¸”ì„ ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™_ìµœì¢…")

        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì—ì„œ ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™
        sql_transfer_data = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™_ìµœì¢…
            (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
             ì†¡ì¥ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, 
             ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
               ì†¡ì¥ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, 
               ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™
        """
        cursor.execute(sql_transfer_data)
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Moved {cursor.rowcount} rows from 'ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™' to 'ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™_ìµœì¢…'.")

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™ì—ì„œ ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™ ì‘ì—… ì™„ë£Œ")
# ---ë

import time

time.sleep(1)

# ---. ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸
print("ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜ ì—…ë°ì´íŠ¸
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™_ìµœì¢…
        SET íƒë°°ë¹„ìš© = 2150, ë°•ìŠ¤í¬ê¸° = 'ê·¹ì†Œ', ì¶œë ¥ê°œìˆ˜ = 1
        """
        cursor.execute(sql_update)
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated {cursor.rowcount} rows in 'ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™_ìµœì¢…'.")

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì™„ë£Œ")
# ---ë

import time

time.sleep(5)

print("ê²½ê¸°ëƒ‰ë™_ìµœì¢…íŒŒì¼ë§Œë“¤ê¸° ì‹œì‘")
# ---ì‹œì‘

import pandas as pd
import mysql.connector
from datetime import datetime
import dropbox
import requests

# ë°ì´í„°ë² ì´ìŠ¤ ë° ë°ì´í„° ì²˜ë¦¬ ì‹œì‘
connection = mysql.connector.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci'
)

cursor = connection.cursor()
query = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™_ìµœì¢…"
cursor.execute(query)
result = cursor.fetchall()
columns = cursor.column_names
df = pd.DataFrame(result, columns=columns)
unique_count = df.drop_duplicates(subset=['ì£¼ì†Œ', 'ìˆ˜ì·¨ì¸ëª…', 'ì „í™”ë²ˆí˜¸1']).shape[0]
connection.close()

# íŒŒì¼ ì €ì¥ ë° Dropbox ì—…ë¡œë“œ
now = datetime.now()
file_path = f'ê²½ê¸°ëƒ‰ë™/ê²½ê¸°ëƒ‰ë™_{now.strftime("%y%m%d_%Hì‹œ%Më¶„")}.xlsx'
df.to_excel(file_path, index=False, header=False)

refresh_token = '1CLvznLL7BwAAAAAAAAAAagAlVx3w9P6NGyYjsITAxrSG9vlAEc31ohZZwYhUAB_'
app_key = 'vlxh3ec9nq5fi5t'
app_secret = 'h5rp5n0w9cp4ifk'
token_url = "https://api.dropbox.com/oauth2/token"
params = {
    'refresh_token': refresh_token,
    'grant_type': 'refresh_token',
    'client_id': app_key,
    'client_secret': app_secret
}
response = requests.post(token_url, data=params)
access_token = response.json().get('access_token')

dbx = dropbox.Dropbox(access_token)
with open(file_path, "rb") as f:
    dbx.files_upload(f.read(), f'/ê²½ê¸°ëƒ‰ë™/{file_path}', mode=dropbox.files.WriteMode("overwrite"))
shared_link_metadata = dbx.sharing_create_shared_link_with_settings(f'/ê²½ê¸°ëƒ‰ë™/{file_path}')

# ì‹œê°„ëŒ€ë³„ ì°¨ìˆ˜ ì„¤ì •
hour = now.hour
minute = now.minute

if 1 <= hour <= 7:
    batch = "1ì°¨"
elif 8 <= hour <= 10:
    batch = "2ì°¨"
elif 11 <= hour <= 11:
    batch = "3ì°¨"
elif 12 <= hour <= 13:
    batch = "4ì°¨"
elif 14 <= hour <= 15:
    batch = "5ì°¨"
elif 16 <= hour <= 18:
    batch = "ë§‰ì°¨"
elif 19 <= hour <= 23:
    batch = "ì¶”ê°€"
else:
    batch = ""  # 24ì‹œ(0ì‹œ)ëŠ” ë°°ì¹˜ ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ


import time

time.sleep(10)

# ì¹´ì¹´ì˜¤ì›Œí¬ ë©”ì‹œì§€ ì „ì†¡
app_key = 'b36ed46e.0b55706350e94ef8b49e8647a97ae1b7'
chatroom_id = '9483024'
time_string = now.strftime("%mì›” %dì¼ %Hì‹œ %Më¶„")

def send_kakao_work_message(app_key, chatroom_id, file_url, batch):
    url = "https://api.kakaowork.com/v1/messages.send"
    headers = {
        "Authorization": f"Bearer {app_key}",
        "Content-Type": "application/json"
    }
    data = {
        "conversation_id": chatroom_id,
        "text": f"{batch} - ê²½ê¸°ëƒ‰ë™ ìš´ì†¡ì¥ ìˆ˜ì§‘ ì™„ë£Œ",
        "blocks": [
            {
                "type": "header",
                "text": f"{batch} - ê²½ê¸°ëƒ‰ë™ ìš´ì†¡ì¥ ìˆ˜ì§‘ ì™„ë£Œ",
                "style": "blue"
            },
            {
                "type": "text",
                "text": "ì•„ë˜ ë§í¬ì—ì„œ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”!",
                "markdown": True
            },
            {
                "type": "button",
                "text": "íŒŒì¼ ë‹¤ìš´ë¡œë“œ",
                "style": "default",
                "action_type": "open_system_browser",
                "value": file_url
            },
            {
                "type": "divider"
            },
            {
                "type": "text",
                "text": f"*ì†¡ì¥ ê°œìˆ˜:* {unique_count}ê±´",
                "markdown": True
            },
            {
                "type": "divider"
            },
            {
                "type": "text",
                "text": "*ì†¡ì¥ë„˜ê¸°ê¸°*\nì•„ì´ë””: `gram`\në¹„ë²ˆ: `3535`\n[ğŸ‘‰ ì†¡ì¥ ê´€ë¦¬ í˜ì´ì§€ ë°”ë¡œê°€ê¸°](https://gramwon.me/orders/transfer)",
                "markdown": True
            },
            {
                "type": "divider"
            },
        ]
    }
    response = requests.post(url, headers=headers, json=data)
    return response.json()

result = send_kakao_work_message(app_key, chatroom_id, shared_link_metadata.url, batch)
print(result)



import time

time.sleep(1)


# ---. ê²½ê¸°ëƒ‰ë™ ì „ì²´ ë
print("ê²½ê¸°ëƒ‰ë™ ì „ì²´ ë")
print("ê²½ê¸°ê³µì‚° ì‹œì‘")
# ---. ê²½ê¸°ê³µì‚° ì‹œì‘



print("ì„œìš¸ê³µì‚° ì‹œì‘")
# ---. ê²½ê¸°ê³µì‚° ì‹œì‘

import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# ì—°ê²°
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # 1. ê³µì‚°ë‚±ê°œ ì¤‘ ì„œìš¸ ì£¼ì†Œ â†’ ì„œê³µë‚±ê°œ
        update_query_1 = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ì„œê³µë‚±ê°œ'
        WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ê³µì‚°ë‚±ê°œ'
          AND SUBSTRING(
                TRIM(SUBSTRING_INDEX(ì£¼ì†Œ, ']', -1)), 1, 2
              ) = 'ì„œìš¸'
          AND ì‡¼í•‘ëª° IN ('Cafe24(ì‹ )', 'Gfresh')
        """

        # 2. ê³µì‚°ë°•ìŠ¤ ì¤‘ ì„œìš¸ ì£¼ì†Œ â†’ ì„œê³µë°•ìŠ¤
        update_query_2 = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ì„œê³µë°•ìŠ¤'
        WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ê³µì‚°ë°•ìŠ¤'
          AND SUBSTRING(
                TRIM(SUBSTRING_INDEX(ì£¼ì†Œ, ']', -1)), 1, 2
              ) = 'ì„œìš¸'
          AND ì‡¼í•‘ëª° IN ('Cafe24(ì‹ )', 'Gfresh')
        """

        cursor.execute(update_query_1)
        cursor.execute(update_query_2)
        connection.commit()
        print("ì†¡ì¥êµ¬ë¶„ìµœì¢… ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ ì™„ë£Œ âœ…")

finally:
    connection.close()


import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# ì—°ê²°
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ê³µì‚°ë°•ìŠ¤ ì¤‘ ì„œìš¸ ì£¼ì†Œ â†’ ì„œê³µë°•ìŠ¤
        update_query = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤
        SET ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ì„œê³µë°•ìŠ¤'
        WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ê³µì‚°ë°•ìŠ¤'
          AND SUBSTRING(
                TRIM(SUBSTRING_INDEX(ì£¼ì†Œ, ']', -1)), 1, 2
              ) = 'ì„œìš¸'
          AND ì‡¼í•‘ëª° IN ('Cafe24(ì‹ )', 'Gfresh')
        """

        cursor.execute(update_query)
        connection.commit()
        print("ì„œê³µë°•ìŠ¤ ì—…ë°ì´íŠ¸ ì™„ë£Œ âœ…")

finally:
    connection.close()


# ---. ì„œìš¸ê³µì‚°ë‚±ê°œ ë¶„ë¥˜
print("ì„œìš¸ê³µì‚°ë‚±ê°œ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³€í™˜ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³€í™˜"
        cursor.execute(sql_truncate)

        # ì„œìš¸ê³µì‚° ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³€í™˜ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ì„œê³µë‚±ê°œ'
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì„œìš¸ê³µì‚°ë‚±ê°œ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)




# ---. íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸
print("íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰ì„ ì´ìš©í•˜ì—¬ 1ì„ ë‚˜ëˆˆ ê²°ê³¼ë¥¼ ì†Œìˆ˜ì  ì„¸ ìë¦¬ì—ì„œ ë‚´ë¦¼í•˜ì—¬ ì†¡ì¥êµ¬ë¶„ì ì»¬ëŸ¼ì— ì—…ë°ì´íŠ¸
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ì = FLOOR((1 / IFNULL(NULLIF(íƒë°°ìˆ˜ëŸ‰, 0), 10)) * 1000) / 1000
        """
        cursor.execute(sql_update)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ë")
# --ë


import time

time.sleep(1)



# ---. ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸
print("ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ì„ ê³±í•˜ì—¬ ê²°ê³¼ ì—…ë°ì´íŠ¸
        sql_multiply_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ì = ì†¡ì¥êµ¬ë¶„ì * ìˆ˜ëŸ‰
        """
        cursor.execute(sql_multiply_update)
        connection.commit()

        print(f"ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ì™„ë£Œ, {cursor.rowcount} í–‰ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸ ë")
# --ë


import time

time.sleep(1)



# ---. ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ë° íƒë°°ìˆ˜ëŸ‰1 ì—…ë°ì´íŠ¸
print("ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª…ì„ ê¸°ì¤€ìœ¼ë¡œ ì†¡ì¥êµ¬ë¶„ìë¥¼ í•©ì‚°
        sql_group_sum = """
        SELECT ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…, SUM(ì†¡ì¥êµ¬ë¶„ì) AS êµ¬ë¶„ìí•©
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³€í™˜
        GROUP BY ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
        """
        cursor.execute(sql_group_sum)
        results = cursor.fetchall()

        # ê° ê·¸ë£¹ì˜ êµ¬ë¶„ìí•©ì„ íƒë°°ìˆ˜ëŸ‰1ì— ì—…ë°ì´íŠ¸
        for result in results:
            sql_update = """
            UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³€í™˜
            SET íƒë°°ìˆ˜ëŸ‰1 = %s
            WHERE ì£¼ì†Œ = %s AND ìˆ˜ì·¨ì¸ëª… = %s
            """
            cursor.execute(sql_update, (result['êµ¬ë¶„ìí•©'], result['ì£¼ì†Œ'], result['ìˆ˜ì·¨ì¸ëª…']))

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"Updated {cursor.rowcount} rows based on address and recipient name.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ë° íƒë°°ìˆ˜ëŸ‰1 ì—…ë°ì´íŠ¸ ë")
# --ë

import time

time.sleep(1)




print("íƒë°°ìˆ˜ëŸ‰1 ì˜¬ë¦¼ ì²˜ë¦¬ ì‹œì‘")
import pymysql
import math

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰1ì˜ í˜„ì¬ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        sql_fetch = "SELECT id, íƒë°°ìˆ˜ëŸ‰1 FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³€í™˜"
        cursor.execute(sql_fetch)
        results = cursor.fetchall()

        updated_rows = 0  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ë¥¼ ì¶”ì 
        # ê° í–‰ì˜ íƒë°°ìˆ˜ëŸ‰1 ê°’ì„ ì˜¬ë¦¼ ì²˜ë¦¬í•˜ê³  ì—…ë°ì´íŠ¸ í•©ë‹ˆë‹¤.
        for result in results:
            current_quantity = result['íƒë°°ìˆ˜ëŸ‰1']
            if current_quantity is None:  # íƒë°°ìˆ˜ëŸ‰1ì´ Noneì¼ ë•Œ ì²˜ë¦¬
                current_quantity = 1  # None ê°’ì„ 30ìœ¼ë¡œ ì„¤ì •
            
            rounded_quantity = math.ceil(float(current_quantity))  # íƒë°°ìˆ˜ëŸ‰1 ê°’ì„ ì˜¬ë¦¼
            sql_update = "UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³€í™˜ SET íƒë°°ìˆ˜ëŸ‰1 = %s WHERE id = %s"
            cursor.execute(sql_update, (rounded_quantity, result['id']))
            updated_rows += cursor.rowcount

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜: {updated_rows}")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("íƒë°°ìˆ˜ëŸ‰1 ì˜¬ë¦¼ ì²˜ë¦¬ ì™„ë£Œ")
# --ë


import time

time.sleep(1)




# ---. íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸
print("íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰1ì´ 1ë³´ë‹¤ í° ê²½ìš° 'ì¶”ê°€'ë¡œ ì—…ë°ì´íŠ¸
        update_more_than_one = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ = 'ì¶”ê°€'
        WHERE íƒë°°ìˆ˜ëŸ‰1 > 1
        """
        cursor.execute(update_more_than_one)
        
        # íƒë°°ìˆ˜ëŸ‰1ì´ 1 ì´í•˜ì¸ ê²½ìš° '1ì¥'ìœ¼ë¡œ ì—…ë°ì´íŠ¸
        update_one_or_less = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        WHERE íƒë°°ìˆ˜ëŸ‰1 <= 1
        """
        cursor.execute(update_one_or_less)
        
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated rows for more than one: {cursor.rowcount}")  # 'ì¶”ê°€'ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥
        print(f"Updated rows for one or less: {cursor.rowcount}")  # '1ì¥'ìœ¼ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‘ì—… ë")
# ---ë

import time

time.sleep(1)



# ---. ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸
print("ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ì¡°í•©ì´ ìœ ì¼í•œ ê²½ìš° 'ë‹¨ì¼'ë¡œ ì—…ë°ì´íŠ¸
        update_unique_address_and_name = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³€í™˜ t1
        JOIN (
            SELECT ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
            FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³€í™˜
            WHERE ì†¡ì¥êµ¬ë¶„ = '1ì¥'
            GROUP BY ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
            HAVING COUNT(*) = 1
        ) AS unique_address ON t1.ì£¼ì†Œ = unique_address.ì£¼ì†Œ AND t1.ìˆ˜ì·¨ì¸ëª… = unique_address.ìˆ˜ì·¨ì¸ëª…
        SET t1.ì†¡ì¥êµ¬ë¶„ = 'ë‹¨ì¼'
        WHERE t1.ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        """
        cursor.execute(update_unique_address_and_name)

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated unique address and name rows to 'ë‹¨ì¼': {cursor.rowcount}")  # 'ë‹¨ì¼'ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‘ì—… ë")
# ---ë



# ---. ì„œìš¸ê³µì‚°1ì¥ ë¶„ë¥˜
print("ì„œìš¸ê³µì‚°1ì¥ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°1ì¥ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°1ì¥"
        cursor.execute(sql_truncate)

        # ì„œìš¸ê³µì‚° ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°1ì¥ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        ORDER BY ìœ„ì¹˜ë³€í™˜ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì„œìš¸ê³µì‚°1ì¥ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)


# ---. ì„œìš¸ê³µì‚°ë‹¨ì¼ ë¶„ë¥˜
print("ì„œìš¸ê³µì‚°ë‹¨ì¼ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë‹¨ì¼ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë‹¨ì¼"
        cursor.execute(sql_truncate)

        # ì„œìš¸ê³µì‚° ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë‹¨ì¼ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = 'ë‹¨ì¼'
        ORDER BY ìœ„ì¹˜ë³€í™˜ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì„œìš¸ê³µì‚°ë‹¨ì¼ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)

# ---. í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜
print("í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # í’ˆëª©ì½”ë“œë³„ë¡œ ìˆ˜ëŸ‰ì„ í•©ì‚°í•˜ì—¬ ì¶œë ¥ê°œìˆ˜ì— ì—…ë°ì´íŠ¸
        sql_update_output_count = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë‹¨ì¼ AS t1 
        INNER JOIN (
            SELECT í’ˆëª©ì½”ë“œ, SUM(ìˆ˜ëŸ‰) AS total_quantity
            FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë‹¨ì¼
            GROUP BY í’ˆëª©ì½”ë“œ
        ) AS t2 ON t1.í’ˆëª©ì½”ë“œ = t2.í’ˆëª©ì½”ë“œ
        SET t1.í’ˆëª©ê°œìˆ˜ = t2.total_quantity
        """
        cursor.execute(sql_update_output_count)

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜ ì‘ì—… ë")
# ---ë

import time

time.sleep(1)

# ---. ì„œìš¸ê³µì‚°ì¶”ê°€ ë¶„ë¥˜
print("ì„œìš¸ê³µì‚°ì¶”ê°€ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€"
        cursor.execute(sql_truncate)

        # ì„œìš¸ê³µì‚° ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = 'ì¶”ê°€'
        ORDER BY ì£¼ì†Œ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì„œìš¸ê³µì‚°ì¶”ê°€ ë¶„ë¥˜ ë")
# --ë


import time

time.sleep(1)




# ---. ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™
print("ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥"
        cursor.execute(sql_truncate)

        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€ í…Œì´ë¸”ì—ì„œ ìœ ë‹ˆí¬í•œ ì£¼ì†Œë¥¼ ê°€ì§„ í–‰ì„ ì„ íƒí•˜ì—¬ ì´ë™
        sql_insert_unique = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM (
            SELECT *, ROW_NUMBER() OVER (PARTITION BY ì£¼ì†Œ ORDER BY id ASC) AS rn
            FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€
        ) AS subquery
        WHERE subquery.rn = 1
        """
        cursor.execute(sql_insert_unique)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™ ë")
# --ë


import time

time.sleep(1)




# ---. ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸
print("ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ëª¨ë“  'ìˆ˜ëŸ‰'ì„ 1ë¡œ ë³€ê²½í•˜ê³  'ì†¡ì¥ëª…'ì„ "ì¶”ê°€ì†¡ì¥"ìœ¼ë¡œ ë³€ê²½
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥
        SET ìˆ˜ëŸ‰ = 1, ì†¡ì¥ëª… = '+++', ì˜µì…˜ëª… = '+++' , í’ˆëª©ì½”ë“œ = '0000'
        """
        cursor.execute(sql_update)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print(f"Updated {cursor.rowcount} rows in ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥.")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸ ì™„ë£Œ")
# --ë

import time

time.sleep(1)



# ---. ì„œìš¸ê³µì‚° ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° 
print("ì„œìš¸ê³µì‚° ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ë¨¼ì € ëª¨ë“  í–‰ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        sql_select = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ WHERE íƒë°°ìˆ˜ëŸ‰1 > 2"
        cursor.execute(sql_select)
        rows = cursor.fetchall()

        # ê° í–‰ì„ 'íƒë°°ìˆ˜ëŸ‰1 - 2' ë§Œí¼ ë³µì‚¬í•˜ì—¬ ì‚½ì…í•©ë‹ˆë‹¤.
        for row in rows:
            count = int(row['íƒë°°ìˆ˜ëŸ‰1']) - 2  # ì¶”ê°€í•  í–‰ì˜ ìˆ˜
            sql_insert = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥
            (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
            """
            params = (row['msg1'], row['msg2'], row['msg3'], row['msg4'], row['msg5'], row['msg6'], row['ìˆ˜ì·¨ì¸ëª…'], row['ì „í™”ë²ˆí˜¸1'], row['ì „í™”ë²ˆí˜¸2'], row['ìš°í¸ë²ˆí˜¸'], row['ì£¼ì†Œ'], row['ì˜µì…˜ëª…'], row['ìˆ˜ëŸ‰'], row['ë°°ì†¡ë©”ì„¸ì§€'], row['ì£¼ë¬¸ë²ˆí˜¸'], row['ì‡¼í•‘ëª°'], row['ìˆ˜ì§‘ì‹œê°„'], row['ì†¡ì¥ëª…'], row['í’ˆëª©ì½”ë“œ'], row['íƒë°°ë¹„ìš©'], row['ë°•ìŠ¤í¬ê¸°'], row['ì¶œë ¥ê°œìˆ˜'], row['ì†¡ì¥ìˆ˜ëŸ‰'], row['ë³„í‘œ1'], row['ë³„í‘œ2'], row['í’ˆëª©ê°œìˆ˜'], row['íƒë°°ìˆ˜ëŸ‰'], row['íƒë°°ìˆ˜ëŸ‰1'], row['íƒë°°ìˆ˜ëŸ‰í•©ì‚°'], row['ì†¡ì¥êµ¬ë¶„ì'], row['ì†¡ì¥êµ¬ë¶„'], row['ì†¡ì¥êµ¬ë¶„ìµœì¢…'], row['ìœ„ì¹˜'], row['ìœ„ì¹˜ë³€í™˜'])
            for _ in range(count):
                cursor.execute(sql_insert, params)

    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì„œìš¸ê³µì‚° ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° ë")
# --ë

import time

time.sleep(1)


# ---. ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸°
print("ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸° ì‹œì‘")
# --ì‹œì‘

import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor  # ê²°ê³¼ë¥¼ ë”•ì…”ë„ˆë¦¬ í˜•íƒœë¡œ ë°›ê¸° ìœ„í•¨
)

try:
    with conn.cursor() as cursor:
        # ìœ„ì¹˜ë³€í™˜ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ëª¨ë“  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´
        sql = "SELECT id, ìœ„ì¹˜ë³€í™˜ FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ ORDER BY ìœ„ì¹˜ë³€í™˜, id"
        cursor.execute(sql)
        results = cursor.fetchall()

        # í˜„ì¬ ìœ„ì¹˜ë³€í™˜ ê°’
        current_location = None
        counter = 1

        # ê²°ê³¼ë¥¼ ìˆœíšŒí•˜ë©´ì„œ ìˆœë²ˆì„ ë§¤ê¹€
        for row in results:
            if current_location != row['ìœ„ì¹˜ë³€í™˜']:
                current_location = row['ìœ„ì¹˜ë³€í™˜']
                counter = 1  # ìœ„ì¹˜ë³€í™˜ ê°’ì´ ë°”ë€Œë©´ ìˆœë²ˆì„ ë¦¬ì…‹
            
            # ì†¡ì¥êµ¬ë¶„ì ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ (ì¤‘ê´„í˜¸ í˜•ì‹ìœ¼ë¡œ)
            formatted_number = f"[{counter}]"  # ìˆ«ì ì•ë’¤ë¡œ ëŒ€ê´„í˜¸ ì¶”ê°€
            update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ SET ì†¡ì¥êµ¬ë¶„ì=%s WHERE id=%s"
            cursor.execute(update_sql, (formatted_number, row['id']))
            counter += 1

        conn.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

finally:
    conn.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

# ---. ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸°
print("ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸° ë")
# --ë

import time

time.sleep(1)


# ---. ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸
print("ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸ ì‹œì‘")
# --ì‹œì‘


import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with conn.cursor() as cursor:
        # 'ì£¼ì†Œ' ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ ì¿¼ë¦¬ ì‹¤í–‰
        update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ SET ì£¼ì†Œ = CONCAT(ì£¼ì†Œ, ì†¡ì¥êµ¬ë¶„ì)"
        cursor.execute(update_sql)
        conn.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    conn.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ


# ---. ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸
print("ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸ ë")
# --ë

import time

time.sleep(1)


import pymysql
import pymysql.cursors

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # í…Œì´ë¸”ì„ ë¹„ì›ë‹ˆë‹¤.
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€í•©ì¹˜ê¸°")
        
        # ë°ì´í„° ë³‘í•© ë° ì‚½ì… ì¿¼ë¦¬
        merge_and_insert_query = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€í•©ì¹˜ê¸°(msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM (
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€
            UNION ALL
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€ì†¡ì¥
        ) AS combined
        ORDER BY ìœ„ì¹˜ DESC
        """
        cursor.execute(merge_and_insert_query)
        
        # ë³€ê²½ ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— í™•ì •í•©ë‹ˆë‹¤.
        connection.commit()

finally:
    # ì—°ê²°ì„ ë‹«ìŠµë‹ˆë‹¤.
    connection.close()


import time

time.sleep(1)



# ---. ì„œìš¸ê³µì‚° í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬
print("ì„œìš¸ê³µì‚° í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬ ì‹œì‘")
# --ì‹œì‘


import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚° í…Œì´ë¸” ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°")
        
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë‹¨ì¼ í…Œì´ë¸”ì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ì„œ ì •ë ¬ í›„ ì‚½ì…
        sql_insert_from_single = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚° (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë‹¨ì¼
        ORDER BY ìœ„ì¹˜ë³€í™˜ ASC
        """
        cursor.execute(sql_insert_from_single)

        # ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤ í…Œì´ë¸”ì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ì„œ ì •ë ¬ í›„ ì‚½ì…
        sql_insert_from_box = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚° (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
            SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
            FROM ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤
            WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ì„œê³µë°•ìŠ¤'
            ORDER BY ìœ„ì¹˜ë³€í™˜ ASC
        """
        cursor.execute(sql_insert_from_box)




        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°1ì¥ í…Œì´ë¸”ì˜ ë°ì´í„°ë„ ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì— ì¶”ê°€
        sql_insert_from_one = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚° (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°1ì¥
        """
        cursor.execute(sql_insert_from_one)

        # ë‘ í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ í•©ì¹˜ê³ , ID ì»¬ëŸ¼ì„ ì œì™¸í•œ í›„ ì •ë ¬í•˜ì—¬ ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì— ì‚½ì…
        sql_merge_and_sort = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚° (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì¶”ê°€í•©ì¹˜ê¸°
        ORDER BY ì£¼ì†Œ ASC
        """
        cursor.execute(sql_merge_and_sort)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()


# ---. ì„œìš¸ê³µì‚° í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬
print("ì„œìš¸ê³µì‚° í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬ ë")
# --ë

import time

time.sleep(1)


# ---. ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‘ì—…
print("ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³„í‘œ í…Œì´ë¸”ì„ ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³„í‘œ")
        print("ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³„í‘œ í…Œì´ë¸”ì´ ë¹„ì›Œì¡ŒìŠµë‹ˆë‹¤.")

        # ë³„í‘œ1 ë˜ëŠ” ë³„í‘œ2ê°€ ë¹„ì–´ìˆì§€ ì•Šì€ í–‰ì„ ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³„í‘œ í…Œì´ë¸”ë¡œ ì´ë™
        sql_move_to_star_table = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³„í‘œ
        SELECT * FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°
        WHERE ë³„í‘œ1 <> '' OR ë³„í‘œ2 <> ''
        """
        cursor.execute(sql_move_to_star_table)
        print(f"Moved {cursor.rowcount} rows to 'ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³„í‘œ'.")

        # ì´ë™ëœ í–‰ ì‚­ì œ
        sql_delete_moved_rows = """
        DELETE FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°
        WHERE ë³„í‘œ1 <> '' OR ë³„í‘œ2 <> ''
        """
        cursor.execute(sql_delete_moved_rows)
        print(f"Deleted {cursor.rowcount} rows from 'ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°'.")

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥


finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‘ì—… ì™„ë£Œ")
# ---ë


import time

time.sleep(1)


# ---. ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™
print("ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³„í‘œì—ì„œ ë³„í‘œ1ë¡œ ì •ë ¬í•˜ì—¬ ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì— ë°ì´í„° ì‚½ì…
        sql_transfer_data = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°
        (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ë³„í‘œ
        ORDER BY ì£¼ì†Œ ASC, ì˜µì…˜ëª… ASC
        """
        cursor.execute(sql_transfer_data)

        print(f"Rows moved: {cursor.rowcount}")  # ì´ë™ëœ í–‰ì˜ ìˆ˜ ì¶œë ¥

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™ ì‘ì—… ì™„ë£Œ")
# ---ë


import time

time.sleep(1)



# ---. ë°ì´í„° ì´ë™ ì‘ì—…
print("ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì—ì„œ ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°_ìµœì¢… í…Œì´ë¸”ì„ ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°_ìµœì¢…")

        # ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì—ì„œ ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™
        sql_transfer_data = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°_ìµœì¢…
            (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
             ì†¡ì¥ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, 
             ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
               ì†¡ì¥ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, 
               ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜
        FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°
        """
        cursor.execute(sql_transfer_data)
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Moved {cursor.rowcount} rows from 'ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°' to 'ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°_ìµœì¢…'.")

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°ì—ì„œ ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™ ì‘ì—… ì™„ë£Œ")
# ---ë

import time

time.sleep(1)

# ---. ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸
print("ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜ ì—…ë°ì´íŠ¸
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°_ìµœì¢…
        SET íƒë°°ë¹„ìš© = 2150, ë°•ìŠ¤í¬ê¸° = 'ê·¹ì†Œ', ì¶œë ¥ê°œìˆ˜ = 1
        """
        cursor.execute(sql_update)
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated {cursor.rowcount} rows in 'ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°_ìµœì¢…'.")

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì™„ë£Œ")
# ---ë

import time

time.sleep(1)

print("ì„œìš¸ê³µì‚°_ìµœì¢…íŒŒì¼ë§Œë“¤ê¸° ì‹œì‘")
# ---ì‹œì‘

import pandas as pd
import mysql.connector
from datetime import datetime
import dropbox
import requests

# ë°ì´í„°ë² ì´ìŠ¤ ë° ë°ì´í„° ì²˜ë¦¬ ì‹œì‘
connection = mysql.connector.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci'
)

cursor = connection.cursor()
query = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°_ìµœì¢…"
cursor.execute(query)
result = cursor.fetchall()
columns = cursor.column_names
df = pd.DataFrame(result, columns=columns)
unique_count = df.drop_duplicates(subset=['ì£¼ì†Œ', 'ìˆ˜ì·¨ì¸ëª…', 'ì „í™”ë²ˆí˜¸1']).shape[0]
connection.close()

# íŒŒì¼ ì €ì¥ ë° Dropbox ì—…ë¡œë“œ
now = datetime.now()
file_path = f'ì„œìš¸ê³µì‚°/ì„œìš¸ê³µì‚°_{now.strftime("%y%m%d_%Hì‹œ%Më¶„")}.xlsx'
df.to_excel(file_path, index=False, header=False)

refresh_token = '1CLvznLL7BwAAAAAAAAAAagAlVx3w9P6NGyYjsITAxrSG9vlAEc31ohZZwYhUAB_'
app_key = 'vlxh3ec9nq5fi5t'
app_secret = 'h5rp5n0w9cp4ifk'
token_url = "https://api.dropbox.com/oauth2/token"
params = {
    'refresh_token': refresh_token,
    'grant_type': 'refresh_token',
    'client_id': app_key,
    'client_secret': app_secret
}
response = requests.post(token_url, data=params)
access_token = response.json().get('access_token')

dbx = dropbox.Dropbox(access_token)
with open(file_path, "rb") as f:
    dbx.files_upload(f.read(), f'/ì„œìš¸ê³µì‚°/{file_path}', mode=dropbox.files.WriteMode("overwrite"))
shared_link_metadata = dbx.sharing_create_shared_link_with_settings(f'/ì„œìš¸ê³µì‚°/{file_path}')

# ì‹œê°„ëŒ€ë³„ ì°¨ìˆ˜ ì„¤ì •
hour = now.hour
minute = now.minute

if 1 <= hour <= 7:
    batch = "1ì°¨"
elif 8 <= hour <= 10:
    batch = "2ì°¨"
elif 11 <= hour <= 11:
    batch = "3ì°¨"
elif 12 <= hour <= 13:
    batch = "4ì°¨"
elif 14 <= hour <= 15:
    batch = "5ì°¨"
elif 16 <= hour <= 18:
    batch = "ë§‰ì°¨"
elif 19 <= hour <= 23:
    batch = "ì¶”ê°€"
else:
    batch = ""  # 24ì‹œ(0ì‹œ)ëŠ” ë°°ì¹˜ ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ


import time

time.sleep(1)

# ì¹´ì¹´ì˜¤ì›Œí¬ ë©”ì‹œì§€ ì „ì†¡
app_key = 'b36ed46e.0b55706350e94ef8b49e8647a97ae1b7'
chatroom_id = '9483028'
time_string = now.strftime("%mì›” %dì¼ %Hì‹œ %Më¶„")

def send_kakao_work_message(app_key, chatroom_id, file_url, batch):
    url = "https://api.kakaowork.com/v1/messages.send"
    headers = {
        "Authorization": f"Bearer {app_key}",
        "Content-Type": "application/json"
    }
    data = {
        "conversation_id": chatroom_id,
        "text": f"{batch} - ì„œìš¸ê³µì‚° ìš´ì†¡ì¥ ìˆ˜ì§‘ ì™„ë£Œ",
        "blocks": [
            {
                "type": "header",
                "text": f"{batch} - ì„œìš¸ê³µì‚° ìš´ì†¡ì¥ ìˆ˜ì§‘ ì™„ë£Œ",
                "style": "blue"
            },
            {
                "type": "text",
                "text": "ì•„ë˜ ë§í¬ì—ì„œ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”!",
                "markdown": True
            },
            {
                "type": "button",
                "text": "íŒŒì¼ ë‹¤ìš´ë¡œë“œ",
                "style": "default",
                "action_type": "open_system_browser",
                "value": file_url
            },
            {
                "type": "divider"
            },
            {
                "type": "text",
                "text": f"*ì†¡ì¥ ê°œìˆ˜:* {unique_count}ê±´",
                "markdown": True
            },
            {
                "type": "divider"
            },
            {
                "type": "text",
                "text": "*ì†¡ì¥ë„˜ê¸°ê¸°*\nì•„ì´ë””: `gram`\në¹„ë²ˆ: `3535`\n[ğŸ‘‰ ì†¡ì¥ ê´€ë¦¬ í˜ì´ì§€ ë°”ë¡œê°€ê¸°](https://gramwon.me/orders/transfer)",
                "markdown": True
            },
            {
                "type": "divider"
            },
        ]
    }
    response = requests.post(url, headers=headers, json=data)
    return response.json()

result = send_kakao_work_message(app_key, chatroom_id, shared_link_metadata.url, batch)
print(result)



# ---. ê²½ê¸°ê³µì‚°ë‚±ê°œ ë¶„ë¥˜
print("ê²½ê¸°ê³µì‚°ë‚±ê°œ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³€í™˜ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³€í™˜"
        cursor.execute(sql_truncate)

        # ê²½ê¸°ê³µì‚° ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³€í™˜ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ê³µì‚°ë‚±ê°œ'
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê²½ê¸°ê³µì‚°ë‚±ê°œ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)




# ---. íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸
print("íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰ì„ ì´ìš©í•˜ì—¬ 1ì„ ë‚˜ëˆˆ ê²°ê³¼ë¥¼ ì†Œìˆ˜ì  ì„¸ ìë¦¬ì—ì„œ ë‚´ë¦¼í•˜ì—¬ ì†¡ì¥êµ¬ë¶„ì ì»¬ëŸ¼ì— ì—…ë°ì´íŠ¸
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ì = FLOOR((1 / IFNULL(NULLIF(íƒë°°ìˆ˜ëŸ‰, 0), 10)) * 1000) / 1000
        """
        cursor.execute(sql_update)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ë")
# --ë


import time

time.sleep(1)



# ---. ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸
print("ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ì„ ê³±í•˜ì—¬ ê²°ê³¼ ì—…ë°ì´íŠ¸
        sql_multiply_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ì = ì†¡ì¥êµ¬ë¶„ì * ìˆ˜ëŸ‰
        """
        cursor.execute(sql_multiply_update)
        connection.commit()

        print(f"ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ì™„ë£Œ, {cursor.rowcount} í–‰ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸ ë")
# --ë


import time

time.sleep(1)



# ---. ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ë° íƒë°°ìˆ˜ëŸ‰1 ì—…ë°ì´íŠ¸
print("ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª…ì„ ê¸°ì¤€ìœ¼ë¡œ ì†¡ì¥êµ¬ë¶„ìë¥¼ í•©ì‚°
        sql_group_sum = """
        SELECT ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…, SUM(ì†¡ì¥êµ¬ë¶„ì) AS êµ¬ë¶„ìí•©
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³€í™˜
        GROUP BY ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
        """
        cursor.execute(sql_group_sum)
        results = cursor.fetchall()

        # ê° ê·¸ë£¹ì˜ êµ¬ë¶„ìí•©ì„ íƒë°°ìˆ˜ëŸ‰1ì— ì—…ë°ì´íŠ¸
        for result in results:
            sql_update = """
            UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³€í™˜
            SET íƒë°°ìˆ˜ëŸ‰1 = %s
            WHERE ì£¼ì†Œ = %s AND ìˆ˜ì·¨ì¸ëª… = %s
            """
            cursor.execute(sql_update, (result['êµ¬ë¶„ìí•©'], result['ì£¼ì†Œ'], result['ìˆ˜ì·¨ì¸ëª…']))

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"Updated {cursor.rowcount} rows based on address and recipient name.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ë° íƒë°°ìˆ˜ëŸ‰1 ì—…ë°ì´íŠ¸ ë")
# --ë

import time

time.sleep(1)




print("íƒë°°ìˆ˜ëŸ‰1 ì˜¬ë¦¼ ì²˜ë¦¬ ì‹œì‘")
import pymysql
import math

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰1ì˜ í˜„ì¬ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        sql_fetch = "SELECT id, íƒë°°ìˆ˜ëŸ‰1 FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³€í™˜"
        cursor.execute(sql_fetch)
        results = cursor.fetchall()

        updated_rows = 0  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ë¥¼ ì¶”ì 
        # ê° í–‰ì˜ íƒë°°ìˆ˜ëŸ‰1 ê°’ì„ ì˜¬ë¦¼ ì²˜ë¦¬í•˜ê³  ì—…ë°ì´íŠ¸ í•©ë‹ˆë‹¤.
        for result in results:
            current_quantity = result['íƒë°°ìˆ˜ëŸ‰1']
            if current_quantity is None:  # íƒë°°ìˆ˜ëŸ‰1ì´ Noneì¼ ë•Œ ì²˜ë¦¬
                current_quantity = 1  # None ê°’ì„ 30ìœ¼ë¡œ ì„¤ì •
            
            rounded_quantity = math.ceil(float(current_quantity))  # íƒë°°ìˆ˜ëŸ‰1 ê°’ì„ ì˜¬ë¦¼
            sql_update = "UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³€í™˜ SET íƒë°°ìˆ˜ëŸ‰1 = %s WHERE id = %s"
            cursor.execute(sql_update, (rounded_quantity, result['id']))
            updated_rows += cursor.rowcount

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜: {updated_rows}")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("íƒë°°ìˆ˜ëŸ‰1 ì˜¬ë¦¼ ì²˜ë¦¬ ì™„ë£Œ")
# --ë


import time

time.sleep(1)




# ---. íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸
print("íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰1ì´ 1ë³´ë‹¤ í° ê²½ìš° 'ì¶”ê°€'ë¡œ ì—…ë°ì´íŠ¸
        update_more_than_one = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ = 'ì¶”ê°€'
        WHERE íƒë°°ìˆ˜ëŸ‰1 > 1
        """
        cursor.execute(update_more_than_one)
        
        # íƒë°°ìˆ˜ëŸ‰1ì´ 1 ì´í•˜ì¸ ê²½ìš° '1ì¥'ìœ¼ë¡œ ì—…ë°ì´íŠ¸
        update_one_or_less = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        WHERE íƒë°°ìˆ˜ëŸ‰1 <= 1
        """
        cursor.execute(update_one_or_less)
        
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated rows for more than one: {cursor.rowcount}")  # 'ì¶”ê°€'ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥
        print(f"Updated rows for one or less: {cursor.rowcount}")  # '1ì¥'ìœ¼ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‘ì—… ë")
# ---ë

import time

time.sleep(1)



# ---. ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸
print("ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ì¡°í•©ì´ ìœ ì¼í•œ ê²½ìš° 'ë‹¨ì¼'ë¡œ ì—…ë°ì´íŠ¸
        update_unique_address_and_name = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³€í™˜ t1
        JOIN (
            SELECT ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
            FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³€í™˜
            WHERE ì†¡ì¥êµ¬ë¶„ = '1ì¥'
            GROUP BY ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
            HAVING COUNT(*) = 1
        ) AS unique_address ON t1.ì£¼ì†Œ = unique_address.ì£¼ì†Œ AND t1.ìˆ˜ì·¨ì¸ëª… = unique_address.ìˆ˜ì·¨ì¸ëª…
        SET t1.ì†¡ì¥êµ¬ë¶„ = 'ë‹¨ì¼'
        WHERE t1.ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        """
        cursor.execute(update_unique_address_and_name)

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated unique address and name rows to 'ë‹¨ì¼': {cursor.rowcount}")  # 'ë‹¨ì¼'ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‘ì—… ë")
# ---ë



# ---. ê²½ê¸°ê³µì‚°1ì¥ ë¶„ë¥˜
print("ê²½ê¸°ê³µì‚°1ì¥ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°1ì¥ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°1ì¥"
        cursor.execute(sql_truncate)

        # ê²½ê¸°ê³µì‚° ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°1ì¥ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        ORDER BY ìœ„ì¹˜ë³€í™˜ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê²½ê¸°ê³µì‚°1ì¥ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)


# ---. ê²½ê¸°ê³µì‚°ë‹¨ì¼ ë¶„ë¥˜
print("ê²½ê¸°ê³µì‚°ë‹¨ì¼ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë‹¨ì¼ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë‹¨ì¼"
        cursor.execute(sql_truncate)

        # ê²½ê¸°ê³µì‚° ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë‹¨ì¼ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = 'ë‹¨ì¼'
        ORDER BY ìœ„ì¹˜ë³€í™˜ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê²½ê¸°ê³µì‚°ë‹¨ì¼ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)

# ---. í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜
print("í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # í’ˆëª©ì½”ë“œë³„ë¡œ ìˆ˜ëŸ‰ì„ í•©ì‚°í•˜ì—¬ ì¶œë ¥ê°œìˆ˜ì— ì—…ë°ì´íŠ¸
        sql_update_output_count = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë‹¨ì¼ AS t1 
        INNER JOIN (
            SELECT í’ˆëª©ì½”ë“œ, SUM(ìˆ˜ëŸ‰) AS total_quantity
            FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë‹¨ì¼
            GROUP BY í’ˆëª©ì½”ë“œ
        ) AS t2 ON t1.í’ˆëª©ì½”ë“œ = t2.í’ˆëª©ì½”ë“œ
        SET t1.í’ˆëª©ê°œìˆ˜ = t2.total_quantity
        """
        cursor.execute(sql_update_output_count)

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜ ì‘ì—… ë")
# ---ë

import time

time.sleep(1)

# ---. ê²½ê¸°ê³µì‚°ì¶”ê°€ ë¶„ë¥˜
print("ê²½ê¸°ê³µì‚°ì¶”ê°€ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€"
        cursor.execute(sql_truncate)

        # ê²½ê¸°ê³µì‚° ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = 'ì¶”ê°€'
        ORDER BY ì£¼ì†Œ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê²½ê¸°ê³µì‚°ì¶”ê°€ ë¶„ë¥˜ ë")
# --ë


import time

time.sleep(1)




# ---. ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™
print("ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥"
        cursor.execute(sql_truncate)

        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€ í…Œì´ë¸”ì—ì„œ ìœ ë‹ˆí¬í•œ ì£¼ì†Œë¥¼ ê°€ì§„ í–‰ì„ ì„ íƒí•˜ì—¬ ì´ë™
        sql_insert_unique = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM (
            SELECT *, ROW_NUMBER() OVER (PARTITION BY ì£¼ì†Œ ORDER BY id ASC) AS rn
            FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€
        ) AS subquery
        WHERE subquery.rn = 1
        """
        cursor.execute(sql_insert_unique)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™ ë")
# --ë


import time

time.sleep(1)




# ---. ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸
print("ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ëª¨ë“  'ìˆ˜ëŸ‰'ì„ 1ë¡œ ë³€ê²½í•˜ê³  'ì†¡ì¥ëª…'ì„ "ì¶”ê°€ì†¡ì¥"ìœ¼ë¡œ ë³€ê²½
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥
        SET ìˆ˜ëŸ‰ = 1, ì†¡ì¥ëª… = '+++', ì˜µì…˜ëª… = '+++' , í’ˆëª©ì½”ë“œ = '0000'
        """
        cursor.execute(sql_update)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print(f"Updated {cursor.rowcount} rows in ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥.")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸ ì™„ë£Œ")
# --ë

import time

time.sleep(1)



# ---. ê²½ê¸°ê³µì‚° ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° 
print("ê²½ê¸°ê³µì‚° ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ë¨¼ì € ëª¨ë“  í–‰ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        sql_select = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ WHERE íƒë°°ìˆ˜ëŸ‰1 > 2"
        cursor.execute(sql_select)
        rows = cursor.fetchall()

        # ê° í–‰ì„ 'íƒë°°ìˆ˜ëŸ‰1 - 2' ë§Œí¼ ë³µì‚¬í•˜ì—¬ ì‚½ì…í•©ë‹ˆë‹¤.
        for row in rows:
            count = int(row['íƒë°°ìˆ˜ëŸ‰1']) - 2  # ì¶”ê°€í•  í–‰ì˜ ìˆ˜
            sql_insert = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥
            (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
            """
            params = (row['msg1'], row['msg2'], row['msg3'], row['msg4'], row['msg5'], row['msg6'], row['ìˆ˜ì·¨ì¸ëª…'], row['ì „í™”ë²ˆí˜¸1'], row['ì „í™”ë²ˆí˜¸2'], row['ìš°í¸ë²ˆí˜¸'], row['ì£¼ì†Œ'], row['ì˜µì…˜ëª…'], row['ìˆ˜ëŸ‰'], row['ë°°ì†¡ë©”ì„¸ì§€'], row['ì£¼ë¬¸ë²ˆí˜¸'], row['ì‡¼í•‘ëª°'], row['ìˆ˜ì§‘ì‹œê°„'], row['ì†¡ì¥ëª…'], row['í’ˆëª©ì½”ë“œ'], row['íƒë°°ë¹„ìš©'], row['ë°•ìŠ¤í¬ê¸°'], row['ì¶œë ¥ê°œìˆ˜'], row['ì†¡ì¥ìˆ˜ëŸ‰'], row['ë³„í‘œ1'], row['ë³„í‘œ2'], row['í’ˆëª©ê°œìˆ˜'], row['íƒë°°ìˆ˜ëŸ‰'], row['íƒë°°ìˆ˜ëŸ‰1'], row['íƒë°°ìˆ˜ëŸ‰í•©ì‚°'], row['ì†¡ì¥êµ¬ë¶„ì'], row['ì†¡ì¥êµ¬ë¶„'], row['ì†¡ì¥êµ¬ë¶„ìµœì¢…'], row['ìœ„ì¹˜'], row['ìœ„ì¹˜ë³€í™˜'])
            for _ in range(count):
                cursor.execute(sql_insert, params)

    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê²½ê¸°ê³µì‚° ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° ë")
# --ë

import time

time.sleep(1)


# ---. ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸°
print("ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸° ì‹œì‘")
# --ì‹œì‘

import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor  # ê²°ê³¼ë¥¼ ë”•ì…”ë„ˆë¦¬ í˜•íƒœë¡œ ë°›ê¸° ìœ„í•¨
)

try:
    with conn.cursor() as cursor:
        # ìœ„ì¹˜ë³€í™˜ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ëª¨ë“  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´
        sql = "SELECT id, ìœ„ì¹˜ë³€í™˜ FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ ORDER BY ìœ„ì¹˜ë³€í™˜, id"
        cursor.execute(sql)
        results = cursor.fetchall()

        # í˜„ì¬ ìœ„ì¹˜ë³€í™˜ ê°’
        current_location = None
        counter = 1

        # ê²°ê³¼ë¥¼ ìˆœíšŒí•˜ë©´ì„œ ìˆœë²ˆì„ ë§¤ê¹€
        for row in results:
            if current_location != row['ìœ„ì¹˜ë³€í™˜']:
                current_location = row['ìœ„ì¹˜ë³€í™˜']
                counter = 1  # ìœ„ì¹˜ë³€í™˜ ê°’ì´ ë°”ë€Œë©´ ìˆœë²ˆì„ ë¦¬ì…‹
            
            # ì†¡ì¥êµ¬ë¶„ì ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ (ì¤‘ê´„í˜¸ í˜•ì‹ìœ¼ë¡œ)
            formatted_number = f"[{counter}]"  # ìˆ«ì ì•ë’¤ë¡œ ëŒ€ê´„í˜¸ ì¶”ê°€
            update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ SET ì†¡ì¥êµ¬ë¶„ì=%s WHERE id=%s"
            cursor.execute(update_sql, (formatted_number, row['id']))
            counter += 1

        conn.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

finally:
    conn.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

# ---. ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸°
print("ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸° ë")
# --ë

import time

time.sleep(1)


# ---. ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸
print("ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸ ì‹œì‘")
# --ì‹œì‘


import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with conn.cursor() as cursor:
        # 'ì£¼ì†Œ' ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ ì¿¼ë¦¬ ì‹¤í–‰
        update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ SET ì£¼ì†Œ = CONCAT(ì£¼ì†Œ, ì†¡ì¥êµ¬ë¶„ì)"
        cursor.execute(update_sql)
        conn.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    conn.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ


# ---. ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸
print("ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸ ë")
# --ë

import time

time.sleep(1)



import pymysql
import pymysql.cursors

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # í…Œì´ë¸”ì„ ë¹„ì›ë‹ˆë‹¤.
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€í•©ì¹˜ê¸°")
        
        # ë°ì´í„° ë³‘í•© ë° ì‚½ì… ì¿¼ë¦¬
        merge_and_insert_query = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€í•©ì¹˜ê¸°(msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM (
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€
            UNION ALL
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€ì†¡ì¥
        ) AS combined
        ORDER BY ìœ„ì¹˜ DESC
        """
        cursor.execute(merge_and_insert_query)
        
        # ë³€ê²½ ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— í™•ì •í•©ë‹ˆë‹¤.
        connection.commit()

finally:
    # ì—°ê²°ì„ ë‹«ìŠµë‹ˆë‹¤.
    connection.close()

import time

time.sleep(1)



# ---. ê²½ê¸°ê³µì‚° í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬
print("ê²½ê¸°ê³µì‚° í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬ ì‹œì‘")
# --ì‹œì‘


import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚° í…Œì´ë¸” ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°")
        
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë‹¨ì¼ í…Œì´ë¸”ì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ì„œ ì •ë ¬ í›„ ì‚½ì…
        sql_insert_from_single = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚° (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë‹¨ì¼
        ORDER BY ìœ„ì¹˜ë³€í™˜ ASC
        """
        cursor.execute(sql_insert_from_single)

        # ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤ í…Œì´ë¸”ì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ì„œ ì •ë ¬ í›„ ì‚½ì…
        sql_insert_from_box = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚° (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
            SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
            FROM ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤
            WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ê³µì‚°ë°•ìŠ¤'
            ORDER BY ìœ„ì¹˜ë³€í™˜ ASC
        """
        cursor.execute(sql_insert_from_box)




        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°1ì¥ í…Œì´ë¸”ì˜ ë°ì´í„°ë„ ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì— ì¶”ê°€
        sql_insert_from_one = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚° (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°1ì¥
        """
        cursor.execute(sql_insert_from_one)

        # ë‘ í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ í•©ì¹˜ê³ , ID ì»¬ëŸ¼ì„ ì œì™¸í•œ í›„ ì •ë ¬í•˜ì—¬ ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì— ì‚½ì…
        sql_merge_and_sort = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚° (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì¶”ê°€í•©ì¹˜ê¸°
        ORDER BY ì£¼ì†Œ ASC
        """
        cursor.execute(sql_merge_and_sort)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()


# ---. ê²½ê¸°ê³µì‚° í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬
print("ê²½ê¸°ê³µì‚° í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬ ë")
# --ë

import time

time.sleep(1)


# ---. ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‘ì—…
print("ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³„í‘œ í…Œì´ë¸”ì„ ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³„í‘œ")
        print("ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³„í‘œ í…Œì´ë¸”ì´ ë¹„ì›Œì¡ŒìŠµë‹ˆë‹¤.")

        # ë³„í‘œ1 ë˜ëŠ” ë³„í‘œ2ê°€ ë¹„ì–´ìˆì§€ ì•Šì€ í–‰ì„ ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³„í‘œ í…Œì´ë¸”ë¡œ ì´ë™
        sql_move_to_star_table = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³„í‘œ
        SELECT * FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°
        WHERE ë³„í‘œ1 <> '' OR ë³„í‘œ2 <> ''
        """
        cursor.execute(sql_move_to_star_table)
        print(f"Moved {cursor.rowcount} rows to 'ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³„í‘œ'.")

        # ì´ë™ëœ í–‰ ì‚­ì œ
        sql_delete_moved_rows = """
        DELETE FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°
        WHERE ë³„í‘œ1 <> '' OR ë³„í‘œ2 <> ''
        """
        cursor.execute(sql_delete_moved_rows)
        print(f"Deleted {cursor.rowcount} rows from 'ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°'.")

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥


finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‘ì—… ì™„ë£Œ")
# ---ë


import time

time.sleep(1)


# ---. ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™
print("ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³„í‘œì—ì„œ ë³„í‘œ1ë¡œ ì •ë ¬í•˜ì—¬ ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì— ë°ì´í„° ì‚½ì…
        sql_transfer_data = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°
        (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ë³„í‘œ
        ORDER BY ì£¼ì†Œ ASC, ì˜µì…˜ëª… ASC
        """
        cursor.execute(sql_transfer_data)

        print(f"Rows moved: {cursor.rowcount}")  # ì´ë™ëœ í–‰ì˜ ìˆ˜ ì¶œë ¥

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™ ì‘ì—… ì™„ë£Œ")
# ---ë


import time

time.sleep(1)



# ---. ë°ì´í„° ì´ë™ ì‘ì—…
print("ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì—ì„œ ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°_ìµœì¢… í…Œì´ë¸”ì„ ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°_ìµœì¢…")

        # ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì—ì„œ ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™
        sql_transfer_data = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°_ìµœì¢…
            (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
             ì†¡ì¥ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, 
             ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
               ì†¡ì¥ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, 
               ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜
        FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°
        """
        cursor.execute(sql_transfer_data)
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Moved {cursor.rowcount} rows from 'ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°' to 'ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°_ìµœì¢…'.")

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°ì—ì„œ ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™ ì‘ì—… ì™„ë£Œ")
# ---ë

import time

time.sleep(1)

# ---. ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸
print("ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜ ì—…ë°ì´íŠ¸
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°_ìµœì¢…
        SET íƒë°°ë¹„ìš© = 2150, ë°•ìŠ¤í¬ê¸° = 'ê·¹ì†Œ', ì¶œë ¥ê°œìˆ˜ = 1
        """
        cursor.execute(sql_update)
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated {cursor.rowcount} rows in 'ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°_ìµœì¢…'.")

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì™„ë£Œ")
# ---ë

import time

time.sleep(5)

print("ê²½ê¸°ê³µì‚°_ìµœì¢…íŒŒì¼ë§Œë“¤ê¸° ì‹œì‘")
# ---ì‹œì‘

import pandas as pd
import mysql.connector
from datetime import datetime
import dropbox
import requests

# ë°ì´í„°ë² ì´ìŠ¤ ë° ë°ì´í„° ì²˜ë¦¬ ì‹œì‘
connection = mysql.connector.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci'
)

cursor = connection.cursor()
query = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°_ìµœì¢…"
cursor.execute(query)
result = cursor.fetchall()
columns = cursor.column_names
df = pd.DataFrame(result, columns=columns)
unique_count = df.drop_duplicates(subset=['ì£¼ì†Œ', 'ìˆ˜ì·¨ì¸ëª…', 'ì „í™”ë²ˆí˜¸1']).shape[0]
connection.close()

# íŒŒì¼ ì €ì¥ ë° Dropbox ì—…ë¡œë“œ
now = datetime.now()
file_path = f'ê²½ê¸°ê³µì‚°/ê²½ê¸°ê³µì‚°_{now.strftime("%y%m%d_%Hì‹œ%Më¶„")}.xlsx'
df.to_excel(file_path, index=False, header=False)

refresh_token = '1CLvznLL7BwAAAAAAAAAAagAlVx3w9P6NGyYjsITAxrSG9vlAEc31ohZZwYhUAB_'
app_key = 'vlxh3ec9nq5fi5t'
app_secret = 'h5rp5n0w9cp4ifk'
token_url = "https://api.dropbox.com/oauth2/token"
params = {
    'refresh_token': refresh_token,
    'grant_type': 'refresh_token',
    'client_id': app_key,
    'client_secret': app_secret
}
response = requests.post(token_url, data=params)
access_token = response.json().get('access_token')

dbx = dropbox.Dropbox(access_token)
with open(file_path, "rb") as f:
    dbx.files_upload(f.read(), f'/ê²½ê¸°ê³µì‚°/{file_path}', mode=dropbox.files.WriteMode("overwrite"))
shared_link_metadata = dbx.sharing_create_shared_link_with_settings(f'/ê²½ê¸°ê³µì‚°/{file_path}')

# ì‹œê°„ëŒ€ë³„ ì°¨ìˆ˜ ì„¤ì •
hour = now.hour
minute = now.minute

if 1 <= hour <= 7:
    batch = "1ì°¨"
elif 8 <= hour <= 10:
    batch = "2ì°¨"
elif 11 <= hour <= 11:
    batch = "3ì°¨"
elif 12 <= hour <= 13:
    batch = "4ì°¨"
elif 14 <= hour <= 15:
    batch = "5ì°¨"
elif 16 <= hour <= 18:
    batch = "ë§‰ì°¨"
elif 19 <= hour <= 23:
    batch = "ì¶”ê°€"
else:
    batch = ""  # 24ì‹œ(0ì‹œ)ëŠ” ë°°ì¹˜ ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ


import time

time.sleep(10)

# ì¹´ì¹´ì˜¤ì›Œí¬ ë©”ì‹œì§€ ì „ì†¡
app_key = 'b36ed46e.0b55706350e94ef8b49e8647a97ae1b7'
chatroom_id = '9483028'
time_string = now.strftime("%mì›” %dì¼ %Hì‹œ %Më¶„")

def send_kakao_work_message(app_key, chatroom_id, file_url, batch):
    url = "https://api.kakaowork.com/v1/messages.send"
    headers = {
        "Authorization": f"Bearer {app_key}",
        "Content-Type": "application/json"
    }
    data = {
        "conversation_id": chatroom_id,
        "text": f"{batch} - ê²½ê¸°ê³µì‚° ìš´ì†¡ì¥ ìˆ˜ì§‘ ì™„ë£Œ",
        "blocks": [
            {
                "type": "header",
                "text": f"{batch} - ê²½ê¸°ê³µì‚° ìš´ì†¡ì¥ ìˆ˜ì§‘ ì™„ë£Œ",
                "style": "blue"
            },
            {
                "type": "text",
                "text": "ì•„ë˜ ë§í¬ì—ì„œ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”!",
                "markdown": True
            },
            {
                "type": "button",
                "text": "íŒŒì¼ ë‹¤ìš´ë¡œë“œ",
                "style": "default",
                "action_type": "open_system_browser",
                "value": file_url
            },
            {
                "type": "divider"
            },
            {
                "type": "text",
                "text": f"*ì†¡ì¥ ê°œìˆ˜:* {unique_count}ê±´",
                "markdown": True
            },
            {
                "type": "divider"
            },
            {
                "type": "text",
                "text": "*ì†¡ì¥ë„˜ê¸°ê¸°*\nì•„ì´ë””: `gram`\në¹„ë²ˆ: `3535`\n[ğŸ‘‰ ì†¡ì¥ ê´€ë¦¬ í˜ì´ì§€ ë°”ë¡œê°€ê¸°](https://gramwon.me/orders/transfer)",
                "markdown": True
            },
            {
                "type": "divider"
            },
        ]
    }
    response = requests.post(url, headers=headers, json=data)
    return response.json()

result = send_kakao_work_message(app_key, chatroom_id, shared_link_metadata.url, batch)
print(result)



import time

time.sleep(1)


# ---. ê²½ê¸°ê³µì‚° ì „ì²´ ë
print("ê²½ê¸°ê³µì‚° ì „ì²´ ë")
print("ë¶€ì‚°ì²­ê³¼ ì‹œì‘")
# ---. ë¶€ì‚°ì²­ê³¼ ì‹œì‘


# ---. ê²½ê¸°ê³µì‚° ì „ì²´ ë
print("ê²½ê¸°ê³µì‚° ì „ì²´ ë")
print("ë¶€ì‚°ì²­ê³¼ ì‹œì‘")
# ---. ë¶€ì‚°ì²­ê³¼ ì‹œì‘

# ---. ë¶€ì‚°ì²­ê³¼ë‚±ê°œ ë¶„ë¥˜
print("ë¶€ì‚°ì²­ê³¼ë‚±ê°œ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜"
        cursor.execute(sql_truncate)

        # ë¶€ì‚°ì²­ê³¼ ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ì²­ê³¼ë‚±ê°œ'
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ë¶€ì‚°ì²­ê³¼ë‚±ê°œ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)




# ---. íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸
print("íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰ì„ ì´ìš©í•˜ì—¬ 1ì„ ë‚˜ëˆˆ ê²°ê³¼ë¥¼ ì†Œìˆ˜ì  ì„¸ ìë¦¬ì—ì„œ ë‚´ë¦¼í•˜ì—¬ ì†¡ì¥êµ¬ë¶„ì ì»¬ëŸ¼ì— ì—…ë°ì´íŠ¸
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ì = FLOOR((1 / IFNULL(NULLIF(íƒë°°ìˆ˜ëŸ‰, 0), 10)) * 1000) / 1000
        """
        cursor.execute(sql_update)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ë")
# --ë


import time

time.sleep(1)



# ---. ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸
print("ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ì„ ê³±í•˜ì—¬ ê²°ê³¼ ì—…ë°ì´íŠ¸
        sql_multiply_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ì = ì†¡ì¥êµ¬ë¶„ì * ìˆ˜ëŸ‰
        """
        cursor.execute(sql_multiply_update)
        connection.commit()

        print(f"ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ì™„ë£Œ, {cursor.rowcount} í–‰ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸ ë")
# --ë


import time

time.sleep(1)



# ---. ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ë° íƒë°°ìˆ˜ëŸ‰1 ì—…ë°ì´íŠ¸
print("ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª…ì„ ê¸°ì¤€ìœ¼ë¡œ ì†¡ì¥êµ¬ë¶„ìë¥¼ í•©ì‚°
        sql_group_sum = """
        SELECT ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…, SUM(ì†¡ì¥êµ¬ë¶„ì) AS êµ¬ë¶„ìí•©
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜
        GROUP BY ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
        """
        cursor.execute(sql_group_sum)
        results = cursor.fetchall()

        # ê° ê·¸ë£¹ì˜ êµ¬ë¶„ìí•©ì„ íƒë°°ìˆ˜ëŸ‰1ì— ì—…ë°ì´íŠ¸
        for result in results:
            sql_update = """
            UPDATE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜
            SET íƒë°°ìˆ˜ëŸ‰1 = %s
            WHERE ì£¼ì†Œ = %s AND ìˆ˜ì·¨ì¸ëª… = %s
            """
            cursor.execute(sql_update, (result['êµ¬ë¶„ìí•©'], result['ì£¼ì†Œ'], result['ìˆ˜ì·¨ì¸ëª…']))

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"Updated {cursor.rowcount} rows based on address and recipient name.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ë° íƒë°°ìˆ˜ëŸ‰1 ì—…ë°ì´íŠ¸ ë")
# --ë

import time

time.sleep(1)




print("íƒë°°ìˆ˜ëŸ‰1 ì˜¬ë¦¼ ì²˜ë¦¬ ì‹œì‘")
import pymysql
import math

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰1ì˜ í˜„ì¬ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        sql_fetch = "SELECT id, íƒë°°ìˆ˜ëŸ‰1 FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜"
        cursor.execute(sql_fetch)
        results = cursor.fetchall()

        updated_rows = 0  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ë¥¼ ì¶”ì 
        # ê° í–‰ì˜ íƒë°°ìˆ˜ëŸ‰1 ê°’ì„ ì˜¬ë¦¼ ì²˜ë¦¬í•˜ê³  ì—…ë°ì´íŠ¸ í•©ë‹ˆë‹¤.
        for result in results:
            current_quantity = result['íƒë°°ìˆ˜ëŸ‰1']
            if current_quantity is None:  # íƒë°°ìˆ˜ëŸ‰1ì´ Noneì¼ ë•Œ ì²˜ë¦¬
                current_quantity = 1  # None ê°’ì„ 30ìœ¼ë¡œ ì„¤ì •
            
            rounded_quantity = math.ceil(float(current_quantity))  # íƒë°°ìˆ˜ëŸ‰1 ê°’ì„ ì˜¬ë¦¼
            sql_update = "UPDATE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜ SET íƒë°°ìˆ˜ëŸ‰1 = %s WHERE id = %s"
            cursor.execute(sql_update, (rounded_quantity, result['id']))
            updated_rows += cursor.rowcount

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜: {updated_rows}")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("íƒë°°ìˆ˜ëŸ‰1 ì˜¬ë¦¼ ì²˜ë¦¬ ì™„ë£Œ")
# --ë


import time

time.sleep(1)




# ---. íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸
print("íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰1ì´ 1ë³´ë‹¤ í° ê²½ìš° 'ì¶”ê°€'ë¡œ ì—…ë°ì´íŠ¸
        update_more_than_one = """
        UPDATE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ = 'ì¶”ê°€'
        WHERE íƒë°°ìˆ˜ëŸ‰1 > 1
        """
        cursor.execute(update_more_than_one)
        
        # íƒë°°ìˆ˜ëŸ‰1ì´ 1 ì´í•˜ì¸ ê²½ìš° '1ì¥'ìœ¼ë¡œ ì—…ë°ì´íŠ¸
        update_one_or_less = """
        UPDATE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        WHERE íƒë°°ìˆ˜ëŸ‰1 <= 1
        """
        cursor.execute(update_one_or_less)
        
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated rows for more than one: {cursor.rowcount}")  # 'ì¶”ê°€'ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥
        print(f"Updated rows for one or less: {cursor.rowcount}")  # '1ì¥'ìœ¼ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‘ì—… ë")
# ---ë

import time

time.sleep(1)



# ---. ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸
print("ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ì¡°í•©ì´ ìœ ì¼í•œ ê²½ìš° 'ë‹¨ì¼'ë¡œ ì—…ë°ì´íŠ¸
        update_unique_address_and_name = """
        UPDATE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜ t1
        JOIN (
            SELECT ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
            FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜
            WHERE ì†¡ì¥êµ¬ë¶„ = '1ì¥'
            GROUP BY ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
            HAVING COUNT(*) = 1
        ) AS unique_address ON t1.ì£¼ì†Œ = unique_address.ì£¼ì†Œ AND t1.ìˆ˜ì·¨ì¸ëª… = unique_address.ìˆ˜ì·¨ì¸ëª…
        SET t1.ì†¡ì¥êµ¬ë¶„ = 'ë‹¨ì¼'
        WHERE t1.ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        """
        cursor.execute(update_unique_address_and_name)

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated unique address and name rows to 'ë‹¨ì¼': {cursor.rowcount}")  # 'ë‹¨ì¼'ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‘ì—… ë")
# ---ë



# ---. ë¶€ì‚°ì²­ê³¼1ì¥ ë¶„ë¥˜
print("ë¶€ì‚°ì²­ê³¼1ì¥ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼1ì¥ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼1ì¥"
        cursor.execute(sql_truncate)

        # ë¶€ì‚°ì²­ê³¼ ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼1ì¥ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        ORDER BY ìœ„ì¹˜ë³€í™˜ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ë¶€ì‚°ì²­ê³¼1ì¥ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)


# ---. ë¶€ì‚°ì²­ê³¼ë‹¨ì¼ ë¶„ë¥˜
print("ë¶€ì‚°ì²­ê³¼ë‹¨ì¼ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë‹¨ì¼ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë‹¨ì¼"
        cursor.execute(sql_truncate)

        # ë¶€ì‚°ì²­ê³¼ ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë‹¨ì¼ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = 'ë‹¨ì¼'
        ORDER BY ìœ„ì¹˜ë³€í™˜ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ë¶€ì‚°ì²­ê³¼ë‹¨ì¼ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)

# ---. í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜
print("í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # í’ˆëª©ì½”ë“œë³„ë¡œ ìˆ˜ëŸ‰ì„ í•©ì‚°í•˜ì—¬ ì¶œë ¥ê°œìˆ˜ì— ì—…ë°ì´íŠ¸
        sql_update_output_count = """
        UPDATE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë‹¨ì¼ AS t1 
        INNER JOIN (
            SELECT í’ˆëª©ì½”ë“œ, SUM(ìˆ˜ëŸ‰) AS total_quantity
            FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë‹¨ì¼
            GROUP BY í’ˆëª©ì½”ë“œ
        ) AS t2 ON t1.í’ˆëª©ì½”ë“œ = t2.í’ˆëª©ì½”ë“œ
        SET t1.í’ˆëª©ê°œìˆ˜ = t2.total_quantity
        """
        cursor.execute(sql_update_output_count)

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜ ì‘ì—… ë")
# ---ë

import time

time.sleep(1)

# ---. ë¶€ì‚°ì²­ê³¼ì¶”ê°€ ë¶„ë¥˜
print("ë¶€ì‚°ì²­ê³¼ì¶”ê°€ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€"
        cursor.execute(sql_truncate)

        # ë¶€ì‚°ì²­ê³¼ ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = 'ì¶”ê°€'
        ORDER BY ì£¼ì†Œ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ë¶€ì‚°ì²­ê³¼ì¶”ê°€ ë¶„ë¥˜ ë")
# --ë


import time

time.sleep(1)




# ---. ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™
print("ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥"
        cursor.execute(sql_truncate)

        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€ í…Œì´ë¸”ì—ì„œ ìœ ë‹ˆí¬í•œ ì£¼ì†Œë¥¼ ê°€ì§„ í–‰ì„ ì„ íƒí•˜ì—¬ ì´ë™
        sql_insert_unique = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM (
            SELECT *, ROW_NUMBER() OVER (PARTITION BY ì£¼ì†Œ ORDER BY id ASC) AS rn
            FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€
        ) AS subquery
        WHERE subquery.rn = 1
        """
        cursor.execute(sql_insert_unique)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™ ë")
# --ë


import time

time.sleep(1)




# ---. ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸
print("ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ëª¨ë“  'ìˆ˜ëŸ‰'ì„ 1ë¡œ ë³€ê²½í•˜ê³  'ì†¡ì¥ëª…'ì„ "ì¶”ê°€ì†¡ì¥"ìœ¼ë¡œ ë³€ê²½
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥
        SET ìˆ˜ëŸ‰ = 1, ì†¡ì¥ëª… = '+++', ì˜µì…˜ëª… = '+++' , í’ˆëª©ì½”ë“œ = '0000'
        """
        cursor.execute(sql_update)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print(f"Updated {cursor.rowcount} rows in ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥.")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸ ì™„ë£Œ")
# --ë

import time

time.sleep(1)



# ---. ë¶€ì‚°ì²­ê³¼ ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° 
print("ë¶€ì‚°ì²­ê³¼ ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ë¨¼ì € ëª¨ë“  í–‰ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        sql_select = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ WHERE íƒë°°ìˆ˜ëŸ‰1 > 2"
        cursor.execute(sql_select)
        rows = cursor.fetchall()

        # ê° í–‰ì„ 'íƒë°°ìˆ˜ëŸ‰1 - 2' ë§Œí¼ ë³µì‚¬í•˜ì—¬ ì‚½ì…í•©ë‹ˆë‹¤.
        for row in rows:
            count = int(row['íƒë°°ìˆ˜ëŸ‰1']) - 2  # ì¶”ê°€í•  í–‰ì˜ ìˆ˜
            sql_insert = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥
            (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
            """
            params = (row['msg1'], row['msg2'], row['msg3'], row['msg4'], row['msg5'], row['msg6'], row['ìˆ˜ì·¨ì¸ëª…'], row['ì „í™”ë²ˆí˜¸1'], row['ì „í™”ë²ˆí˜¸2'], row['ìš°í¸ë²ˆí˜¸'], row['ì£¼ì†Œ'], row['ì˜µì…˜ëª…'], row['ìˆ˜ëŸ‰'], row['ë°°ì†¡ë©”ì„¸ì§€'], row['ì£¼ë¬¸ë²ˆí˜¸'], row['ì‡¼í•‘ëª°'], row['ìˆ˜ì§‘ì‹œê°„'], row['ì†¡ì¥ëª…'], row['í’ˆëª©ì½”ë“œ'], row['íƒë°°ë¹„ìš©'], row['ë°•ìŠ¤í¬ê¸°'], row['ì¶œë ¥ê°œìˆ˜'], row['ì†¡ì¥ìˆ˜ëŸ‰'], row['ë³„í‘œ1'], row['ë³„í‘œ2'], row['í’ˆëª©ê°œìˆ˜'], row['íƒë°°ìˆ˜ëŸ‰'], row['íƒë°°ìˆ˜ëŸ‰1'], row['íƒë°°ìˆ˜ëŸ‰í•©ì‚°'], row['ì†¡ì¥êµ¬ë¶„ì'], row['ì†¡ì¥êµ¬ë¶„'], row['ì†¡ì¥êµ¬ë¶„ìµœì¢…'], row['ìœ„ì¹˜'], row['ìœ„ì¹˜ë³€í™˜'])
            for _ in range(count):
                cursor.execute(sql_insert, params)

    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ë¶€ì‚°ì²­ê³¼ ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° ë")
# --ë

import time

time.sleep(1)


# ---. ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸°
print("ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸° ì‹œì‘")
# --ì‹œì‘

import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor  # ê²°ê³¼ë¥¼ ë”•ì…”ë„ˆë¦¬ í˜•íƒœë¡œ ë°›ê¸° ìœ„í•¨
)

try:
    with conn.cursor() as cursor:
        # ìœ„ì¹˜ë³€í™˜ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ëª¨ë“  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´
        sql = "SELECT id, ìœ„ì¹˜ë³€í™˜ FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ ORDER BY ìœ„ì¹˜ë³€í™˜, id"
        cursor.execute(sql)
        results = cursor.fetchall()

        # í˜„ì¬ ìœ„ì¹˜ë³€í™˜ ê°’
        current_location = None
        counter = 1

        # ê²°ê³¼ë¥¼ ìˆœíšŒí•˜ë©´ì„œ ìˆœë²ˆì„ ë§¤ê¹€
        for row in results:
            if current_location != row['ìœ„ì¹˜ë³€í™˜']:
                current_location = row['ìœ„ì¹˜ë³€í™˜']
                counter = 1  # ìœ„ì¹˜ë³€í™˜ ê°’ì´ ë°”ë€Œë©´ ìˆœë²ˆì„ ë¦¬ì…‹
            
            # ì†¡ì¥êµ¬ë¶„ì ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ (ì¤‘ê´„í˜¸ í˜•ì‹ìœ¼ë¡œ)
            formatted_number = f"[{counter}]"  # ìˆ«ì ì•ë’¤ë¡œ ëŒ€ê´„í˜¸ ì¶”ê°€
            update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ SET ì†¡ì¥êµ¬ë¶„ì=%s WHERE id=%s"
            cursor.execute(update_sql, (formatted_number, row['id']))
            counter += 1

        conn.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

finally:
    conn.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

# ---. ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸°
print("ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸° ë")
# --ë

import time

time.sleep(1)


# ---. ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸
print("ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸ ì‹œì‘")
# --ì‹œì‘


import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with conn.cursor() as cursor:
        # 'ì£¼ì†Œ' ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ ì¿¼ë¦¬ ì‹¤í–‰
        update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ SET ì£¼ì†Œ = CONCAT(ì£¼ì†Œ, ì†¡ì¥êµ¬ë¶„ì)"
        cursor.execute(update_sql)
        conn.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    conn.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ


# ---. ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸
print("ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸ ë")
# --ë

import time

time.sleep(1)


import pymysql
import pymysql.cursors

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # í…Œì´ë¸”ì„ ë¹„ì›ë‹ˆë‹¤.
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€í•©ì¹˜ê¸°")
        
        # ë°ì´í„° ë³‘í•© ë° ì‚½ì… ì¿¼ë¦¬
        merge_and_insert_query = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€í•©ì¹˜ê¸°(msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM (
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€
            UNION ALL
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€ì†¡ì¥
        ) AS combined
        ORDER BY ìœ„ì¹˜ DESC
        """
        cursor.execute(merge_and_insert_query)
        
        # ë³€ê²½ ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— í™•ì •í•©ë‹ˆë‹¤.
        connection.commit()

finally:
    # ì—°ê²°ì„ ë‹«ìŠµë‹ˆë‹¤.
    connection.close()

import time

time.sleep(1)



# ---. ë¶€ì‚°ì²­ê³¼ í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬
print("ë¶€ì‚°ì²­ê³¼ í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬ ì‹œì‘")
# --ì‹œì‘


import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ í…Œì´ë¸” ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼")
        
        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë‹¨ì¼ í…Œì´ë¸”ì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ì„œ ì •ë ¬ í›„ ì‚½ì…
        sql_insert_from_single = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë‹¨ì¼
        ORDER BY ìœ„ì¹˜ë³€í™˜ ASC
        """
        cursor.execute(sql_insert_from_single)

        # ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤ í…Œì´ë¸”ì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ì„œ ì •ë ¬ í›„ ì‚½ì…
        sql_insert_from_box = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
            SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
            FROM ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤
            WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ì²­ê³¼ë°•ìŠ¤'
            ORDER BY ìœ„ì¹˜ë³€í™˜ ASC
        """
        cursor.execute(sql_insert_from_box)




        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼1ì¥ í…Œì´ë¸”ì˜ ë°ì´í„°ë„ ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì— ì¶”ê°€
        sql_insert_from_one = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼1ì¥
        """
        cursor.execute(sql_insert_from_one)

        # ë‘ í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ í•©ì¹˜ê³ , ID ì»¬ëŸ¼ì„ ì œì™¸í•œ í›„ ì •ë ¬í•˜ì—¬ ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì— ì‚½ì…
        sql_merge_and_sort = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì¶”ê°€í•©ì¹˜ê¸°
        ORDER BY ì£¼ì†Œ ASC
        """
        cursor.execute(sql_merge_and_sort)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()


# ---. ë¶€ì‚°ì²­ê³¼ í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬
print("ë¶€ì‚°ì²­ê³¼ í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬ ë")
# --ë

import time

time.sleep(1)


# ---. ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‘ì—…
print("ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³„í‘œ í…Œì´ë¸”ì„ ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³„í‘œ")
        print("ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³„í‘œ í…Œì´ë¸”ì´ ë¹„ì›Œì¡ŒìŠµë‹ˆë‹¤.")

        # ë³„í‘œ1 ë˜ëŠ” ë³„í‘œ2ê°€ ë¹„ì–´ìˆì§€ ì•Šì€ í–‰ì„ ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³„í‘œ í…Œì´ë¸”ë¡œ ì´ë™
        sql_move_to_star_table = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³„í‘œ
        SELECT * FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼
        WHERE ë³„í‘œ1 <> '' OR ë³„í‘œ2 <> ''
        """
        cursor.execute(sql_move_to_star_table)
        print(f"Moved {cursor.rowcount} rows to 'ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³„í‘œ'.")

        # ì´ë™ëœ í–‰ ì‚­ì œ
        sql_delete_moved_rows = """
        DELETE FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼
        WHERE ë³„í‘œ1 <> '' OR ë³„í‘œ2 <> ''
        """
        cursor.execute(sql_delete_moved_rows)
        print(f"Deleted {cursor.rowcount} rows from 'ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼'.")

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥


finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‘ì—… ì™„ë£Œ")
# ---ë


import time

time.sleep(1)


# ---. ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™
print("ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³„í‘œì—ì„œ ë³„í‘œ1ë¡œ ì •ë ¬í•˜ì—¬ ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì— ë°ì´í„° ì‚½ì…
        sql_transfer_data = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼
        (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³„í‘œ
        ORDER BY ì£¼ì†Œ ASC, ì˜µì…˜ëª… ASC
        """
        cursor.execute(sql_transfer_data)

        print(f"Rows moved: {cursor.rowcount}")  # ì´ë™ëœ í–‰ì˜ ìˆ˜ ì¶œë ¥

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™ ì‘ì—… ì™„ë£Œ")
# ---ë


import time

time.sleep(1)



# ---. ë°ì´í„° ì´ë™ ì‘ì—…
print("ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì—ì„œ ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢… í…Œì´ë¸”ì„ ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…")

        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì—ì„œ ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™
        sql_transfer_data = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…
            (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
             ì†¡ì¥ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, 
             ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
               ì†¡ì¥ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, 
               ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼
        """
        cursor.execute(sql_transfer_data)
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Moved {cursor.rowcount} rows from 'ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼' to 'ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…'.")

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ì—ì„œ ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™ ì‘ì—… ì™„ë£Œ")
# ---ë

import time

time.sleep(1)

# ---. ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸
print("ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜ ì—…ë°ì´íŠ¸
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…
        SET íƒë°°ë¹„ìš© = 2300, ë°•ìŠ¤í¬ê¸° = 'ê·¹ì†Œ', ì¶œë ¥ê°œìˆ˜ = 1
        """
        cursor.execute(sql_update)
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated {cursor.rowcount} rows in 'ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…'.")

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì™„ë£Œ")
# ---ë

#2. ì—‘ì…€ì—ì„œ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
import pandas as pd
import pymysql
import time

def truncate_and_insert_busan_outside():
    print("ë¶€ì‚° ì™¸ë¶€ì¶œê³  ì½”ë“œì…ë ¥ ì‹œì‘")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # Excel íŒŒì¼ ê²½ë¡œ
    excel_file = '0.ê´€ë¦¬ìíŒŒì¼/ã„±.ë¶€ì‚°ì²­ê³¼ê´€ë¦¬ìí´ë”/ì™¸ë¶€ì¶œê³ .xlsx'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        # Excel íŒŒì¼ ì½ê¸°
        df = pd.read_excel(excel_file)

        # NaN ê°’ì„ ë¹ˆ ë¬¸ìì—´("")ë¡œ ëŒ€ì²´
        df.fillna('', inplace=True)

        # MySQL í…Œì´ë¸”ì— ë°ì´í„° ì‚½ì… ì „ì— í…Œì´ë¸” ë¹„ìš°ê¸°
        with connection.cursor() as cursor:
            # í…Œì´ë¸” ë¹„ìš°ê¸°
            cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ì™¸ë¶€ì¶œê³ ")

        # MySQL í…Œì´ë¸”ì— ë°ì´í„° ì‚½ì…
        with connection.cursor() as cursor:
            for index, row in df.iterrows():
                sql = """
                INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ì™¸ë¶€ì¶œê³  (í’ˆëª©ì½”ë“œ, ìƒí’ˆëª…)
                VALUES (%s, %s)
                """
                cursor.execute(sql, (row['í’ˆëª©ì½”ë“œ'], row['ìƒí’ˆëª…']))

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print("ë¶€ì‚° ì™¸ë¶€ì¶œê³  ì½”ë“œì…ë ¥ ë")
    except Exception as e:
        print(f"Error in truncate_and_insert_busan: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()

# í•¨ìˆ˜ ì‹¤í–‰
truncate_and_insert_busan_outside()

time.sleep(1)




import pymysql

def process_busan_data():
    print("ë°ì´í„° ì²˜ë¦¬ ì‹œì‘ (ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…ë³€í™˜)")
    # MySQL ì—°ê²° ì •ë³´
    host = 'gramwonlogis.mycafe24.com'
    port = 3306
    user = 'gramwonlogis'
    password = 'jung5516!'
    database = 'gramwonlogis'

    # MySQL ì—°ê²° ì„¤ì •
    connection = pymysql.connect(
        host=host,
        port=port,
        user=user,
        password=password,
        database=database,
        cursorclass=pymysql.cursors.DictCursor
    )

    try:
        with connection.cursor() as cursor:
            # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…ë³€í™˜ í…Œì´ë¸” ë¹„ìš°ê¸°
            cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…ë³€í™˜")
            print("ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…ë³€í™˜ í…Œì´ë¸” ë¹„ìš°ê¸° ì™„ë£Œ")

            # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ì™¸ë¶€ì¶œê³ ì™€ ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…ì˜ í’ˆëª©ì½”ë“œê°€ ê°™ì€ í–‰ì„ ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…ë³€í™˜ìœ¼ë¡œ ì˜®ê¸°ê¸°
            insert_sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…ë³€í™˜
            SELECT t.*
            FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢… t
            JOIN ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ì™¸ë¶€ì¶œê³  e ON t.í’ˆëª©ì½”ë“œ = e.í’ˆëª©ì½”ë“œ
            """
            cursor.execute(insert_sql)
            print("ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…ë³€í™˜ í…Œì´ë¸”ë¡œ ë°ì´í„° ì˜®ê¸°ê¸° ì™„ë£Œ")

            # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…ì—ì„œ í•´ë‹¹ í–‰ ì‚­ì œ
            delete_sql = """
            DELETE t
            FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢… t
            JOIN ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ì™¸ë¶€ì¶œê³  e ON t.í’ˆëª©ì½”ë“œ = e.í’ˆëª©ì½”ë“œ
            """
            cursor.execute(delete_sql)
            print("ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢… í…Œì´ë¸”ì—ì„œ ë°ì´í„° ì‚­ì œ ì™„ë£Œ")

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
    except Exception as e:
        print(f"Error in process_busan_data: {e}")
    finally:
        # ì—°ê²° ì¢…ë£Œ
        connection.close()
        print("MySQL ì—°ê²° ì¢…ë£Œ")

# í•¨ìˆ˜ ì‹¤í–‰
if __name__ == "__main__":
    process_busan_data()



import time

time.sleep(1)

print("ë¶€ì‚°ì²­ê³¼_ìµœì¢…íŒŒì¼ë§Œë“¤ê¸° ì‹œì‘")
# ---ì‹œì‘

import pandas as pd
import mysql.connector
from datetime import datetime
import dropbox
import requests

# ë°ì´í„°ë² ì´ìŠ¤ ë° ë°ì´í„° ì²˜ë¦¬ ì‹œì‘
connection = mysql.connector.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci'
)

cursor = connection.cursor()
query = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…"
cursor.execute(query)
result = cursor.fetchall()
columns = cursor.column_names
df = pd.DataFrame(result, columns=columns)
unique_count = df.drop_duplicates(subset=['ì£¼ì†Œ', 'ìˆ˜ì·¨ì¸ëª…', 'ì „í™”ë²ˆí˜¸1']).shape[0]
connection.close()

# íŒŒì¼ ì €ì¥ ë° Dropbox ì—…ë¡œë“œ
now = datetime.now()
file_path = f'ë¶€ì‚°ì²­ê³¼/ë¶€ì‚°ì²­ê³¼_{now.strftime("%y%m%d_%Hì‹œ%Më¶„")}.xlsx'
df.to_excel(file_path, index=False, header=False)

refresh_token = '1CLvznLL7BwAAAAAAAAAAagAlVx3w9P6NGyYjsITAxrSG9vlAEc31ohZZwYhUAB_'
app_key = 'vlxh3ec9nq5fi5t'
app_secret = 'h5rp5n0w9cp4ifk'
token_url = "https://api.dropbox.com/oauth2/token"
params = {
    'refresh_token': refresh_token,
    'grant_type': 'refresh_token',
    'client_id': app_key,
    'client_secret': app_secret
}
response = requests.post(token_url, data=params)
access_token = response.json().get('access_token')

dbx = dropbox.Dropbox(access_token)
with open(file_path, "rb") as f:
    dbx.files_upload(f.read(), f'/ë¶€ì‚°ì²­ê³¼/{file_path}', mode=dropbox.files.WriteMode("overwrite"))
shared_link_metadata = dbx.sharing_create_shared_link_with_settings(f'/ë¶€ì‚°ì²­ê³¼/{file_path}')

# ì‹œê°„ëŒ€ë³„ ì°¨ìˆ˜ ì„¤ì •
hour = now.hour
minute = now.minute

if 1 <= hour <= 7:
    batch = "1ì°¨"
elif 8 <= hour <= 10:
    batch = "2ì°¨"
elif 11 <= hour <= 11:
    batch = "3ì°¨"
elif 12 <= hour <= 13:
    batch = "4ì°¨"
elif 14 <= hour <= 15:
    batch = "5ì°¨"
elif 16 <= hour <= 18:
    batch = "ë§‰ì°¨"
elif 19 <= hour <= 23:
    batch = "ì¶”ê°€"
else:
    batch = ""  # 24ì‹œ(0ì‹œ)ëŠ” ë°°ì¹˜ ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ


import time

time.sleep(1)

# ì¹´ì¹´ì˜¤ì›Œí¬ ë©”ì‹œì§€ ì „ì†¡
app_key = 'b36ed46e.0b55706350e94ef8b49e8647a97ae1b7'
chatroom_id = '9483032'
time_string = now.strftime("%mì›” %dì¼ %Hì‹œ %Më¶„")

def send_kakao_work_message(app_key, chatroom_id, file_url, batch):
    url = "https://api.kakaowork.com/v1/messages.send"
    headers = {
        "Authorization": f"Bearer {app_key}",
        "Content-Type": "application/json"
    }
    data = {
        "conversation_id": chatroom_id,
        "text": f"{batch} - ë¶€ì‚°ì²­ê³¼ ìš´ì†¡ì¥ ìˆ˜ì§‘ ì™„ë£Œ",
        "blocks": [
            {
                "type": "header",
                "text": f"{batch} - ë¶€ì‚°ì²­ê³¼ ìš´ì†¡ì¥ ìˆ˜ì§‘ ì™„ë£Œ",
                "style": "blue"
            },
            {
                "type": "text",
                "text": "ì•„ë˜ ë§í¬ì—ì„œ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”!",
                "markdown": True
            },
            {
                "type": "button",
                "text": "íŒŒì¼ ë‹¤ìš´ë¡œë“œ",
                "style": "default",
                "action_type": "open_system_browser",
                "value": file_url
            },
            {
                "type": "divider"
            },
            {
                "type": "text",
                "text": f"*ì†¡ì¥ ê°œìˆ˜:* {unique_count}ê±´",
                "markdown": True
            },
            {
                "type": "divider"
            },
            {
                "type": "text",
                "text": "*ì†¡ì¥ë„˜ê¸°ê¸°*\nì•„ì´ë””: `gram`\në¹„ë²ˆ: `3535`\n[ğŸ‘‰ ì†¡ì¥ ê´€ë¦¬ í˜ì´ì§€ ë°”ë¡œê°€ê¸°](https://gramwon.me/orders/transfer)",
                "markdown": True
            },
            {
                "type": "divider"
            },
        ]
    }
    response = requests.post(url, headers=headers, json=data)
    return response.json()

result = send_kakao_work_message(app_key, chatroom_id, shared_link_metadata.url, batch)
print(result)


import time

time.sleep(1)


import time

time.sleep(1)

print("ë¶€ì‚°ì²­ê³¼_ìµœì¢…íŒŒì¼ë§Œë“¤ê¸° ì‹œì‘")
# ---ì‹œì‘

import pandas as pd
import mysql.connector
from datetime import datetime
import dropbox
import requests

# ë°ì´í„°ë² ì´ìŠ¤ ë° ë°ì´í„° ì²˜ë¦¬ ì‹œì‘
connection = mysql.connector.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci'
)

cursor = connection.cursor()
query = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…ë³€í™˜"
cursor.execute(query)
result = cursor.fetchall()
columns = cursor.column_names
df = pd.DataFrame(result, columns=columns)
unique_count = df.drop_duplicates(subset=['ì£¼ì†Œ', 'ìˆ˜ì·¨ì¸ëª…', 'ì „í™”ë²ˆí˜¸1']).shape[0]
connection.close()

# íŒŒì¼ ì €ì¥ ë° Dropbox ì—…ë¡œë“œ
now = datetime.now()
file_path = f'ë¶€ì‚°ì²­ê³¼/ë¶€ì‚°ì²­ê³¼ì™¸ë¶€ì¶œê³ _{now.strftime("%y%m%d_%Hì‹œ%Më¶„")}.xlsx'
df.to_excel(file_path, index=False, header=False)

refresh_token = '1CLvznLL7BwAAAAAAAAAAagAlVx3w9P6NGyYjsITAxrSG9vlAEc31ohZZwYhUAB_'
app_key = 'vlxh3ec9nq5fi5t'
app_secret = 'h5rp5n0w9cp4ifk'
token_url = "https://api.dropbox.com/oauth2/token"
params = {
    'refresh_token': refresh_token,
    'grant_type': 'refresh_token',
    'client_id': app_key,
    'client_secret': app_secret
}
response = requests.post(token_url, data=params)
access_token = response.json().get('access_token')

dbx = dropbox.Dropbox(access_token)
with open(file_path, "rb") as f:
    dbx.files_upload(f.read(), f'/ë¶€ì‚°ì²­ê³¼/{file_path}', mode=dropbox.files.WriteMode("overwrite"))
shared_link_metadata = dbx.sharing_create_shared_link_with_settings(f'/ë¶€ì‚°ì²­ê³¼/{file_path}')

# ì‹œê°„ëŒ€ë³„ ì°¨ìˆ˜ ì„¤ì •
hour = now.hour
minute = now.minute

if 1 <= hour <= 7:
    batch = "1ì°¨"
elif 8 <= hour <= 10:
    batch = "2ì°¨"
elif 11 <= hour <= 11:
    batch = "3ì°¨"
elif 12 <= hour <= 13:
    batch = "4ì°¨"
elif 14 <= hour <= 15:
    batch = "5ì°¨"
elif 16 <= hour <= 18:
    batch = "ë§‰ì°¨"
elif 19 <= hour <= 23:
    batch = "ì¶”ê°€"
else:
    batch = ""  # 24ì‹œ(0ì‹œ)ëŠ” ë°°ì¹˜ ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ


import time

time.sleep(10)

# ì¹´ì¹´ì˜¤ì›Œí¬ ë©”ì‹œì§€ ì „ì†¡
app_key = 'b36ed46e.0b55706350e94ef8b49e8647a97ae1b7'
chatroom_id = '9483032'
time_string = now.strftime("%mì›” %dì¼ %Hì‹œ %Më¶„")

def send_kakao_work_message(app_key, chatroom_id, file_url, batch):
    url = "https://api.kakaowork.com/v1/messages.send"
    headers = {
        "Authorization": f"Bearer {app_key}",
        "Content-Type": "application/json"
    }
    data = {
        "conversation_id": chatroom_id,
        "text": f"{batch} - ë¶€ì‚°ì²­ê³¼ ì™¸ë¶€ìš´ì†¡ì¥ ìˆ˜ì§‘ ì™„ë£Œ",
        "blocks": [
            {
                "type": "header",
                "text": f"{batch} - ë¶€ì‚°ì²­ê³¼ ì™¸ë¶€ìš´ì†¡ì¥ ìˆ˜ì§‘ ì™„ë£Œ",
                "style": "blue"
            },
            {
                "type": "text",
                "text": "ì•„ë˜ ë§í¬ì—ì„œ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”!",
                "markdown": True
            },
            {
                "type": "button",
                "text": "íŒŒì¼ ë‹¤ìš´ë¡œë“œ",
                "style": "default",
                "action_type": "open_system_browser",
                "value": file_url
            },
            {
                "type": "divider"
            },
            {
                "type": "text",
                "text": f"*ì†¡ì¥ ê°œìˆ˜:* {unique_count}ê±´",
                "markdown": True
            },
            {
                "type": "divider"
            },
            {
                "type": "text",
                "text": "*ì†¡ì¥ë„˜ê¸°ê¸°*\nì•„ì´ë””: `gram`\në¹„ë²ˆ: `3535`\n[ğŸ‘‰ ì†¡ì¥ ê´€ë¦¬ í˜ì´ì§€ ë°”ë¡œê°€ê¸°](https://gramwon.me/orders/transfer)",
                "markdown": True
            },
            {
                "type": "divider"
            },
        ]
    }
    response = requests.post(url, headers=headers, json=data)
    return response.json()

result = send_kakao_work_message(app_key, chatroom_id, shared_link_metadata.url, batch)
print(result)


import time

time.sleep(1)


import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„¤ì •
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with conn.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ ì™„ì „íˆ ì‚­ì œ
        truncate_sql = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ"
        cursor.execute(truncate_sql)

        # ì†¡ì¥êµ¬ë¶„ìê°€ 'YC_'ë¡œ ì‹œì‘í•˜ëŠ” ë°ì´í„° ì¡°íšŒ
        select_sql = """
        SELECT í’ˆëª©ì½”ë“œ, ì†¡ì¥ëª…, ìˆ˜ëŸ‰ 
        FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜ 
        WHERE ì†¡ì¥êµ¬ë¶„ì LIKE 'YC_%'
        """
        cursor.execute(select_sql)
        results = cursor.fetchall()

        # ê²°ê³¼ ë°ì´í„°ë¥¼ ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ í…Œì´ë¸”ë¡œ ì‚½ì…
        insert_sql = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ (í’ˆëª©ì½”ë“œ, ì†¡ì¥ëª…, ìˆ˜ëŸ‰)
        VALUES (%s, %s, %s)
        """
        for row in results:
            cursor.execute(insert_sql, (row['í’ˆëª©ì½”ë“œ'], row['ì†¡ì¥ëª…'], row['ìˆ˜ëŸ‰']))
        
        conn.commit()

finally:
    conn.close()

# ---. 5ì´ˆë”œë ˆì´
# ---ì‹œì‘
import time

time.sleep(1)

import time

time.sleep(1)

import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„¤ì •
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with conn.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_ë‹¨í’ˆ í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ ì™„ì „íˆ ì‚­ì œ
        truncate_sql = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_ë‹¨í’ˆ"
        cursor.execute(truncate_sql)

        # ì£¼ì†Œê°€ ì¤‘ë³µë˜ì§€ ì•ŠëŠ” ë°ì´í„° ì¡°íšŒ
        select_sql = """
        SELECT í’ˆëª©ì½”ë“œ, ì†¡ì¥ëª…, ìˆ˜ëŸ‰
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜
        WHERE ì£¼ì†Œ IS NOT NULL
        AND ì£¼ì†Œ IN (
            SELECT ì£¼ì†Œ
            FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜
            WHERE ì£¼ì†Œ IS NOT NULL
            GROUP BY ì£¼ì†Œ
            HAVING COUNT(*) = 1
        )
        """
        cursor.execute(select_sql)
        results = cursor.fetchall()

        # ê²°ê³¼ ë°ì´í„°ë¥¼ ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_ë‹¨í’ˆ í…Œì´ë¸”ë¡œ ì‚½ì…
        insert_sql = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_ë‹¨í’ˆ (í’ˆëª©ì½”ë“œ, ì†¡ì¥ëª…, ìˆ˜ëŸ‰)
        VALUES (%s, %s, %s)
        """
        for row in results:
            cursor.execute(insert_sql, (row['í’ˆëª©ì½”ë“œ'], row['ì†¡ì¥ëª…'], row['ìˆ˜ëŸ‰']))
        
        conn.commit()

    with conn.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_í•©í¬ í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ ì™„ì „íˆ ì‚­ì œ
        truncate_sql = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_í•©í¬"
        cursor.execute(truncate_sql)

        # ì£¼ì†Œê°€ ì¤‘ë³µë˜ëŠ” ë°ì´í„° ì¡°íšŒ
        select_sql = """
        SELECT í’ˆëª©ì½”ë“œ, ì†¡ì¥ëª…, ìˆ˜ëŸ‰
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜
        WHERE ì£¼ì†Œ IS NOT NULL
        AND ì£¼ì†Œ IN (
            SELECT ì£¼ì†Œ
            FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ë³€í™˜
            WHERE ì£¼ì†Œ IS NOT NULL
            GROUP BY ì£¼ì†Œ
            HAVING COUNT(*) > 1
        )
        """
        cursor.execute(select_sql)
        results = cursor.fetchall()

        # ê²°ê³¼ ë°ì´í„°ë¥¼ ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_í•©í¬ í…Œì´ë¸”ë¡œ ì‚½ì…
        insert_sql = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_í•©í¬ (í’ˆëª©ì½”ë“œ, ì†¡ì¥ëª…, ìˆ˜ëŸ‰)
        VALUES (%s, %s, %s)
        """
        for row in results:
            cursor.execute(insert_sql, (row['í’ˆëª©ì½”ë“œ'], row['ì†¡ì¥ëª…'], row['ìˆ˜ëŸ‰']))
        
        conn.commit()

finally:
    conn.close()

import time

time.sleep(1)

import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„¤ì •
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with conn.cursor() as cursor:
        # ê° í’ˆëª©ì½”ë“œë³„ë¡œ ìˆ˜ëŸ‰ í•©ê³„ ê³„ì‚°
        select_sum_sql = """
        SELECT í’ˆëª©ì½”ë“œ, SUM(ìˆ˜ëŸ‰) AS ì´ìˆ˜ëŸ‰
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ
        GROUP BY í’ˆëª©ì½”ë“œ
        """
        cursor.execute(select_sum_sql)
        results = cursor.fetchall()

        # ê° í’ˆëª©ì½”ë“œë³„ ì´ìˆ˜ëŸ‰ì„ ì—…ë°ì´íŠ¸
        update_sql = """
        UPDATE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ
        SET ì´ìˆ˜ëŸ‰ = %s
        WHERE í’ˆëª©ì½”ë“œ = %s
        """
        for row in results:
            cursor.execute(update_sql, (row['ì´ìˆ˜ëŸ‰'], row['í’ˆëª©ì½”ë“œ']))

        conn.commit()

finally:
    conn.close()


# ---. 5ì´ˆë”œë ˆì´
# ---ì‹œì‘
import time

time.sleep(1)


import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„¤ì •
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with conn.cursor() as cursor:
        # ê° í’ˆëª©ì½”ë“œë³„ë¡œ ìˆ˜ëŸ‰ í•©ê³„ ê³„ì‚°
        select_sum_sql = """
        SELECT í’ˆëª©ì½”ë“œ, SUM(ìˆ˜ëŸ‰) AS ì´ìˆ˜ëŸ‰
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_ë‹¨í’ˆ
        GROUP BY í’ˆëª©ì½”ë“œ
        """
        cursor.execute(select_sum_sql)
        results = cursor.fetchall()

        # ê° í’ˆëª©ì½”ë“œë³„ ì´ìˆ˜ëŸ‰ì„ ì—…ë°ì´íŠ¸
        update_sql = """
        UPDATE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_ë‹¨í’ˆ
        SET ì´ìˆ˜ëŸ‰ = %s
        WHERE í’ˆëª©ì½”ë“œ = %s
        """
        for row in results:
            cursor.execute(update_sql, (row['ì´ìˆ˜ëŸ‰'], row['í’ˆëª©ì½”ë“œ']))

        conn.commit()

finally:
    conn.close()


# ---. 5ì´ˆë”œë ˆì´
# ---ì‹œì‘
import time

time.sleep(1)


import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„¤ì •
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with conn.cursor() as cursor:
        # ê° í’ˆëª©ì½”ë“œë³„ë¡œ ìˆ˜ëŸ‰ í•©ê³„ ê³„ì‚°
        select_sum_sql = """
        SELECT í’ˆëª©ì½”ë“œ, SUM(ìˆ˜ëŸ‰) AS ì´ìˆ˜ëŸ‰
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_í•©í¬
        GROUP BY í’ˆëª©ì½”ë“œ
        """
        cursor.execute(select_sum_sql)
        results = cursor.fetchall()

        # ê° í’ˆëª©ì½”ë“œë³„ ì´ìˆ˜ëŸ‰ì„ ì—…ë°ì´íŠ¸
        update_sql = """
        UPDATE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_í•©í¬
        SET ì´ìˆ˜ëŸ‰ = %s
        WHERE í’ˆëª©ì½”ë“œ = %s
        """
        for row in results:
            cursor.execute(update_sql, (row['ì´ìˆ˜ëŸ‰'], row['í’ˆëª©ì½”ë“œ']))

        conn.commit()

finally:
    conn.close()


# ---. 5ì´ˆë”œë ˆì´
# ---ì‹œì‘
import time

time.sleep(1)


import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„¤ì •
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with conn.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_ìµœì¢… í…Œì´ë¸” ì´ˆê¸°í™”
        truncate_sql = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_ìµœì¢…"
        cursor.execute(truncate_sql)

        # 1. ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œì—ì„œ ë°ì´í„° ì‚½ì…
        select_sql_1 = """
        SELECT í’ˆëª©ì½”ë“œ, REPLACE(MAX(ì†¡ì¥ëª…), 'YC_', '') AS ì†¡ì¥ëª…, SUM(ìˆ˜ëŸ‰) AS ì´ìˆ˜ëŸ‰
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ
        GROUP BY í’ˆëª©ì½”ë“œ
        ORDER BY í’ˆëª©ì½”ë“œ ASC
        """
        cursor.execute(select_sql_1)
        results_1 = cursor.fetchall()

        # 2. ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_ë‹¨í’ˆì—ì„œ ë°ì´í„° ì‚½ì…
        select_sql_2 = """
        SELECT í’ˆëª©ì½”ë“œ, REPLACE(MAX(ì†¡ì¥ëª…), 'YC_', '') AS ì†¡ì¥ëª…, SUM(ìˆ˜ëŸ‰) AS ì´ìˆ˜ëŸ‰
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_ë‹¨í’ˆ
        GROUP BY í’ˆëª©ì½”ë“œ
        ORDER BY í’ˆëª©ì½”ë“œ ASC
        """
        cursor.execute(select_sql_2)
        results_2 = cursor.fetchall()

        # 3. ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_í•©í¬ì—ì„œ ë°ì´í„° ì‚½ì…
        select_sql_3 = """
        SELECT í’ˆëª©ì½”ë“œ, REPLACE(MAX(ì†¡ì¥ëª…), 'YC_', '') AS ì†¡ì¥ëª…, SUM(ìˆ˜ëŸ‰) AS ì´ìˆ˜ëŸ‰
        FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_í•©í¬
        GROUP BY í’ˆëª©ì½”ë“œ
        ORDER BY í’ˆëª©ì½”ë“œ ASC
        """
        cursor.execute(select_sql_3)
        results_3 = cursor.fetchall()

        # 4. ìµœì¢… í…Œì´ë¸”ì— ì‚½ì… (ë³‘í•©)
        for i in range(max(len(results_1), len(results_2), len(results_3))):
            row_1 = results_1[i] if i < len(results_1) else {'í’ˆëª©ì½”ë“œ': None, 'ì†¡ì¥ëª…': None, 'ì´ìˆ˜ëŸ‰': None}
            row_2 = results_2[i] if i < len(results_2) else {'í’ˆëª©ì½”ë“œ': None, 'ì†¡ì¥ëª…': None, 'ì´ìˆ˜ëŸ‰': None}
            row_3 = results_3[i] if i < len(results_3) else {'í’ˆëª©ì½”ë“œ': None, 'ì†¡ì¥ëª…': None, 'ì´ìˆ˜ëŸ‰': None}

            insert_sql = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_ìµœì¢… 
            (í’ˆëª©ì½”ë“œ, ì†¡ì¥ëª…, ì´ìˆ˜ëŸ‰, ë‹¨í’ˆí’ˆëª©ì½”ë“œ, ë‹¨í’ˆì†¡ì¥ëª…, ë‹¨í’ˆì´ìˆ˜ëŸ‰, í•©í¬í’ˆëª©ì½”ë“œ, í•©í¬ì†¡ì¥ëª…, í•©í¬ì´ìˆ˜ëŸ‰)
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s)
            """
            cursor.execute(insert_sql, (
                row_1['í’ˆëª©ì½”ë“œ'], row_1['ì†¡ì¥ëª…'], row_1['ì´ìˆ˜ëŸ‰'],
                row_2['í’ˆëª©ì½”ë“œ'], row_2['ì†¡ì¥ëª…'], row_2['ì´ìˆ˜ëŸ‰'],
                row_3['í’ˆëª©ì½”ë“œ'], row_3['ì†¡ì¥ëª…'], row_3['ì´ìˆ˜ëŸ‰']
            ))
        
        conn.commit()

finally:
    conn.close()





import time

time.sleep(10)



import pandas as pd
import mysql.connector
from datetime import datetime
import dropbox
import requests
import xlsxwriter  # xlsxwriter íŒ¨í‚¤ì§€ ì¶”ê°€

connection = mysql.connector.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci'
)

cursor = connection.cursor()
query = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼ìë£Œ_ìµœì¢…"
cursor.execute(query)
result = cursor.fetchall()
columns = cursor.column_names
df = pd.DataFrame(result, columns=columns)
unique_count = df.drop_duplicates(subset=['í’ˆëª©ì½”ë“œ', 'ì†¡ì¥ëª…', 'ì´ìˆ˜ëŸ‰']).shape[0]
connection.close()

# íŒŒì¼ ì €ì¥ ë° Dropbox ì—…ë¡œë“œ
now = datetime.now()
file_path = f'ë¶€ì‚°ì²­ê³¼/ë¶€ì‚°ì²­ê³¼A4ìë£Œ_{now.strftime("%y%m%d_%Hì‹œ%Më¶„")}.xlsx'
with pd.ExcelWriter(file_path, engine='xlsxwriter') as writer:
    df.to_excel(writer, index=False, header=True)  # ì—‘ì…€ íŒŒì¼ë¡œ ì €ì¥ (header=Trueë¡œ ì„¤ì •)
    workbook  = writer.book
    worksheet = writer.sheets['Sheet1']
    worksheet.set_column('A:A', 8)   # ì—´ ë„ˆë¹„ ì„¤ì •
    worksheet.set_column('B:B', 30)
    worksheet.set_column('C:C', 8)
    worksheet.set_column('D:D', 8)
    worksheet.set_column('E:E', 30)
    worksheet.set_column('F:F', 8)
    worksheet.set_column('G:G', 8)
    worksheet.set_column('H:H', 30)
    worksheet.set_column('I:I', 8)

refresh_token = '1CLvznLL7BwAAAAAAAAAAagAlVx3w9P6NGyYjsITAxrSG9vlAEc31ohZZwYhUAB_'
app_key = 'vlxh3ec9nq5fi5t'
app_secret = 'h5rp5n0w9cp4ifk'
token_url = "https://api.dropbox.com/oauth2/token"
params = {
    'refresh_token': refresh_token,
    'grant_type': 'refresh_token',
    'client_id': app_key,
    'client_secret': app_secret
}
response = requests.post(token_url, data=params)
access_token = response.json().get('access_token')

dbx = dropbox.Dropbox(access_token)
with open(file_path, "rb") as f:
    dbx.files_upload(f.read(), f'/ë¶€ì‚°ì²­ê³¼/{file_path}', mode=dropbox.files.WriteMode("overwrite"))
shared_link_metadata = dbx.sharing_create_shared_link_with_settings(f'/ë¶€ì‚°ì²­ê³¼/{file_path}')

# ì‹œê°„ëŒ€ë³„ ì°¨ìˆ˜ ì„¤ì •
hour = now.hour
minute = now.minute

if 1 <= hour <= 7:
    batch = "1ì°¨"
elif 8 <= hour <= 10:
    batch = "2ì°¨"
elif 11 <= hour <= 11:
    batch = "3ì°¨"
elif 12 <= hour <= 13:
    batch = "4ì°¨"
elif 14 <= hour <= 15:
    batch = "5ì°¨"
elif 16 <= hour <= 18:
    batch = "ë§‰ì°¨"
elif 19 <= hour <= 23:
    batch = "ì¶”ê°€"
else:
    batch = ""  # 24ì‹œ(0ì‹œ)ëŠ” ë°°ì¹˜ ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ


# ì¹´ì¹´ì˜¤ì›Œí¬ ë©”ì‹œì§€ ì „ì†¡
app_key = 'b36ed46e.0b55706350e94ef8b49e8647a97ae1b7'
chatroom_id = '9483032'
time_string = now.strftime("%mì›” %dì¼ %Hì‹œ %Më¶„")

def send_kakao_work_message(app_key, chatroom_id, file_url, batch):
    url = "https://api.kakaowork.com/v1/messages.send"
    headers = {
        "Authorization": f"Bearer {app_key}",
        "Content-Type": "application/json"
    }
    data = {
        "conversation_id": chatroom_id,
        "text": f"{batch} - ì†Œë¶„ í”„ë¦°íŠ¸ ìë£Œ",
        "blocks": [
            {
                "type": "header",
                "text": f"{batch} - ì†Œë¶„ í”„ë¦°íŠ¸ ìë£Œ",
                "style": "blue"
            },
            {
                "type": "text",
                "text": "ì•„ë˜ ë§í¬ì—ì„œ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”!",
                "markdown": True
            },
            {
                "type": "button",
                "text": "íŒŒì¼ ë‹¤ìš´ë¡œë“œ",
                "style": "default",
                "action_type": "open_system_browser",
                "value": file_url
            }
        ]
    }
    response = requests.post(url, headers=headers, json=data)
    return response.json()

result = send_kakao_work_message(app_key, chatroom_id, shared_link_metadata.url, batch)
print(result)

import time

time.sleep(1)

# ---. ë¶€ì‚°ì²­ê³¼ ì „ì²´ ë
print("ë¶€ì‚°ì²­ê³¼ ì „ì²´ ë")


print("ê°ì²œëƒ‰ë™ ì‹œì‘")
# ---. ê°ì²œëƒ‰ë™ ì‹œì‘


# ---. ê°ì²œëƒ‰ë™ë‚±ê°œ ë¶„ë¥˜
print("ê°ì²œëƒ‰ë™ë‚±ê°œ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³€í™˜ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³€í™˜"
        cursor.execute(sql_truncate)

        # ê°ì²œëƒ‰ë™ ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³€í™˜ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ì‚¬ë°©ë„·ì›ë³¸ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ê°ì²œë‚±ê°œ'
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê°ì²œëƒ‰ë™ë‚±ê°œ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)




# ---. íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸
print("íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰ì„ ì´ìš©í•˜ì—¬ 1ì„ ë‚˜ëˆˆ ê²°ê³¼ë¥¼ ì†Œìˆ˜ì  ì„¸ ìë¦¬ì—ì„œ ë‚´ë¦¼í•˜ì—¬ ì†¡ì¥êµ¬ë¶„ì ì»¬ëŸ¼ì— ì—…ë°ì´íŠ¸
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ì = FLOOR((1 / IFNULL(NULLIF(íƒë°°ìˆ˜ëŸ‰, 0), 10)) * 1000) / 1000
        """
        cursor.execute(sql_update)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("íƒë°°ìˆ˜ëŸ‰ ê³„ì‚° ë° ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ë")
# --ë


import time

time.sleep(1)



# ---. ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸
print("ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ì„ ê³±í•˜ì—¬ ê²°ê³¼ ì—…ë°ì´íŠ¸
        sql_multiply_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ì = ì†¡ì¥êµ¬ë¶„ì * ìˆ˜ëŸ‰
        """
        cursor.execute(sql_multiply_update)
        connection.commit()

        print(f"ì†¡ì¥êµ¬ë¶„ì ì—…ë°ì´íŠ¸ ì™„ë£Œ, {cursor.rowcount} í–‰ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì†¡ì¥êµ¬ë¶„ìì™€ ìˆ˜ëŸ‰ ê³± ì—…ë°ì´íŠ¸ ë")
# --ë


import time

time.sleep(1)



# ---. ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ë° íƒë°°ìˆ˜ëŸ‰1 ì—…ë°ì´íŠ¸
print("ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª…ì„ ê¸°ì¤€ìœ¼ë¡œ ì†¡ì¥êµ¬ë¶„ìë¥¼ í•©ì‚°
        sql_group_sum = """
        SELECT ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…, SUM(ì†¡ì¥êµ¬ë¶„ì) AS êµ¬ë¶„ìí•©
        FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³€í™˜
        GROUP BY ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
        """
        cursor.execute(sql_group_sum)
        results = cursor.fetchall()

        # ê° ê·¸ë£¹ì˜ êµ¬ë¶„ìí•©ì„ íƒë°°ìˆ˜ëŸ‰1ì— ì—…ë°ì´íŠ¸
        for result in results:
            sql_update = """
            UPDATE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³€í™˜
            SET íƒë°°ìˆ˜ëŸ‰1 = %s
            WHERE ì£¼ì†Œ = %s AND ìˆ˜ì·¨ì¸ëª… = %s
            """
            cursor.execute(sql_update, (result['êµ¬ë¶„ìí•©'], result['ì£¼ì†Œ'], result['ìˆ˜ì·¨ì¸ëª…']))

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"Updated {cursor.rowcount} rows based on address and recipient name.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ê¸°ë°˜ ì†¡ì¥êµ¬ë¶„ì í•©ì‚° ë° íƒë°°ìˆ˜ëŸ‰1 ì—…ë°ì´íŠ¸ ë")
# --ë

import time

time.sleep(1)




print("íƒë°°ìˆ˜ëŸ‰1 ì˜¬ë¦¼ ì²˜ë¦¬ ì‹œì‘")
import pymysql
import math

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰1ì˜ í˜„ì¬ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        sql_fetch = "SELECT id, íƒë°°ìˆ˜ëŸ‰1 FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³€í™˜"
        cursor.execute(sql_fetch)
        results = cursor.fetchall()

        updated_rows = 0  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ë¥¼ ì¶”ì 
        # ê° í–‰ì˜ íƒë°°ìˆ˜ëŸ‰1 ê°’ì„ ì˜¬ë¦¼ ì²˜ë¦¬í•˜ê³  ì—…ë°ì´íŠ¸ í•©ë‹ˆë‹¤.
        for result in results:
            current_quantity = result['íƒë°°ìˆ˜ëŸ‰1']
            if current_quantity is None:  # íƒë°°ìˆ˜ëŸ‰1ì´ Noneì¼ ë•Œ ì²˜ë¦¬
                current_quantity = 1  # None ê°’ì„ 30ìœ¼ë¡œ ì„¤ì •
            
            rounded_quantity = math.ceil(float(current_quantity))  # íƒë°°ìˆ˜ëŸ‰1 ê°’ì„ ì˜¬ë¦¼
            sql_update = "UPDATE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³€í™˜ SET íƒë°°ìˆ˜ëŸ‰1 = %s WHERE id = %s"
            cursor.execute(sql_update, (rounded_quantity, result['id']))
            updated_rows += cursor.rowcount

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

        print(f"ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜: {updated_rows}")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("íƒë°°ìˆ˜ëŸ‰1 ì˜¬ë¦¼ ì²˜ë¦¬ ì™„ë£Œ")
# --ë


import time

time.sleep(1)




# ---. íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸
print("íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ìˆ˜ëŸ‰1ì´ 1ë³´ë‹¤ í° ê²½ìš° 'ì¶”ê°€'ë¡œ ì—…ë°ì´íŠ¸
        update_more_than_one = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ = 'ì¶”ê°€'
        WHERE íƒë°°ìˆ˜ëŸ‰1 > 1
        """
        cursor.execute(update_more_than_one)
        
        # íƒë°°ìˆ˜ëŸ‰1ì´ 1 ì´í•˜ì¸ ê²½ìš° '1ì¥'ìœ¼ë¡œ ì—…ë°ì´íŠ¸
        update_one_or_less = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³€í™˜
        SET ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        WHERE íƒë°°ìˆ˜ëŸ‰1 <= 1
        """
        cursor.execute(update_one_or_less)
        
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated rows for more than one: {cursor.rowcount}")  # 'ì¶”ê°€'ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥
        print(f"Updated rows for one or less: {cursor.rowcount}")  # '1ì¥'ìœ¼ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("íƒë°°ìˆ˜ëŸ‰1ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‘ì—… ë")
# ---ë

import time

time.sleep(1)



# ---. ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸
print("ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì£¼ì†Œ + ìˆ˜ì·¨ì¸ëª… ì¡°í•©ì´ ìœ ì¼í•œ ê²½ìš° 'ë‹¨ì¼'ë¡œ ì—…ë°ì´íŠ¸
        update_unique_address_and_name = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³€í™˜ t1
        JOIN (
            SELECT ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
            FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³€í™˜
            WHERE ì†¡ì¥êµ¬ë¶„ = '1ì¥'
            GROUP BY ì£¼ì†Œ, ìˆ˜ì·¨ì¸ëª…
            HAVING COUNT(*) = 1
        ) AS unique_address ON t1.ì£¼ì†Œ = unique_address.ì£¼ì†Œ AND t1.ìˆ˜ì·¨ì¸ëª… = unique_address.ìˆ˜ì·¨ì¸ëª…
        SET t1.ì†¡ì¥êµ¬ë¶„ = 'ë‹¨ì¼'
        WHERE t1.ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        """
        cursor.execute(update_unique_address_and_name)

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated unique address and name rows to 'ë‹¨ì¼': {cursor.rowcount}")  # 'ë‹¨ì¼'ë¡œ ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì£¼ì†Œ ë° ìˆ˜ì·¨ì¸ëª… ìœ ì¼ì„±ì— ë”°ë¥¸ ì†¡ì¥êµ¬ë¶„ ì—…ë°ì´íŠ¸ ì‘ì—… ë")
# ---ë



# ---. ê°ì²œëƒ‰ë™1ì¥ ë¶„ë¥˜
print("ê°ì²œëƒ‰ë™1ì¥ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™1ì¥ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™1ì¥"
        cursor.execute(sql_truncate)

        # ê°ì²œëƒ‰ë™ ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™1ì¥ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = '1ì¥'
        ORDER BY ìœ„ì¹˜ë³€í™˜ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê°ì²œëƒ‰ë™1ì¥ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)


# ---. ê°ì²œëƒ‰ë™ë‹¨ì¼ ë¶„ë¥˜
print("ê°ì²œëƒ‰ë™ë‹¨ì¼ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë‹¨ì¼ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë‹¨ì¼"
        cursor.execute(sql_truncate)

        # ê°ì²œëƒ‰ë™ ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë‹¨ì¼ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = 'ë‹¨ì¼'
        ORDER BY ìœ„ì¹˜ë³€í™˜ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê°ì²œëƒ‰ë™ë‹¨ì¼ ë¶„ë¥˜ ë")
# --ë

import time

time.sleep(1)

# ---. í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜
print("í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # í’ˆëª©ì½”ë“œë³„ë¡œ ìˆ˜ëŸ‰ì„ í•©ì‚°í•˜ì—¬ ì¶œë ¥ê°œìˆ˜ì— ì—…ë°ì´íŠ¸
        sql_update_output_count = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë‹¨ì¼ AS t1 
        INNER JOIN (
            SELECT í’ˆëª©ì½”ë“œ, SUM(ìˆ˜ëŸ‰) AS total_quantity
            FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë‹¨ì¼
            GROUP BY í’ˆëª©ì½”ë“œ
        ) AS t2 ON t1.í’ˆëª©ì½”ë“œ = t2.í’ˆëª©ì½”ë“œ
        SET t1.í’ˆëª©ê°œìˆ˜ = t2.total_quantity
        """
        cursor.execute(sql_update_output_count)

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("í’ˆëª©ì½”ë“œë³„ ìˆ˜ëŸ‰ í•©ì‚° ë° í’ˆëª©ê°œìˆ˜ ì‘ì—… ë")
# ---ë

import time

time.sleep(1)

# ---. ê°ì²œëƒ‰ë™ì¶”ê°€ ë¶„ë¥˜
print("ê°ì²œëƒ‰ë™ì¶”ê°€ ë¶„ë¥˜ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€"
        cursor.execute(sql_truncate)

        # ê°ì²œëƒ‰ë™ ìœ„ì¹˜ì˜ í–‰ë§Œ ë³µì‚¬í•˜ì—¬ ì¶”ê°€, ìœ„ì¹˜ë³€í™˜ ì»¬ëŸ¼ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        sql_copy_rows = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³€í™˜
        WHERE ì†¡ì¥êµ¬ë¶„ = 'ì¶”ê°€'
        ORDER BY ì£¼ì†Œ DESC
        """
        cursor.execute(sql_copy_rows)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê°ì²œëƒ‰ë™ì¶”ê°€ ë¶„ë¥˜ ë")
# --ë


import time

time.sleep(1)




# ---. ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™
print("ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ í…Œì´ë¸” ì´ˆê¸°í™”
        sql_truncate = "TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥"
        cursor.execute(sql_truncate)

        # ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€ í…Œì´ë¸”ì—ì„œ ìœ ë‹ˆí¬í•œ ì£¼ì†Œë¥¼ ê°€ì§„ í–‰ì„ ì„ íƒí•˜ì—¬ ì´ë™
        sql_insert_unique = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM (
            SELECT *, ROW_NUMBER() OVER (PARTITION BY ì£¼ì†Œ ORDER BY id ASC) AS rn
            FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€
        ) AS subquery
        WHERE subquery.rn = 1
        """
        cursor.execute(sql_insert_unique)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ í…Œì´ë¸”ë¡œ ìœ ë‹ˆí¬ ì£¼ì†Œ í–‰ ì´ë™ ë")
# --ë


import time

time.sleep(1)




# ---. ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸
print("ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ëª¨ë“  'ìˆ˜ëŸ‰'ì„ 1ë¡œ ë³€ê²½í•˜ê³  'ì†¡ì¥ëª…'ì„ "ì¶”ê°€ì†¡ì¥"ìœ¼ë¡œ ë³€ê²½
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥
        SET ìˆ˜ëŸ‰ = 1, ì†¡ì¥ëª… = '+++', ì˜µì…˜ëª… = '+++' , í’ˆëª©ì½”ë“œ = '0000'
        """
        cursor.execute(sql_update)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()
        print(f"Updated {cursor.rowcount} rows in ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥.")

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì—…ë°ì´íŠ¸ ì™„ë£Œ")
# --ë

import time

time.sleep(1)



# ---. ê°ì²œëƒ‰ë™ ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° 
print("ê°ì²œëƒ‰ë™ ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ë¨¼ì € ëª¨ë“  í–‰ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        sql_select = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ WHERE íƒë°°ìˆ˜ëŸ‰1 > 2"
        cursor.execute(sql_select)
        rows = cursor.fetchall()

        # ê° í–‰ì„ 'íƒë°°ìˆ˜ëŸ‰1 - 2' ë§Œí¼ ë³µì‚¬í•˜ì—¬ ì‚½ì…í•©ë‹ˆë‹¤.
        for row in rows:
            count = int(row['íƒë°°ìˆ˜ëŸ‰1']) - 2  # ì¶”ê°€í•  í–‰ì˜ ìˆ˜
            sql_insert = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥
            (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
            """
            params = (row['msg1'], row['msg2'], row['msg3'], row['msg4'], row['msg5'], row['msg6'], row['ìˆ˜ì·¨ì¸ëª…'], row['ì „í™”ë²ˆí˜¸1'], row['ì „í™”ë²ˆí˜¸2'], row['ìš°í¸ë²ˆí˜¸'], row['ì£¼ì†Œ'], row['ì˜µì…˜ëª…'], row['ìˆ˜ëŸ‰'], row['ë°°ì†¡ë©”ì„¸ì§€'], row['ì£¼ë¬¸ë²ˆí˜¸'], row['ì‡¼í•‘ëª°'], row['ìˆ˜ì§‘ì‹œê°„'], row['ì†¡ì¥ëª…'], row['í’ˆëª©ì½”ë“œ'], row['íƒë°°ë¹„ìš©'], row['ë°•ìŠ¤í¬ê¸°'], row['ì¶œë ¥ê°œìˆ˜'], row['ì†¡ì¥ìˆ˜ëŸ‰'], row['ë³„í‘œ1'], row['ë³„í‘œ2'], row['í’ˆëª©ê°œìˆ˜'], row['íƒë°°ìˆ˜ëŸ‰'], row['íƒë°°ìˆ˜ëŸ‰1'], row['íƒë°°ìˆ˜ëŸ‰í•©ì‚°'], row['ì†¡ì¥êµ¬ë¶„ì'], row['ì†¡ì¥êµ¬ë¶„'], row['ì†¡ì¥êµ¬ë¶„ìµœì¢…'], row['ìœ„ì¹˜'], row['ìœ„ì¹˜ë³€í™˜'])
            for _ in range(count):
                cursor.execute(sql_insert, params)

    # ë³€ê²½ì‚¬í•­ ì €ì¥
    connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()

print("ê°ì²œëƒ‰ë™ ì¶”ê°€ì†¡ì¥ ëŠ˜ë¦¬ê¸° ë")
# --ë

import time

time.sleep(1)


# ---. ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸°
print("ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸° ì‹œì‘")
# --ì‹œì‘

import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor  # ê²°ê³¼ë¥¼ ë”•ì…”ë„ˆë¦¬ í˜•íƒœë¡œ ë°›ê¸° ìœ„í•¨
)

try:
    with conn.cursor() as cursor:
        # ìœ„ì¹˜ë³€í™˜ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ëª¨ë“  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´
        sql = "SELECT id, ìœ„ì¹˜ë³€í™˜ FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ ORDER BY ìœ„ì¹˜ë³€í™˜, id"
        cursor.execute(sql)
        results = cursor.fetchall()

        # í˜„ì¬ ìœ„ì¹˜ë³€í™˜ ê°’
        current_location = None
        counter = 1

        # ê²°ê³¼ë¥¼ ìˆœíšŒí•˜ë©´ì„œ ìˆœë²ˆì„ ë§¤ê¹€
        for row in results:
            if current_location != row['ìœ„ì¹˜ë³€í™˜']:
                current_location = row['ìœ„ì¹˜ë³€í™˜']
                counter = 1  # ìœ„ì¹˜ë³€í™˜ ê°’ì´ ë°”ë€Œë©´ ìˆœë²ˆì„ ë¦¬ì…‹
            
            # ì†¡ì¥êµ¬ë¶„ì ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ (ì¤‘ê´„í˜¸ í˜•ì‹ìœ¼ë¡œ)
            formatted_number = f"[{counter}]"  # ìˆ«ì ì•ë’¤ë¡œ ëŒ€ê´„í˜¸ ì¶”ê°€
            update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ SET ì†¡ì¥êµ¬ë¶„ì=%s WHERE id=%s"
            cursor.execute(update_sql, (formatted_number, row['id']))
            counter += 1

        conn.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

finally:
    conn.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

# ---. ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸°
print("ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ ìˆœë²ˆ ë§¤ê¸°ê¸° ë")
# --ë

import time

time.sleep(1)


# ---. ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸
print("ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸ ì‹œì‘")
# --ì‹œì‘


import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with conn.cursor() as cursor:
        # 'ì£¼ì†Œ' ì»¬ëŸ¼ ì—…ë°ì´íŠ¸ ì¿¼ë¦¬ ì‹¤í–‰
        update_sql = "UPDATE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ SET ì£¼ì†Œ = CONCAT(ì£¼ì†Œ, ì†¡ì¥êµ¬ë¶„ì)"
        cursor.execute(update_sql)
        conn.commit()  # ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜

        print(f"Updated {cursor.rowcount} rows.")  # ì—…ë°ì´íŠ¸ëœ í–‰ ìˆ˜ ì¶œë ¥

finally:
    conn.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ


# ---. ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸
print("ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥ ì£¼ì†Œì—…ë°ì´íŠ¸ ë")
# --ë

import time

time.sleep(1)


import pymysql
import pymysql.cursors

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci',
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # í…Œì´ë¸”ì„ ë¹„ì›ë‹ˆë‹¤.
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€í•©ì¹˜ê¸°")
        
        # ë°ì´í„° ë³‘í•© ë° ì‚½ì… ì¿¼ë¦¬
        merge_and_insert_query = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€í•©ì¹˜ê¸°(msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM (
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€
            UNION ALL
            SELECT * FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€ì†¡ì¥
        ) AS combined
        ORDER BY ìœ„ì¹˜ DESC
        """
        cursor.execute(merge_and_insert_query)
        
        # ë³€ê²½ ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— í™•ì •í•©ë‹ˆë‹¤.
        connection.commit()

finally:
    # ì—°ê²°ì„ ë‹«ìŠµë‹ˆë‹¤.
    connection.close()

import time

time.sleep(1)



# ---. ê°ì²œëƒ‰ë™ í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬
print("ê°ì²œëƒ‰ë™ í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬ ì‹œì‘")
# --ì‹œì‘


import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ í…Œì´ë¸” ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™")
        
        # ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë‹¨ì¼ í…Œì´ë¸”ì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ì„œ ì •ë ¬ í›„ ì‚½ì…
        sql_insert_from_single = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë‹¨ì¼
        ORDER BY ìœ„ì¹˜ë³€í™˜ ASC
        """
        cursor.execute(sql_insert_from_single)

        # ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤ í…Œì´ë¸”ì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ì„œ ì •ë ¬ í›„ ì‚½ì…
        sql_insert_from_box = """
            INSERT INTO ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
            SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
            FROM ì†¡ì¥ì¶œë ¥_ê³µí†µë°•ìŠ¤
            WHERE ì†¡ì¥êµ¬ë¶„ìµœì¢… = 'ê°ì²œë°•ìŠ¤'
            ORDER BY ìœ„ì¹˜ë³€í™˜ ASC
        """
        cursor.execute(sql_insert_from_box)




        # ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™1ì¥ í…Œì´ë¸”ì˜ ë°ì´í„°ë„ ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì— ì¶”ê°€
        sql_insert_from_one = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™1ì¥
        """
        cursor.execute(sql_insert_from_one)

        # ë‘ í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ í•©ì¹˜ê³ , ID ì»¬ëŸ¼ì„ ì œì™¸í•œ í›„ ì •ë ¬í•˜ì—¬ ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì— ì‚½ì…
        sql_merge_and_sort = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì¶”ê°€í•©ì¹˜ê¸°
        ORDER BY ì£¼ì†Œ ASC
        """
        cursor.execute(sql_merge_and_sort)

        # ë³€ê²½ì‚¬í•­ ì €ì¥
        connection.commit()

finally:
    # ì—°ê²° ì¢…ë£Œ
    connection.close()


# ---. ê°ì²œëƒ‰ë™ í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬
print("ê°ì²œëƒ‰ë™ í…Œì´ë¸” ë§ˆì§€ë§‰ì •ë¦¬ ë")
# --ë

import time

time.sleep(1)


# ---. ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‘ì—…
print("ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³„í‘œ í…Œì´ë¸”ì„ ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³„í‘œ")
        print("ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³„í‘œ í…Œì´ë¸”ì´ ë¹„ì›Œì¡ŒìŠµë‹ˆë‹¤.")

        # ë³„í‘œ1 ë˜ëŠ” ë³„í‘œ2ê°€ ë¹„ì–´ìˆì§€ ì•Šì€ í–‰ì„ ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³„í‘œ í…Œì´ë¸”ë¡œ ì´ë™
        sql_move_to_star_table = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³„í‘œ
        SELECT * FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™
        WHERE ë³„í‘œ1 <> '' OR ë³„í‘œ2 <> ''
        """
        cursor.execute(sql_move_to_star_table)
        print(f"Moved {cursor.rowcount} rows to 'ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³„í‘œ'.")

        # ì´ë™ëœ í–‰ ì‚­ì œ
        sql_delete_moved_rows = """
        DELETE FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™
        WHERE ë³„í‘œ1 <> '' OR ë³„í‘œ2 <> ''
        """
        cursor.execute(sql_delete_moved_rows)
        print(f"Deleted {cursor.rowcount} rows from 'ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™'.")

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥


finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ë³„í‘œ í–‰ ì´ë™ ë° ì‚­ì œ ì‘ì—… ì™„ë£Œ")
# ---ë


import time

time.sleep(1)


# ---. ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™
print("ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³„í‘œì—ì„œ ë³„í‘œ1ë¡œ ì •ë ¬í•˜ì—¬ ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì— ë°ì´í„° ì‚½ì…
        sql_transfer_data = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™
        (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, ì˜µì…˜ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, ìˆ˜ì§‘ì‹œê°„, ì†¡ì¥ëª…, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, ì†¡ì¥ìˆ˜ëŸ‰, ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜, íƒë°°ìˆ˜ëŸ‰, íƒë°°ìˆ˜ëŸ‰1, íƒë°°ìˆ˜ëŸ‰í•©ì‚°, ì†¡ì¥êµ¬ë¶„ì, ì†¡ì¥êµ¬ë¶„, ì†¡ì¥êµ¬ë¶„ìµœì¢…, ìœ„ì¹˜, ìœ„ì¹˜ë³€í™˜
        FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ë³„í‘œ
        ORDER BY ì£¼ì†Œ ASC, ì˜µì…˜ëª… ASC
        """
        cursor.execute(sql_transfer_data)

        print(f"Rows moved: {cursor.rowcount}")  # ì´ë™ëœ í–‰ì˜ ìˆ˜ ì¶œë ¥

        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ë³„í‘œ1 ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í–‰ ì´ë™ ì‘ì—… ì™„ë£Œ")
# ---ë


import time

time.sleep(1)



# ---. ë°ì´í„° ì´ë™ ì‘ì—…
print("ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì—ì„œ ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™_ìµœì¢… í…Œì´ë¸”ì„ ë¹„ìš°ê¸°
        cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™_ìµœì¢…")

        # ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì—ì„œ ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™
        sql_transfer_data = """
        INSERT INTO ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™_ìµœì¢…
            (msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
             ì†¡ì¥ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, 
             ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜)
        SELECT msg1, msg2, msg3, msg4, msg5, msg6, ìˆ˜ì·¨ì¸ëª…, ì „í™”ë²ˆí˜¸1, ì „í™”ë²ˆí˜¸2, ìš°í¸ë²ˆí˜¸, ì£¼ì†Œ, 
               ì†¡ì¥ëª…, ìˆ˜ëŸ‰, ë°°ì†¡ë©”ì„¸ì§€, ì£¼ë¬¸ë²ˆí˜¸, ì‡¼í•‘ëª°, í’ˆëª©ì½”ë“œ, íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜, 
               ë³„í‘œ1, ë³„í‘œ2, í’ˆëª©ê°œìˆ˜
        FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™
        """
        cursor.execute(sql_transfer_data)
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Moved {cursor.rowcount} rows from 'ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™' to 'ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™_ìµœì¢…'.")

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™ì—ì„œ ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™_ìµœì¢…ìœ¼ë¡œ ë°ì´í„° ì´ë™ ì‘ì—… ì™„ë£Œ")
# ---ë

import time

time.sleep(1)

# ---. ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸
print("ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì‹œì‘")
import pymysql

# MySQL ì—°ê²° ì •ë³´
host = 'gramwonlogis.mycafe24.com'
port = 3306
user = 'gramwonlogis'
password = 'jung5516!'
database = 'gramwonlogis'
charset = 'utf8mb4'

# MySQL ì—°ê²° ì„¤ì •
connection = pymysql.connect(
    host=host,
    port=port,
    user=user,
    password=password,
    database=database,
    cursorclass=pymysql.cursors.DictCursor
)

try:
    with connection.cursor() as cursor:
        # íƒë°°ë¹„ìš©, ë°•ìŠ¤í¬ê¸°, ì¶œë ¥ê°œìˆ˜ ì—…ë°ì´íŠ¸
        sql_update = """
        UPDATE ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™_ìµœì¢…
        SET íƒë°°ë¹„ìš© = 2300, ë°•ìŠ¤í¬ê¸° = 'ê·¹ì†Œ', ì¶œë ¥ê°œìˆ˜ = 1
        """
        cursor.execute(sql_update)
        connection.commit()  # ë³€ê²½ì‚¬í•­ ì €ì¥
        print(f"Updated {cursor.rowcount} rows in 'ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™_ìµœì¢…'.")

finally:
    connection.close()  # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ

print("ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™_ìµœì¢… í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì™„ë£Œ")
# ---ë

import time

time.sleep(1)

print("ê°ì²œëƒ‰ë™_ìµœì¢…íŒŒì¼ë§Œë“¤ê¸° ì‹œì‘")
# ---ì‹œì‘

import pandas as pd
import mysql.connector
from datetime import datetime
import dropbox
import requests

# ë°ì´í„°ë² ì´ìŠ¤ ë° ë°ì´í„° ì²˜ë¦¬ ì‹œì‘
connection = mysql.connector.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci'
)

cursor = connection.cursor()
query = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™_ìµœì¢…"
cursor.execute(query)
result = cursor.fetchall()
columns = cursor.column_names
df = pd.DataFrame(result, columns=columns)
unique_count = df.drop_duplicates(subset=['ì£¼ì†Œ', 'ìˆ˜ì·¨ì¸ëª…', 'ì „í™”ë²ˆí˜¸1']).shape[0]
connection.close()

# íŒŒì¼ ì €ì¥ ë° Dropbox ì—…ë¡œë“œ
now = datetime.now()
file_path = f'ê°ì²œëƒ‰ë™/ê°ì²œëƒ‰ë™_{now.strftime("%y%m%d_%Hì‹œ%Më¶„")}.xlsx'
df.to_excel(file_path, index=False, header=False)

refresh_token = '1CLvznLL7BwAAAAAAAAAAagAlVx3w9P6NGyYjsITAxrSG9vlAEc31ohZZwYhUAB_'
app_key = 'vlxh3ec9nq5fi5t'
app_secret = 'h5rp5n0w9cp4ifk'
token_url = "https://api.dropbox.com/oauth2/token"
params = {
    'refresh_token': refresh_token,
    'grant_type': 'refresh_token',
    'client_id': app_key,
    'client_secret': app_secret
}
response = requests.post(token_url, data=params)
access_token = response.json().get('access_token')

dbx = dropbox.Dropbox(access_token)
with open(file_path, "rb") as f:
    dbx.files_upload(f.read(), f'/ê°ì²œëƒ‰ë™/{file_path}', mode=dropbox.files.WriteMode("overwrite"))
shared_link_metadata = dbx.sharing_create_shared_link_with_settings(f'/ê°ì²œëƒ‰ë™/{file_path}')

# ì‹œê°„ëŒ€ë³„ ì°¨ìˆ˜ ì„¤ì •
hour = now.hour
minute = now.minute

if 1 <= hour <= 7:
    batch = "1ì°¨"
elif 8 <= hour <= 10:
    batch = "2ì°¨"
elif 11 <= hour <= 11:
    batch = "3ì°¨"
elif 12 <= hour <= 13:
    batch = "4ì°¨"
elif 14 <= hour <= 15:
    batch = "5ì°¨"
elif 16 <= hour <= 18:
    batch = "ë§‰ì°¨"
elif 19 <= hour <= 23:
    batch = "ì¶”ê°€"
else:
    batch = ""  # 24ì‹œ(0ì‹œ)ëŠ” ë°°ì¹˜ ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ


import time

time.sleep(1)

# ì¹´ì¹´ì˜¤ì›Œí¬ ë©”ì‹œì§€ ì „ì†¡
app_key = 'b36ed46e.0b55706350e94ef8b49e8647a97ae1b7'
chatroom_id = '844456585637761'
time_string = now.strftime("%mì›” %dì¼ %Hì‹œ %Më¶„")

def send_kakao_work_message(app_key, chatroom_id, file_url, batch):
    url = "https://api.kakaowork.com/v1/messages.send"
    headers = {
        "Authorization": f"Bearer {app_key}",
        "Content-Type": "application/json"
    }
    data = {
        "conversation_id": chatroom_id,
        "text": f"{batch} - ê°ì²œëƒ‰ë™ ìš´ì†¡ì¥ ìˆ˜ì§‘ ì™„ë£Œ",
        "blocks": [
            {
                "type": "header",
                "text": f"{batch} - ê°ì²œëƒ‰ë™ ìš´ì†¡ì¥ ìˆ˜ì§‘ ì™„ë£Œ",
                "style": "blue"
            },
            {
                "type": "text",
                "text": "ì•„ë˜ ë§í¬ì—ì„œ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”!",
                "markdown": True
            },
            {
                "type": "button",
                "text": "íŒŒì¼ ë‹¤ìš´ë¡œë“œ",
                "style": "default",
                "action_type": "open_system_browser",
                "value": file_url
            },
            {
                "type": "divider"
            },
            {
                "type": "text",
                "text": f"*ì†¡ì¥ ê°œìˆ˜:* {unique_count}ê±´",
                "markdown": True
            },
            {
                "type": "divider"
            },
            {
                "type": "text",
                "text": "*ì†¡ì¥ë„˜ê¸°ê¸°*\nì•„ì´ë””: `gram`\në¹„ë²ˆ: `3535`\n[ğŸ‘‰ ì†¡ì¥ ê´€ë¦¬ í˜ì´ì§€ ë°”ë¡œê°€ê¸°](https://gramwon.me/orders/transfer)",
                "markdown": True
            },
            {
                "type": "divider"
            },
        ]
    }
    response = requests.post(url, headers=headers, json=data)
    return response.json()

result = send_kakao_work_message(app_key, chatroom_id, shared_link_metadata.url, batch)
print(result)

import time

time.sleep(1)



import mysql.connector
import pandas as pd
from datetime import datetime
import dropbox
import requests
import time
import os

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„¤ì •
connection = mysql.connector.connect(
    host='gramwonlogis.mycafe24.com',
    port=3306,
    user='gramwonlogis',
    password='jung5516!',
    database='gramwonlogis',
    charset='utf8mb4',  # âœ… ì´ê±° í•„ìˆ˜!
    collation='utf8mb4_unicode_ci'
)

cursor = connection.cursor()

try:
    print("ì†¡ì¥ì¶œë ¥_ìµœì¢… í…Œì´ë¸”ì„ ì´ˆê¸°í™”í•˜ê³  ë°ì´í„°ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.")

    # ì†¡ì¥ì¶œë ¥_ìµœì¢… í…Œì´ë¸” ì´ˆê¸°í™”
    cursor.execute("TRUNCATE TABLE ì†¡ì¥ì¶œë ¥_ìµœì¢…")
    connection.commit()
    print("ì†¡ì¥ì¶œë ¥_ìµœì¢… í…Œì´ë¸” ì´ˆê¸°í™” ì™„ë£Œ.")

    # ê° í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ ì†¡ì¥ì¶œë ¥_ìµœì¢… í…Œì´ë¸”ì— insert
    tables = [
        'ì†¡ì¥ì¶œë ¥_ê²½ê¸°ëƒ‰ë™_ìµœì¢…',
        'ì†¡ì¥ì¶œë ¥_ê²½ê¸°ê³µì‚°_ìµœì¢…',
        'ì†¡ì¥ì¶œë ¥_ë¶€ì‚°ì²­ê³¼_ìµœì¢…',
        'ì†¡ì¥ì¶œë ¥_ì„œìš¸ê³µì‚°_ìµœì¢…',
        'ì†¡ì¥ì¶œë ¥_ì„œìš¸ëƒ‰ë™_ìµœì¢…',
        'ì†¡ì¥ì¶œë ¥_ê°ì²œëƒ‰ë™_ìµœì¢…'
    ]

    for table in tables:
        insert_query = f"""
        INSERT INTO ì†¡ì¥ì¶œë ¥_ìµœì¢…
        SELECT * FROM {table}
        """
        cursor.execute(insert_query)
        connection.commit()
        print(f"{table}ì˜ ë°ì´í„°ê°€ ì†¡ì¥ì¶œë ¥_ìµœì¢… í…Œì´ë¸”ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.")

    print("ëª¨ë“  ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.")

    # í†µí•©ëœ ë°ì´í„°ë¥¼ DataFrameìœ¼ë¡œ ê°€ì ¸ì˜¤ê¸°
    query = "SELECT * FROM ì†¡ì¥ì¶œë ¥_ìµœì¢…"
    df = pd.read_sql(query, connection)
    unique_count = df.drop_duplicates(subset=['ì£¼ì†Œ', 'ìˆ˜ì·¨ì¸ëª…', 'ì „í™”ë²ˆí˜¸1']).shape[0]

    # íŒŒì¼ ì €ì¥ ë° Dropbox ì—…ë¡œë“œ
    now = datetime.now()
    save_directory = os.path.join(os.getcwd(), 'ã….ì†¡ì¥ë„˜ê¸°ê¸°', 'í†µí•©ì†¡ì¥')
    os.makedirs(save_directory, exist_ok=True)
    file_name = f'í†µí•©ì†¡ì¥_{now.strftime("%y%m%d_%Hì‹œ%Më¶„")}.xlsx'
    file_path = os.path.join(save_directory, file_name)
    df.to_excel(file_path, index=False)

    refresh_token = '1CLvznLL7BwAAAAAAAAAAagAlVx3w9P6NGyYjsITAxrSG9vlAEc31ohZZwYhUAB_'
    app_key = 'vlxh3ec9nq5fi5t'
    app_secret = 'h5rp5n0w9cp4ifk'
    token_url = "https://api.dropbox.com/oauth2/token"
    params = {
        'refresh_token': refresh_token,
        'grant_type': 'refresh_token',
        'client_id': app_key,
        'client_secret': app_secret
    }
    response = requests.post(token_url, data=params)
    access_token = response.json().get('access_token')

    dbx = dropbox.Dropbox(access_token)
    dropbox_path = f'/í†µí•©ì†¡ì¥/{file_name}'
    with open(file_path, "rb") as f:
        try:
            dbx.files_upload(f.read(), dropbox_path, mode=dropbox.files.WriteMode("overwrite"))
            print(f"íŒŒì¼ì´ Dropboxì— ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤: {dropbox_path}")
        except dropbox.exceptions.ApiError as e:
            print(f"Dropbox ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {e}")

    try:
        shared_link_metadata = dbx.sharing_create_shared_link_with_settings(dropbox_path)
        print(f"ê³µìœ  ë§í¬ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤: {shared_link_metadata.url}")
    except dropbox.exceptions.ApiError as e:
        print(f"ê³µìœ  ë§í¬ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {e}")
        shared_link_metadata = type('obj', (object,), {'url': "https://www.dropbox.com"})

    # ì‹œê°„ëŒ€ë³„ ì°¨ìˆ˜ ì„¤ì •
    hour = now.hour
    if 1 <= hour <= 7:
        batch = "1ì°¨"
    elif 8 <= hour <= 10:
        batch = "2ì°¨"
    elif 11 <= hour <= 11:
        batch = "3ì°¨"
    elif 12 <= hour <= 13:
        batch = "4ì°¨"
    elif 14 <= hour <= 15:
        batch = "5ì°¨"
    elif 16 <= hour <= 18:
        batch = "ë§‰ì°¨"
    elif 19 <= hour <= 23:
        batch = "ì¶”ê°€"
    else:
        batch = ""

    time.sleep(1)

    # ì¹´ì¹´ì˜¤ì›Œí¬ ë©”ì‹œì§€ ì „ì†¡
    app_key = 'b36ed46e.0b55706350e94ef8b49e8647a97ae1b7'
    chatroom_id = '10545642'

    def send_kakao_work_message(app_key, chatroom_id, file_url, batch):
        url = "https://api.kakaowork.com/v1/messages.send"
        headers = {
            "Authorization": f"Bearer {app_key}",
            "Content-Type": "application/json"
        }
        data = {
            "conversation_id": chatroom_id,
            "text": f"{batch} - í†µí•© ì†¡ì¥ ìˆ˜ì§‘ ì™„ë£Œ",
            "blocks": [
                {
                    "type": "header",
                    "text": f"{batch} - í†µí•© ì†¡ì¥ ìˆ˜ì§‘ ì™„ë£Œ",
                    "style": "blue"
                },
                {
                    "type": "text",
                    "text": "ì•„ë˜ ë§í¬ì—ì„œ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”!",
                    "markdown": True
                },
                {
                    "type": "button",
                    "text": "íŒŒì¼ ë‹¤ìš´ë¡œë“œ",
                    "style": "default",
                    "action_type": "open_system_browser",
                    "value": file_url
                },
                {
                    "type": "divider"
                },
                {
                    "type": "description",
                    "term": "ì†¡ì¥ê°œìˆ˜",
                    "content": {
                        "type": "text",
                        "text": str(unique_count),
                        "markdown": False
                    },
                    "accent": True
                },
                {
                    "type": "divider"
                },
            ]
        }
        response = requests.post(url, headers=headers, json=data)
        return response.json()

    result = send_kakao_work_message(app_key, chatroom_id, shared_link_metadata.url, batch)
    print(result)

except mysql.connector.Error as error:
    print(f"ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜ ë°œìƒ: {error}")

finally:
    if connection.is_connected():
        cursor.close()
        connection.close()
        print("ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")
